LavaPack.loadBundle([[2734,{"@metamask/permission-controller":2385,"@metamask/rpc-errors":2524,"@metamask/snaps-sdk":2739,"@metamask/snaps-utils":2853,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getValidatedParams=n.getImplementation=n.notifyBuilder=n.specificationBuilder=void 0;const s=e("@metamask/permission-controller"),a=e("@metamask/rpc-errors"),r=e("@metamask/snaps-sdk"),i=e("@metamask/snaps-utils"),o=e("@metamask/superstruct"),c=e("@metamask/utils"),u="snap_notify",l=(0,o.object)({type:(0,r.enumValue)(r.NotificationType.Native),message:(0,o.string)()}),d=(0,o.object)({type:(0,r.enumValue)(r.NotificationType.InApp),message:(0,o.string)()}),p=(0,o.object)({type:(0,r.enumValue)(r.NotificationType.InApp),message:(0,o.string)(),content:r.ComponentOrElementStruct,title:(0,o.string)(),footerLink:(0,o.optional)((0,o.object)({href:(0,o.string)(),text:(0,o.string)()}))}),m=(0,r.union)([d,p,l]);n.specificationBuilder=({allowedCaveats:e=null,methodHooks:t})=>({permissionType:s.PermissionType.RestrictedMethod,targetName:u,allowedCaveats:e,methodImplementation:h(t),subjectTypes:[s.SubjectType.Snap]});function h({showNativeNotification:e,showInAppNotification:t,isOnPhishingList:n,maybeUpdatePhishingList:s,createInterface:i,getSnap:o}){return async function(u){const{params:l,context:{origin:d}}=u;await s();const p=f(l,n,o);if((0,c.hasProperty)(p,"content")){const e=await i(d,p.content,undefined,r.ContentType.Notification);p.content=e}switch(p.type){case r.NotificationType.Native:return await e(d,p);case r.NotificationType.InApp:return await t(d,p);default:throw a.rpcErrors.invalidParams({message:'Must specify a valid notification "type".'})}}}function f(e,t,n){if(!(0,c.isObject)(e))throw a.rpcErrors.invalidParams({message:"Expected params to be a single object."});const{type:s,message:o}=e;if(!s||"string"!=typeof s||!Object.values(r.NotificationType).includes(s))throw a.rpcErrors.invalidParams({message:'Must specify a valid notification "type".'});const u=!o||"string"!=typeof o;if(s===r.NotificationType.Native&&(u||o.length>=50))throw a.rpcErrors.invalidParams({message:'Must specify a non-empty string "message" less than 50 characters long.'});if(s===r.NotificationType.InApp&&(u||o.length>=500))throw a.rpcErrors.invalidParams({message:'Must specify a non-empty string "message" less than 500 characters long.'});try{const s=(0,i.createUnion)(e,m,"type");return(0,i.validateTextLinks)(s.message,t,n),(0,c.hasProperty)(s,"footerLink")&&(0,i.validateLink)(s.footerLink.href,t,n),s}catch(e){throw a.rpcErrors.invalidParams({message:`Invalid params: ${(0,r.getErrorMessage)(e)}`})}}n.notifyBuilder=Object.freeze({targetName:u,specificationBuilder:n.specificationBuilder,methodHooks:{showNativeNotification:!0,showInAppNotification:!0,isOnPhishingList:!0,maybeUpdatePhishingList:!0,createInterface:!0,getSnap:!0}}),n.getImplementation=h,n.getValidatedParams=f}}},{package:"@metamask/snaps-rpc-methods",file:"node_modules/@metamask/snaps-rpc-methods/dist/restricted/notify.cjs"}],[2735,{"@metamask/key-tree":2051,"@metamask/rpc-errors":2524,"@metamask/superstruct":2875,"@metamask/utils":2974,"@noble/hashes/sha3":3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getValueFromEntropySource=n.StateKeyStruct=n.isValidStateKey=n.getNodeFromSeed=n.getNodeFromMnemonic=n.getPathPrefix=n.deriveEntropyFromSeed=n.selectHooks=n.FORBIDDEN_KEYS=void 0;const s=e("@metamask/key-tree"),a=e("@metamask/rpc-errors"),r=e("@metamask/superstruct"),i=e("@metamask/utils"),o=e("@noble/hashes/sha3"),c=2147483648;function u({input:e,salt:t,magic:n}){const s=(0,i.stringToBytes)(e),a=(0,i.stringToBytes)(t),r=function(e){const t=[],n=(0,i.createDataView)(e);for(let e=0;e<8;e++){const s=(n.getUint32(4*e)|c)>>>0;t.push(`bip32:${s-c}'`)}return t}((0,o.keccak_256)((0,i.concatBytes)([s,(0,o.keccak_256)(a)])));return[`bip32:${n}`,...r]}function l(e){switch(e){case"secp256k1":return"bip32";case"ed25519":return"slip10";case"ed25519Bip32":return"cip3";default:return(0,i.assertExhaustive)(e)}}function d(e){return e===undefined||e.split(".").every((e=>e.length>0))}n.FORBIDDEN_KEYS=["constructor","__proto__","prototype"],n.selectHooks=function(e,t){return t?Object.keys(t).reduce(((t,n)=>{const s=n;return t[s]=e[s],t}),{}):undefined},n.deriveEntropyFromSeed=async function({input:e,salt:t="",seed:n,magic:a,cryptographicFunctions:r}){const o=u({input:e,salt:t,magic:a}),{privateKey:c}=await s.SLIP10Node.fromSeed({derivationPath:[n,...o],curve:"secp256k1"},r);return(0,i.assert)(c,"Failed to derive the entropy."),(0,i.add0x)(c)},n.getPathPrefix=l,n.getNodeFromMnemonic=async function({curve:e,secretRecoveryPhrase:t,path:n,cryptographicFunctions:a}){const r=l(e);return await s.SLIP10Node.fromDerivationPath({curve:e,derivationPath:[t,...n.slice(1).map((e=>`${r}:${e}`))]},a)},n.getNodeFromSeed=async function({curve:e,seed:t,path:n,cryptographicFunctions:a}){const r=l(e);return await s.SLIP10Node.fromSeed({curve:e,derivationPath:[t,...n.slice(1).map((e=>`${r}:${e}`))]},a)},n.isValidStateKey=d,n.StateKeyStruct=(0,r.refine)((0,r.string)(),"state key",(e=>!!d(e)||"Invalid state key. Each part of the key must be non-empty.")),n.getValueFromEntropySource=async function(e,t){try{return await e(t)}catch(e){if(e instanceof Error)throw a.rpcErrors.invalidParams({message:e.message});throw a.rpcErrors.internal({message:"An unknown error occurred.",data:{error:e.toString()}})}}}}},{package:"@metamask/snaps-rpc-methods",file:"node_modules/@metamask/snaps-rpc-methods/dist/utils.cjs"}],[2736,{"./internals/index.cjs":2742,"@metamask/rpc-errors":2524},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UserRejectedRequestError=n.UnsupportedMethodError=n.UnauthorizedError=n.DisconnectedError=n.ChainDisconnectedError=n.TransactionRejected=n.ResourceUnavailableError=n.ResourceNotFoundError=n.ParseError=n.MethodNotSupportedError=n.MethodNotFoundError=n.LimitExceededError=n.InvalidRequestError=n.InvalidParamsError=n.InvalidInputError=n.InternalError=void 0;const s=e("@metamask/rpc-errors"),a=e("./internals/index.cjs");n.InternalError=(0,a.createSnapError)(s.rpcErrors.internal),n.InvalidInputError=(0,a.createSnapError)(s.rpcErrors.invalidInput),n.InvalidParamsError=(0,a.createSnapError)(s.rpcErrors.invalidParams),n.InvalidRequestError=(0,a.createSnapError)(s.rpcErrors.invalidRequest),n.LimitExceededError=(0,a.createSnapError)(s.rpcErrors.limitExceeded),n.MethodNotFoundError=(0,a.createSnapError)(s.rpcErrors.methodNotFound),n.MethodNotSupportedError=(0,a.createSnapError)(s.rpcErrors.methodNotSupported),n.ParseError=(0,a.createSnapError)(s.rpcErrors.parse),n.ResourceNotFoundError=(0,a.createSnapError)(s.rpcErrors.resourceNotFound),n.ResourceUnavailableError=(0,a.createSnapError)(s.rpcErrors.resourceUnavailable),n.TransactionRejected=(0,a.createSnapError)(s.rpcErrors.transactionRejected),n.ChainDisconnectedError=(0,a.createSnapError)(s.providerErrors.chainDisconnected),n.DisconnectedError=(0,a.createSnapError)(s.providerErrors.disconnected),n.UnauthorizedError=(0,a.createSnapError)(s.providerErrors.unauthorized),n.UnsupportedMethodError=(0,a.createSnapError)(s.providerErrors.unsupportedMethod),n.UserRejectedRequestError=(0,a.createSnapError)(s.providerErrors.userRejectedRequest)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/error-wrappers.cjs"}],[2737,{"./internals/index.cjs":2742,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function a(e,t){return e.get(i(e,t))}function r(e,t,n){return e.set(i(e,t),n),n}function i(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Object.defineProperty(n,"__esModule",{value:!0}),n.getJsonError=n.SnapError=void 0;const o=e("@metamask/utils"),c=e("./internals/index.cjs");var u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap;class m extends Error{constructor(e,t={}){const n=(0,c.getErrorMessage)(e);super(n),s(this,u,void 0),s(this,l,void 0),s(this,d,void 0),s(this,p,void 0),r(l,this,n),r(u,this,(0,c.getErrorCode)(e));const a={...(0,c.getErrorData)(e),...t};Object.keys(a).length>0&&r(d,this,a),r(p,this,super.stack)}get name(){return"SnapError"}get code(){return a(u,this)}get message(){return a(l,this)}get data(){return a(d,this)}get stack(){return a(p,this)}toJSON(){return{code:c.SNAP_ERROR_CODE,message:c.SNAP_ERROR_MESSAGE,data:{cause:{code:this.code,message:this.message,stack:this.stack,...this.data?{data:this.data}:{}}}}}serialize(){return this.toJSON()}}n.SnapError=m,n.getJsonError=function e(t){if("string"==typeof t)return{name:"Error",message:t,stack:null,cause:null};if((0,o.isJsonRpcError)(t))return{name:"JsonRpcError",message:(0,c.getErrorMessage)(t),stack:(0,c.getErrorStack)(t)??(0,c.getErrorStack)(t.data)??null,cause:null};const n=(0,c.getErrorCause)(t);return{name:(0,c.getErrorName)(t),message:(0,c.getErrorMessage)(t),stack:(0,c.getErrorStack)(t)??null,cause:null===n?null:e(n)}}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/errors.cjs"}],[2738,{"./ui/index.cjs":2820,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getImageComponent=n.getImageData=void 0;const s=e("@metamask/utils"),a=e("./ui/index.cjs");async function r(e,t){const n=await async function(e,t){if("function"!=typeof fetch)throw new Error(`Failed to fetch image data from "${e}": Using this function requires the "endowment:network-access" permission.`);return fetch(e,t).then((async t=>{if(!t.ok)throw new Error(`Failed to fetch image data from "${e}": ${t.status} ${t.statusText}`);const n=await t.blob();return(0,s.assert)("image/jpeg"===n.type||"image/png"===n.type,"Expected image data to be a JPEG or PNG image."),n}))}(e,t),a=new Uint8Array(await n.arrayBuffer());return`data:${n.type};base64,${(0,s.bytesToBase64)(a)}`}n.getImageData=r,n.getImageComponent=async function(e,{width:t,height:n=t,request:i}){(0,s.assert)("number"==typeof t&&t>0,"Expected width to be a number greater than 0."),(0,s.assert)("number"==typeof n&&n>0,"Expected height to be a number greater than 0.");const o=await r(e,i),c=`width="${t}" height="${n}"`;return(0,a.image)(`<svg ${c.trim()} xmlns="http://www.w3.org/2000/svg"><image ${c.trim()} href="${o}" /></svg>`)}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/images.cjs"}],[2739,{"./error-wrappers.cjs":2736,"./errors.cjs":2737,"./images.cjs":2738,"./internals/index.cjs":2742,"./types/index.cjs":2798,"./ui/index.cjs":2820,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.assert=n.nonEmptyRecord=n.selectiveUnion=n.typedUnion=n.enumValue=n.union=n.literal=n.SNAP_ERROR_MESSAGE=n.SNAP_ERROR_CODE=n.getErrorStack=n.getErrorMessage=n.getErrorData=void 0;var r=e("./internals/index.cjs");Object.defineProperty(n,"getErrorData",{enumerable:!0,get:function(){return r.getErrorData}}),Object.defineProperty(n,"getErrorMessage",{enumerable:!0,get:function(){return r.getErrorMessage}}),Object.defineProperty(n,"getErrorStack",{enumerable:!0,get:function(){return r.getErrorStack}}),Object.defineProperty(n,"SNAP_ERROR_CODE",{enumerable:!0,get:function(){return r.SNAP_ERROR_CODE}}),Object.defineProperty(n,"SNAP_ERROR_MESSAGE",{enumerable:!0,get:function(){return r.SNAP_ERROR_MESSAGE}}),Object.defineProperty(n,"literal",{enumerable:!0,get:function(){return r.literal}}),Object.defineProperty(n,"union",{enumerable:!0,get:function(){return r.union}}),Object.defineProperty(n,"enumValue",{enumerable:!0,get:function(){return r.enumValue}}),Object.defineProperty(n,"typedUnion",{enumerable:!0,get:function(){return r.typedUnion}}),Object.defineProperty(n,"selectiveUnion",{enumerable:!0,get:function(){return r.selectiveUnion}}),Object.defineProperty(n,"nonEmptyRecord",{enumerable:!0,get:function(){return r.nonEmptyRecord}});var i=e("@metamask/utils");Object.defineProperty(n,"assert",{enumerable:!0,get:function(){return i.assert}}),a(e("./errors.cjs"),n),a(e("./error-wrappers.cjs"),n),a(e("./images.cjs"),n),a(e("./types/index.cjs"),n),a(e("./ui/index.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/index.cjs"}],[2740,{"../errors.cjs":2737},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSnapError=void 0;const s=e("../errors.cjs");n.createSnapError=function(e){return class extends s.SnapError{constructor(t,n){if("object"==typeof t){const n=e();return void super({code:n.code,message:n.message,data:t})}const s=e(t);super({code:s.code,message:s.message,data:n})}}}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/internals/error-wrappers.cjs"}],[2741,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getErrorData=n.getErrorCause=n.getErrorCode=n.getErrorName=n.getErrorStack=n.getErrorMessage=n.SNAP_ERROR_MESSAGE=n.SNAP_ERROR_CODE=void 0;const s=e("@metamask/utils");function a(e,t,n=null){return(0,s.isObject)(e)&&(0,s.hasProperty)(e,t)?e[t]:n}function r(e,t,n=String(e)){const s=a(e,t);return"string"==typeof s?s:n}n.SNAP_ERROR_CODE=-31002,n.SNAP_ERROR_MESSAGE="Snap Error",n.getErrorMessage=function(e){return r(e,"message")},n.getErrorStack=function(e){return r(e,"stack",null)},n.getErrorName=function(e){return r(e,"name",e instanceof Error?e.name:"Error")},n.getErrorCode=function(e){const t=a(e,"code");return"number"==typeof t&&Number.isInteger(t)?t:-32603},n.getErrorCause=function(e){return a(e,"cause")},n.getErrorData=function(e){const t=a(e,"data");return null!==t&&(0,s.isValidJson)(t)&&!Array.isArray(t)?t:{}}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/internals/errors.cjs"}],[2742,{"./error-wrappers.cjs":2740,"./errors.cjs":2741,"./jsx.cjs":2743,"./structs.cjs":2744,"./svg.cjs":2745},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./error-wrappers.cjs"),n),a(e("./errors.cjs"),n),a(e("./structs.cjs"),n),a(e("./jsx.cjs"),n),a(e("./svg.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/internals/index.cjs"}],[2743,{"./structs.cjs":2744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.nullUnion=void 0;const s=e("./structs.cjs");n.nullUnion=function(e){return(0,s.union)(e)}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/internals/jsx.cjs"}],[2744,{"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.nonEmptyRecord=n.selectiveUnion=n.typedUnion=n.enumValue=n.union=n.literal=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils");function r(e){return(0,s.define)(JSON.stringify(e),(0,s.literal)(e).validator)}n.literal=r,n.union=function([e,...t]){const n=(0,s.union)([e,...t]);return new s.Struct({...n,schema:[e,...t]})},n.enumValue=function(e){return r(e)},n.typedUnion=function(e){const t=e.map((e=>"union"===e.type&&Array.isArray(e.schema)?e.schema:e)).flat(Infinity),n=t.map((({schema:e})=>e.type.type)),r=t.reduce(((e,t)=>(e[JSON.parse(t.schema.type.type)]=t,e)),{});return new s.Struct({type:"union",schema:t,*entries(e,t){if(!(0,a.isObject)(e)||!(0,a.hasProperty)(e,"type")||"string"!=typeof e.type)return;const{type:n}=e,s=r[n];if(s)for(const n of s.entries(e,t))yield n},coercer(e,t){if(!(0,a.isObject)(e)||!(0,a.hasProperty)(e,"type")||"string"!=typeof e.type)return e;const{type:n}=e,s=r[n];return s?s.coercer(e,t):e},*refiner(e,t){const n=r[e.type];yield*n.refiner(e,t)},validator(e,t){if(!(0,a.isObject)(e)||!(0,a.hasProperty)(e,"type")||"string"!=typeof e.type)return`Expected type to be one of: ${n.join(", ")}, but received: undefined`;const{type:s}=e,i=r[s];return i?i.validator(e,t):`Expected type to be one of: ${n.join(", ")}, but received: "${s}"`}})},n.selectiveUnion=function(e){return new s.Struct({type:"union",schema:null,*entries(t,n){const s=e(t);for(const e of s.entries(t,n))yield e},*refiner(t,n){const s=e(t);yield*s.refiner(t,n)},coercer:(t,n)=>e(t).coercer(t,n),validator:(t,n)=>e(t).validator(t,n)})},n.nonEmptyRecord=function(e,t){return(0,s.refine)((0,s.record)(e,t),"Non-empty record",(e=>!Array.isArray(e)&&Object.keys(e).length>0))}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/internals/structs.cjs"}],[2745,{"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.svg=void 0;const s=e("@metamask/superstruct");n.svg=function(){return(0,s.refine)((0,s.string)(),"SVG",(e=>!!e.includes("<svg")||"Value is not a valid SVG."))}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/internals/svg.cjs"}],[2746,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return Object.fromEntries(Object.entries(e).filter((([,e])=>e!==undefined)))}Object.defineProperty(n,"__esModule",{value:!0}),n.createSnapComponent=void 0,n.createSnapComponent=function(e){return t=>{const{key:n=null,...a}=t;return{type:e,props:s(a),key:n}}}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/component.cjs"}],[2747,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Address=void 0;const s=e("../component.cjs");n.Address=(0,s.createSnapComponent)("Address")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Address.cjs"}],[2748,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Avatar=void 0;const s=e("../component.cjs");n.Avatar=(0,s.createSnapComponent)("Avatar")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Avatar.cjs"}],[2749,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Banner=void 0;const s=e("../component.cjs");n.Banner=(0,s.createSnapComponent)("Banner")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Banner.cjs"}],[2750,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Box=void 0;const s=e("../component.cjs");n.Box=(0,s.createSnapComponent)("Box")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Box.cjs"}],[2751,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Card=void 0;const s=e("../component.cjs");n.Card=(0,s.createSnapComponent)("Card")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Card.cjs"}],[2752,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Container=void 0;const s=e("../component.cjs");n.Container=(0,s.createSnapComponent)("Container")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Container.cjs"}],[2753,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Copyable=void 0;const s=e("../component.cjs");n.Copyable=(0,s.createSnapComponent)("Copyable")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Copyable.cjs"}],[2754,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Divider=void 0;const s=e("../component.cjs");n.Divider=(0,s.createSnapComponent)("Divider")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Divider.cjs"}],[2755,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Footer=void 0;const s=e("../component.cjs");n.Footer=(0,s.createSnapComponent)("Footer")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Footer.cjs"}],[2756,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Heading=void 0;const s=e("../component.cjs");n.Heading=(0,s.createSnapComponent)("Heading")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Heading.cjs"}],[2757,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Icon=n.IconName=void 0;const s=e("../component.cjs");var a;!function(e){e.AddSquare="add-square",e.Add="add",e.Arrow2Down="arrow-2-down",e.Arrow2Left="arrow-2-left",e.Arrow2Right="arrow-2-right",e.Arrow2Up="arrow-2-up",e.Arrow2UpRight="arrow-2-up-right",e.ArrowDoubleLeft="arrow-double-left",e.ArrowDoubleRight="arrow-double-right",e.ArrowDown="arrow-down",e.ArrowLeft="arrow-left",e.ArrowRight="arrow-right",e.ArrowUp="arrow-up",e.BankToken="bank-token",e.Bank="bank",e.Book="book",e.Bookmark="bookmark",e.Bridge="bridge",e.Calculator="calculator",e.CardPos="card-pos",e.CardToken="card-token",e.Card="card",e.Category="category",e.Chart="chart",e.CheckBold="check-bold",e.Check="check",e.Clock="clock",e.Close="close",e.CodeCircle="code-circle",e.Coin="coin",e.Confirmation="confirmation",e.Connect="connect",e.CopySuccess="copy-success",e.Copy="copy",e.Customize="customize",e.Danger="danger",e.Dark="dark",e.Data="data",e.Diagram="diagram",e.DocumentCode="document-code",e.DragDrop="drag-drop",e.DraggingAnimation="dragging-animation",e.PinningAnimation="pinning-animation",e.Edit="edit",e.Eraser="eraser",e.Ethereum="ethereum",e.Expand="expand",e.Explore="explore",e.Export="export",e.EyeSlash="eye-slash",e.Eye="eye",e.Filter="filter",e.Flag="flag",e.FlashSlash="flash-slash",e.Flash="flash",e.FullCircle="full-circle",e.Gas="gas",e.GlobalSearch="global-search",e.Global="global",e.Graph="graph",e.Hardware="hardware",e.Heart="heart",e.Hierarchy="hierarchy",e.Home="home",e.Import="import",e.Info="info",e.Key="key",e.Light="light",e.Link="link",e.Loading="loading",e.LockCircle="lock-circle",e.LockSlash="lock-slash",e.Lock="lock",e.Login="login",e.Logout="logout",e.Menu="menu",e.MessageQuestion="message-question",e.Messages="messages",e.MinusBold="minus-bold",e.MinusSquare="minus-square",e.Minus="minus",e.Mobile="mobile",e.Money="money",e.Monitor="monitor",e.MoreHorizontal="more-horizontal",e.MoreVertical="more-vertical",e.NotificationCircle="notification-circle",e.Notification="notification",e.PasswordCheck="password-check",e.People="people",e.Pin="pin",e.ProgrammingArrows="programming-arrows",e.Custody="custody",e.Question="question",e.Received="received",e.Refresh="refresh",e.Save="save",e.ScanBarcode="scan-barcode",e.ScanFocus="scan-focus",e.Scan="scan",e.Scroll="scroll",e.Search="search",e.SecurityCard="security-card",e.SecurityCross="security-cross",e.SecurityKey="security-key",e.SecuritySearch="security-search",e.SecuritySlash="security-slash",e.SecurityTick="security-tick",e.SecurityTime="security-time",e.SecurityUser="security-user",e.Security="security",e.Send1="send-1",e.Send2="send-2",e.Setting="setting",e.Slash="slash",e.SnapsMobile="snaps-mobile",e.SnapsPlus="snaps-plus",e.Snaps="snaps",e.Speedometer="speedometer",e.Star="star",e.Stake="stake",e.Student="student",e.SwapHorizontal="swap-horizontal",e.SwapVertical="swap-vertical",e.Tag="tag",e.Tilde="tilde",e.Timer="timer",e.Trash="trash",e.TrendDown="trend-down",e.TrendUp="trend-up",e.UserCircleAdd="user-circle-add",e.UserCircleLink="user-circle-link",e.UserCircleRemove="user-circle-remove",e.UserCircle="user-circle",e.User="user",e.WalletCard="wallet-card",e.WalletMoney="wallet-money",e.Wallet="wallet",e.Warning="warning",e.Twitter="twitter",e.QrCode="qr-code",e.UserCheck="user-check",e.Unpin="unpin",e.Ban="ban",e.Bold="bold",e.CircleX="circle-x",e.Download="download",e.FileIcon="file",e.Flask="flask",e.Plug="plug",e.Share="share",e.Square="square",e.Tint="tint",e.Upload="upload",e.Usb="usb",e.Wifi="wifi",e.PlusMinus="plus-minus"}(a||(n.IconName=a={}));n.Icon=(0,s.createSnapComponent)("Icon")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Icon.cjs"}],[2758,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Image=void 0;const s=e("../component.cjs");n.Image=(0,s.createSnapComponent)("Image")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Image.cjs"}],[2759,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Link=void 0;const s=e("../component.cjs");n.Link=(0,s.createSnapComponent)("Link")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Link.cjs"}],[2760,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Row=void 0;const s=e("../component.cjs");n.Row=(0,s.createSnapComponent)("Row")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Row.cjs"}],[2761,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Section=void 0;const s=e("../component.cjs");n.Section=(0,s.createSnapComponent)("Section")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Section.cjs"}],[2762,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Skeleton=void 0;const s=e("../component.cjs");n.Skeleton=(0,s.createSnapComponent)("Skeleton")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Skeleton.cjs"}],[2763,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Spinner=void 0;const s=e("../component.cjs");n.Spinner=(0,s.createSnapComponent)("Spinner")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Spinner.cjs"}],[2764,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Text=void 0;const s=e("../component.cjs");n.Text=(0,s.createSnapComponent)("Text")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Text.cjs"}],[2765,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Tooltip=void 0;const s=e("../component.cjs");n.Tooltip=(0,s.createSnapComponent)("Tooltip")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Tooltip.cjs"}],[2766,{"../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Value=void 0;const s=e("../component.cjs");n.Value=(0,s.createSnapComponent)("Value")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/Value.cjs"}],[2767,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AccountSelector=void 0;const s=e("../../component.cjs");n.AccountSelector=(0,s.createSnapComponent)("AccountSelector")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/AccountSelector.cjs"}],[2768,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AddressInput=void 0;const s=e("../../component.cjs");n.AddressInput=(0,s.createSnapComponent)("AddressInput")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/AddressInput.cjs"}],[2769,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AssetSelector=void 0;const s=e("../../component.cjs");n.AssetSelector=(0,s.createSnapComponent)("AssetSelector")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/AssetSelector.cjs"}],[2770,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Button=void 0;const s=e("../../component.cjs");n.Button=(0,s.createSnapComponent)("Button")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Button.cjs"}],[2771,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Checkbox=void 0;const s=e("../../component.cjs");n.Checkbox=(0,s.createSnapComponent)("Checkbox")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Checkbox.cjs"}],[2772,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Dropdown=void 0;const s=e("../../component.cjs");n.Dropdown=(0,s.createSnapComponent)("Dropdown")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Dropdown.cjs"}],[2773,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Field=void 0;const s=e("../../component.cjs");n.Field=(0,s.createSnapComponent)("Field")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Field.cjs"}],[2774,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FileInput=void 0;const s=e("../../component.cjs");n.FileInput=(0,s.createSnapComponent)("FileInput")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/FileInput.cjs"}],[2775,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Form=void 0;const s=e("../../component.cjs");n.Form=(0,s.createSnapComponent)("Form")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Form.cjs"}],[2776,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Input=void 0;const s=e("../../component.cjs");n.Input=(0,s.createSnapComponent)("Input")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Input.cjs"}],[2777,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Option=void 0;const s=e("../../component.cjs");n.Option=(0,s.createSnapComponent)("Option")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Option.cjs"}],[2778,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Radio=void 0;const s=e("../../component.cjs");n.Radio=(0,s.createSnapComponent)("Radio")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Radio.cjs"}],[2779,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RadioGroup=void 0;const s=e("../../component.cjs");n.RadioGroup=(0,s.createSnapComponent)("RadioGroup")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/RadioGroup.cjs"}],[2780,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Selector=void 0;const s=e("../../component.cjs");n.Selector=(0,s.createSnapComponent)("Selector")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/Selector.cjs"}],[2781,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SelectorOption=void 0;const s=e("../../component.cjs");n.SelectorOption=(0,s.createSnapComponent)("SelectorOption")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/SelectorOption.cjs"}],[2782,{"./AccountSelector.cjs":2767,"./AddressInput.cjs":2768,"./AssetSelector.cjs":2769,"./Button.cjs":2770,"./Checkbox.cjs":2771,"./Dropdown.cjs":2772,"./Field.cjs":2773,"./FileInput.cjs":2774,"./Form.cjs":2775,"./Input.cjs":2776,"./Option.cjs":2777,"./Radio.cjs":2778,"./RadioGroup.cjs":2779,"./Selector.cjs":2780,"./SelectorOption.cjs":2781},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./AccountSelector.cjs"),n),a(e("./AddressInput.cjs"),n),a(e("./AssetSelector.cjs"),n),a(e("./Button.cjs"),n),a(e("./Checkbox.cjs"),n),a(e("./Dropdown.cjs"),n),a(e("./Option.cjs"),n),a(e("./Radio.cjs"),n),a(e("./RadioGroup.cjs"),n),a(e("./Field.cjs"),n),a(e("./FileInput.cjs"),n),a(e("./Form.cjs"),n),a(e("./Input.cjs"),n),a(e("./Selector.cjs"),n),a(e("./SelectorOption.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/form/index.cjs"}],[2783,{"../../component.cjs":2746,"../Text.cjs":2764},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Bold=void 0;const s=e("../../component.cjs");e("../Text.cjs");n.Bold=(0,s.createSnapComponent)("Bold")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/formatting/Bold.cjs"}],[2784,{"../../component.cjs":2746},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Italic=void 0;const s=e("../../component.cjs");n.Italic=(0,s.createSnapComponent)("Italic")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/formatting/Italic.cjs"}],[2785,{"./Bold.cjs":2783,"./Italic.cjs":2784},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./Bold.cjs"),n),a(e("./Italic.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/formatting/index.cjs"}],[2786,{"./Address.cjs":2747,"./Avatar.cjs":2748,"./Banner.cjs":2749,"./Box.cjs":2750,"./Card.cjs":2751,"./Container.cjs":2752,"./Copyable.cjs":2753,"./Divider.cjs":2754,"./Footer.cjs":2755,"./Heading.cjs":2756,"./Icon.cjs":2757,"./Image.cjs":2758,"./Link.cjs":2759,"./Row.cjs":2760,"./Section.cjs":2761,"./Skeleton.cjs":2762,"./Spinner.cjs":2763,"./Text.cjs":2764,"./Tooltip.cjs":2765,"./Value.cjs":2766,"./form/index.cjs":2782,"./formatting/index.cjs":2785},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./form/index.cjs"),n),a(e("./formatting/index.cjs"),n),a(e("./Address.cjs"),n),a(e("./Avatar.cjs"),n),a(e("./Box.cjs"),n),a(e("./Card.cjs"),n),a(e("./Copyable.cjs"),n),a(e("./Divider.cjs"),n),a(e("./Value.cjs"),n),a(e("./Heading.cjs"),n),a(e("./Icon.cjs"),n),a(e("./Image.cjs"),n),a(e("./Link.cjs"),n),a(e("./Row.cjs"),n),a(e("./Spinner.cjs"),n),a(e("./Text.cjs"),n),a(e("./Tooltip.cjs"),n),a(e("./Footer.cjs"),n),a(e("./Container.cjs"),n),a(e("./Section.cjs"),n),a(e("./Banner.cjs"),n),a(e("./Skeleton.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/components/index.cjs"}],[2787,{"./component.cjs":2746,"./components/index.cjs":2786,"./jsx-dev-runtime.cjs":2788,"./jsx-runtime.cjs":2789,"./validation.cjs":2790},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.FieldChildUnionStruct=n.FormChildStruct=n.BoxChildStruct=n.assertJSXElement=n.isJSXElementUnsafe=n.isJSXElement=n.RootJSXElementStruct=n.JSXElementStruct=void 0,a(e("./component.cjs"),n),a(e("./components/index.cjs"),n),a(e("./jsx-runtime.cjs"),n),a(e("./jsx-dev-runtime.cjs"),n);var r=e("./validation.cjs");Object.defineProperty(n,"JSXElementStruct",{enumerable:!0,get:function(){return r.JSXElementStruct}}),Object.defineProperty(n,"RootJSXElementStruct",{enumerable:!0,get:function(){return r.RootJSXElementStruct}}),Object.defineProperty(n,"isJSXElement",{enumerable:!0,get:function(){return r.isJSXElement}}),Object.defineProperty(n,"isJSXElementUnsafe",{enumerable:!0,get:function(){return r.isJSXElementUnsafe}}),Object.defineProperty(n,"assertJSXElement",{enumerable:!0,get:function(){return r.assertJSXElement}}),Object.defineProperty(n,"BoxChildStruct",{enumerable:!0,get:function(){return r.BoxChildStruct}}),Object.defineProperty(n,"FormChildStruct",{enumerable:!0,get:function(){return r.FormChildStruct}}),Object.defineProperty(n,"FieldChildUnionStruct",{enumerable:!0,get:function(){return r.FieldChildUnionStruct}})}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/index.cjs"}],[2788,{"./jsx-runtime.cjs":2789,"./validation.cjs":2790},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.jsxDEV=void 0;const s=e("./jsx-runtime.cjs"),a=e("./validation.cjs");n.jsxDEV=function(e,t,n){const r=(0,s.jsx)(e,t,n);return(0,a.assertJSXElement)(r),r}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/jsx-dev-runtime.cjs"}],[2789,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){if("string"==typeof e)throw new Error(`An HTML element ("${String(e)}") was used in a Snap component, which is not supported by Snaps UI. Please use one of the supported Snap components.`);if(!e)throw new Error("A JSX fragment was used in a Snap component, which is not supported by Snaps UI. Please use one of the supported Snap components.");return e({...t,key:n})}Object.defineProperty(n,"__esModule",{value:!0}),n.jsxs=n.jsx=void 0,n.jsx=s,n.jsxs=function(e,t,n){return s(e,t,n)}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/jsx-runtime.cjs"}],[2790,{"../internals/index.cjs":2742,"../types/index.cjs":2798,"./components/index.cjs":2786,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RowStruct=n.BannerStruct=n.TooltipStruct=n.TooltipContentStruct=n.TooltipChildStruct=n.ValueStruct=n.TextStruct=n.SkeletonStruct=n.LinkStruct=n.HeadingStruct=n.DividerStruct=n.CopyableStruct=n.FooterStruct=n.FooterChildStruct=n.SectionStruct=n.FormStruct=n.FormChildStruct=n.BoxStruct=n.BoxChildrenStruct=n.AvatarStruct=n.FormattingStruct=n.ItalicStruct=n.BoldStruct=n.FieldStruct=n.FieldChildUnionStruct=n.FileInputStruct=n.RadioGroupStruct=n.RadioStruct=n.AssetSelectorStruct=n.SelectorStruct=n.SelectorOptionStruct=n.CardStruct=n.AccountSelectorStruct=n.AddressStruct=n.DropdownStruct=n.OptionStruct=n.AddressInputStruct=n.InputStruct=n.NumberInputPropsStruct=n.PasswordInputPropsStruct=n.TextInputPropsStruct=n.GenericInputPropsStruct=n.CheckboxStruct=n.ButtonStruct=n.IconStruct=n.ImageStruct=n.BorderRadiusStruct=n.ElementStruct=n.StringElementStruct=n.KeyStruct=void 0,n.assertJSXElement=n.isJSXElementUnsafe=n.isJSXElement=n.JSXElementStruct=n.RootJSXElementStruct=n.ContainerStruct=n.BoxChildStruct=n.SpinnerStruct=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("./components/index.cjs"),i=e("../internals/index.cjs"),o=e("../types/index.cjs");function c(e){const t=1===e.length?e[0]:(0,i.nullUnion)(e);return function(e){const t=(0,i.selectiveUnion)((n=>Array.isArray(n)?(0,s.array)((0,s.lazy)((()=>t))):e));return t}((0,s.nullable)((0,i.selectiveUnion)((e=>"boolean"==typeof e?(0,s.boolean)():t))))}function u(e){return(0,s.nullable)((0,i.selectiveUnion)((t=>"boolean"==typeof t?(0,s.boolean)():e)))}function l(e,t={}){return(0,s.object)({type:(0,i.literal)(e),props:(0,s.object)(t),key:(0,s.nullable)(n.KeyStruct)})}n.KeyStruct=(0,i.nullUnion)([(0,s.string)(),(0,s.number)()]),n.StringElementStruct=c([(0,s.string)()]),n.ElementStruct=(0,s.object)({type:(0,s.string)(),props:(0,s.record)((0,s.string)(),a.JsonStruct),key:(0,s.nullable)(n.KeyStruct)}),n.BorderRadiusStruct=(0,i.nullUnion)([(0,i.literal)("none"),(0,i.literal)("medium"),(0,i.literal)("full")]),n.ImageStruct=l("Image",{src:(0,i.svg)(),alt:(0,s.optional)((0,s.string)()),borderRadius:(0,s.optional)(n.BorderRadiusStruct)});const d=(0,i.nullUnion)(Object.values(r.IconName).map((e=>(0,i.literal)(e))));var p,m;n.IconStruct=l("Icon",{name:d,color:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("default"),(0,i.literal)("primary"),(0,i.literal)("muted")])),size:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("md"),(0,i.literal)("inherit")]))}),n.ButtonStruct=l("Button",{children:c([n.StringElementStruct,n.ImageStruct,n.IconStruct]),name:(0,s.optional)((0,s.string)()),type:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("button"),(0,i.literal)("submit")])),variant:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("primary"),(0,i.literal)("destructive")])),size:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("sm"),(0,i.literal)("md")])),disabled:(0,s.optional)((0,s.boolean)()),loading:(0,s.optional)((0,s.boolean)()),form:(0,s.optional)((0,s.string)())}),n.CheckboxStruct=l("Checkbox",{name:(0,s.string)(),checked:(0,s.optional)((0,s.boolean)()),label:(0,s.optional)((0,s.string)()),variant:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("default"),(0,i.literal)("toggle")])),disabled:(0,s.optional)((0,s.boolean)())}),n.GenericInputPropsStruct=(0,s.object)({name:(0,s.string)(),value:(0,s.optional)((0,s.string)()),placeholder:(0,s.optional)((0,s.string)()),disabled:(0,s.optional)((0,s.boolean)())}),n.TextInputPropsStruct=(0,s.assign)(n.GenericInputPropsStruct,(0,s.object)({type:(0,i.literal)("text")})),n.PasswordInputPropsStruct=(0,s.assign)(n.GenericInputPropsStruct,(0,s.object)({type:(0,i.literal)("password")})),n.NumberInputPropsStruct=(0,s.assign)(n.GenericInputPropsStruct,(0,s.object)({type:(0,i.literal)("number"),min:(0,s.optional)((0,s.number)()),max:(0,s.optional)((0,s.number)()),step:(0,s.optional)((0,s.number)())})),n.InputStruct=(p="Input",m=e=>{if((0,a.isPlainObject)(e)&&(0,a.hasProperty)(e,"type"))switch(e.type){case"text":return n.TextInputPropsStruct;case"password":return n.PasswordInputPropsStruct;case"number":return n.NumberInputPropsStruct;default:return n.GenericInputPropsStruct}return n.GenericInputPropsStruct},(0,s.object)({type:(0,i.literal)(p),props:(0,i.selectiveUnion)(m),key:(0,s.nullable)(n.KeyStruct)})),n.AddressInputStruct=l("AddressInput",{name:(0,s.string)(),chainId:a.CaipChainIdStruct,value:(0,s.optional)((0,s.string)()),placeholder:(0,s.optional)((0,s.string)()),disabled:(0,s.optional)((0,s.boolean)()),displayAvatar:(0,s.optional)((0,s.boolean)())}),n.OptionStruct=l("Option",{value:(0,s.string)(),children:(0,s.string)(),disabled:(0,s.optional)((0,s.boolean)())}),n.DropdownStruct=l("Dropdown",{name:(0,s.string)(),value:(0,s.optional)((0,s.string)()),children:c([n.OptionStruct]),disabled:(0,s.optional)((0,s.boolean)())}),n.AddressStruct=l("Address",{address:(0,i.selectiveUnion)((e=>"string"==typeof e&&e.startsWith("0x")?a.HexChecksumAddressStruct:a.CaipAccountIdStruct)),truncate:(0,s.optional)((0,s.boolean)()),displayName:(0,s.optional)((0,s.boolean)()),avatar:(0,s.optional)((0,s.boolean)())}),n.AccountSelectorStruct=l("AccountSelector",{name:(0,s.string)(),hideExternalAccounts:(0,s.optional)((0,s.boolean)()),chainIds:(0,s.optional)((0,s.array)(a.CaipChainIdStruct)),switchGlobalAccount:(0,s.optional)((0,s.boolean)()),value:(0,s.optional)(a.CaipAccountIdStruct),disabled:(0,s.optional)((0,s.boolean)())}),n.CardStruct=l("Card",{image:(0,s.optional)((0,s.string)()),title:(0,i.selectiveUnion)((e=>"object"==typeof e?n.AddressStruct:(0,s.string)())),description:(0,s.optional)((0,s.string)()),value:(0,s.string)(),extra:(0,s.optional)((0,s.string)())}),n.SelectorOptionStruct=l("SelectorOption",{value:(0,s.string)(),children:n.CardStruct,disabled:(0,s.optional)((0,s.boolean)())}),n.SelectorStruct=l("Selector",{name:(0,s.string)(),title:(0,s.string)(),value:(0,s.optional)((0,s.string)()),children:c([n.SelectorOptionStruct]),disabled:(0,s.optional)((0,s.boolean)())}),n.AssetSelectorStruct=l("AssetSelector",{name:(0,s.string)(),addresses:o.NonEip155CaipAccountIdsMatchedByAddressAndNamespaceStruct,chainIds:(0,s.optional)((0,s.array)(o.NonEip155ChainIdStruct)),value:(0,s.optional)(o.NonEip155AssetTypeStruct),disabled:(0,s.optional)((0,s.boolean)())}),n.RadioStruct=l("Radio",{value:(0,s.string)(),children:(0,s.string)(),disabled:(0,s.optional)((0,s.boolean)())}),n.RadioGroupStruct=l("RadioGroup",{name:(0,s.string)(),value:(0,s.optional)((0,s.string)()),children:c([n.RadioStruct]),disabled:(0,s.optional)((0,s.boolean)())}),n.FileInputStruct=l("FileInput",{name:(0,s.string)(),accept:(0,i.nullUnion)([(0,s.optional)((0,s.array)((0,s.string)()))]),compact:(0,s.optional)((0,s.boolean)()),disabled:(0,s.optional)((0,s.boolean)())});const h=[u((0,s.lazy)((()=>n.BoxChildStruct))),n.InputStruct],f=[n.InputStruct,u((0,s.lazy)((()=>n.BoxChildStruct)))],g=[u((0,s.lazy)((()=>n.BoxChildStruct))),n.InputStruct,u((0,s.lazy)((()=>n.BoxChildStruct)))],b=[n.AssetSelectorStruct,n.AddressInputStruct,n.AccountSelectorStruct,n.InputStruct,n.DropdownStruct,n.RadioGroupStruct,n.FileInputStruct,n.CheckboxStruct,n.SelectorStruct];n.FieldChildUnionStruct=(0,i.nullUnion)([...b,...h,...f,...g]);const y=(0,i.selectiveUnion)((e=>{const t=Array.isArray(e);return t&&3===e.length?(0,s.tuple)(g):t&&2===e.length?"Box"===(null===(n=e[0])||void 0===n?void 0:n.type)?(0,s.tuple)(h):(0,s.tuple)(f):(0,i.typedUnion)(b);var n}));n.FieldStruct=l("Field",{label:(0,s.optional)((0,s.string)()),error:(0,s.optional)((0,s.string)()),children:y}),n.BoldStruct=l("Bold",{children:c([(0,s.string)(),(0,s.lazy)((()=>n.ItalicStruct))])}),n.ItalicStruct=l("Italic",{children:c([(0,s.string)(),(0,s.lazy)((()=>n.BoldStruct))])}),n.FormattingStruct=(0,i.typedUnion)([n.BoldStruct,n.ItalicStruct]),n.AvatarStruct=l("Avatar",{address:a.CaipAccountIdStruct,size:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("sm"),(0,i.literal)("md"),(0,i.literal)("lg")]))}),n.BoxChildrenStruct=c([(0,s.lazy)((()=>n.BoxChildStruct))]),n.BoxStruct=l("Box",{children:n.BoxChildrenStruct,direction:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("horizontal"),(0,i.literal)("vertical")])),alignment:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("start"),(0,i.literal)("center"),(0,i.literal)("end"),(0,i.literal)("space-between"),(0,i.literal)("space-around")])),crossAlignment:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("start"),(0,i.literal)("center"),(0,i.literal)("end")])),center:(0,s.optional)((0,s.boolean)())}),n.FormChildStruct=n.BoxChildrenStruct,n.FormStruct=l("Form",{children:n.FormChildStruct,name:(0,s.string)()});const S=(0,s.refine)(n.ButtonStruct,"FooterButton",(e=>{if("string"==typeof e.props.children||"boolean"==typeof e.props.children||null===e.props.children)return!0;if(Array.isArray(e.props.children)){if(!e.props.children.some((e=>"string"!=typeof e&&"boolean"!=typeof e&&null!==e)))return!0}return"Footer buttons may only contain text."}));function k(e){return(0,s.is)(e,n.JSXElementStruct)}n.SectionStruct=l("Section",{children:n.BoxChildrenStruct,direction:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("horizontal"),(0,i.literal)("vertical")])),alignment:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("start"),(0,i.literal)("center"),(0,i.literal)("end"),(0,i.literal)("space-between"),(0,i.literal)("space-around")]))}),n.FooterChildStruct=(0,i.selectiveUnion)((e=>Array.isArray(e)?(0,s.tuple)([S,S]):S)),n.FooterStruct=l("Footer",{children:n.FooterChildStruct}),n.CopyableStruct=l("Copyable",{value:(0,s.string)(),sensitive:(0,s.optional)((0,s.boolean)())}),n.DividerStruct=l("Divider"),n.HeadingStruct=l("Heading",{children:n.StringElementStruct,size:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("sm"),(0,i.literal)("md"),(0,i.literal)("lg")]))}),n.LinkStruct=l("Link",{href:(0,s.string)(),children:c([n.FormattingStruct,(0,s.string)(),n.IconStruct,n.ImageStruct,n.AddressStruct])}),n.SkeletonStruct=l("Skeleton",{width:(0,s.optional)((0,s.union)([(0,s.number)(),(0,s.string)()])),height:(0,s.optional)((0,s.union)([(0,s.number)(),(0,s.string)()])),borderRadius:(0,s.optional)(n.BorderRadiusStruct)}),n.TextStruct=l("Text",{children:c([(0,i.selectiveUnion)((e=>"string"==typeof e?(0,s.string)():(0,i.typedUnion)([n.BoldStruct,n.ItalicStruct,n.LinkStruct,n.IconStruct,n.SkeletonStruct])))]),alignment:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("start"),(0,i.literal)("center"),(0,i.literal)("end")])),color:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("default"),(0,i.literal)("alternative"),(0,i.literal)("muted"),(0,i.literal)("error"),(0,i.literal)("success"),(0,i.literal)("warning")])),size:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("sm"),(0,i.literal)("md")])),fontWeight:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("regular"),(0,i.literal)("medium"),(0,i.literal)("bold")]))}),n.ValueStruct=l("Value",{value:(0,i.selectiveUnion)((e=>"string"==typeof e?(0,s.string)():n.TextStruct)),extra:(0,i.selectiveUnion)((e=>"string"==typeof e?(0,s.string)():n.TextStruct))}),n.TooltipChildStruct=(0,i.selectiveUnion)((e=>"boolean"==typeof e?(0,s.boolean)():(0,i.typedUnion)([n.TextStruct,n.BoldStruct,n.ItalicStruct,n.LinkStruct,n.ImageStruct,n.IconStruct]))),n.TooltipContentStruct=(0,i.selectiveUnion)((e=>"string"==typeof e?(0,s.string)():(0,i.typedUnion)([n.TextStruct,n.BoldStruct,n.ItalicStruct,n.LinkStruct,n.IconStruct]))),n.TooltipStruct=l("Tooltip",{children:(0,s.nullable)(n.TooltipChildStruct),content:n.TooltipContentStruct}),n.BannerStruct=l("Banner",{children:c([n.TextStruct,n.LinkStruct,n.IconStruct,n.ButtonStruct,n.BoldStruct,n.ItalicStruct,n.SkeletonStruct]),title:(0,s.string)(),severity:(0,s.union)([(0,i.literal)("danger"),(0,i.literal)("info"),(0,i.literal)("success"),(0,i.literal)("warning")])}),n.RowStruct=l("Row",{label:(0,s.string)(),children:(0,s.lazy)((()=>(0,i.typedUnion)([n.ValueStruct,n.BoxChildStruct]))),variant:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("default"),(0,i.literal)("warning"),(0,i.literal)("critical")])),tooltip:(0,s.optional)((0,s.string)())}),n.SpinnerStruct=l("Spinner"),n.BoxChildStruct=(0,i.typedUnion)([n.AccountSelectorStruct,n.AddressStruct,n.AssetSelectorStruct,n.AddressInputStruct,n.BoldStruct,n.BoxStruct,n.ButtonStruct,n.CopyableStruct,n.DividerStruct,n.DropdownStruct,n.RadioGroupStruct,n.FieldStruct,n.FileInputStruct,n.FormStruct,n.HeadingStruct,n.InputStruct,n.ImageStruct,n.ItalicStruct,n.LinkStruct,n.RowStruct,n.SpinnerStruct,n.TextStruct,n.TooltipStruct,n.CheckboxStruct,n.CardStruct,n.IconStruct,n.SelectorStruct,n.SectionStruct,n.AvatarStruct,n.BannerStruct,n.SkeletonStruct]),n.ContainerStruct=l("Container",{children:(0,i.selectiveUnion)((e=>Array.isArray(e)?(0,s.tuple)([n.BoxChildStruct,n.FooterStruct]):n.BoxChildStruct)),backgroundColor:(0,s.optional)((0,i.nullUnion)([(0,i.literal)("default"),(0,i.literal)("alternative")]))}),n.RootJSXElementStruct=(0,i.typedUnion)([n.BoxChildStruct,n.ContainerStruct]),n.JSXElementStruct=(0,i.typedUnion)([n.AssetSelectorStruct,n.AddressInputStruct,n.AccountSelectorStruct,n.ButtonStruct,n.InputStruct,n.FileInputStruct,n.FieldStruct,n.FormStruct,n.BoldStruct,n.ItalicStruct,n.AddressStruct,n.BoxStruct,n.CopyableStruct,n.DividerStruct,n.HeadingStruct,n.ImageStruct,n.LinkStruct,n.RowStruct,n.SpinnerStruct,n.TextStruct,n.DropdownStruct,n.OptionStruct,n.RadioGroupStruct,n.RadioStruct,n.ValueStruct,n.TooltipStruct,n.CheckboxStruct,n.FooterStruct,n.ContainerStruct,n.CardStruct,n.IconStruct,n.SelectorStruct,n.SelectorOptionStruct,n.SectionStruct,n.AvatarStruct,n.BannerStruct,n.SkeletonStruct]),n.isJSXElement=k,n.isJSXElementUnsafe=function(e){return(0,a.isPlainObject)(e)&&(0,a.hasProperty)(e,"type")&&(0,a.hasProperty)(e,"props")&&(0,a.hasProperty)(e,"key")},n.assertJSXElement=function(e){if(!k(e))throw new Error(`Expected a JSX element, but received ${JSON.stringify(e)}. Please refer to the documentation for the supported JSX elements and their props.`)}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/jsx/validation.cjs"}],[2791,{"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NonEip155AssetTypeStruct=n.NonEip155ChainIdStruct=n.NonEip155CaipAccountIdsMatchedByAddressAndNamespaceStruct=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils");n.NonEip155CaipAccountIdsMatchedByAddressAndNamespaceStruct=(0,s.refine)((0,s.array)(a.CaipAccountIdStruct),"Non-EIP-155 Matching Addresses Account ID List",(e=>{const t=e.map((e=>(0,a.parseCaipAccountId)(e)));if(!t.every((({address:e,chain:{namespace:n}})=>e===t[0].address&&n===t[0].chain.namespace)))return"All account IDs must have the same address and namespace.";return!t.some((({chain:{namespace:e}})=>e===a.KnownCaipNamespace.Eip155))||"All account IDs must have non-EIP-155 namespaces."})),n.NonEip155ChainIdStruct=(0,s.refine)(a.CaipChainIdStruct,"Non-EIP-155 Chain ID",(e=>{const{namespace:t}=(0,a.parseCaipChainId)(e);return t!==a.KnownCaipNamespace.Eip155||"Chain ID must not be an EIP-155 chain ID."})),n.NonEip155AssetTypeStruct=(0,s.refine)(a.CaipAssetTypeStruct,"Non-EIP-155 Asset Type",(e=>{const{chain:{namespace:t}}=(0,a.parseCaipAssetType)(e);return t!==a.KnownCaipNamespace.Eip155||"Asset type must not be an EIP-155 asset type."}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/caip.cjs"}],[2792,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/global.cjs"}],[2793,{"../../internals/index.cjs":2742,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetsLookupResponseStruct=n.AssetMetadataStruct=n.NonFungibleAssetMetadataStruct=n.NonFungibleAssetCollectionStruct=n.FungibleAssetMetadataStruct=n.AssetIconUrlStruct=n.FungibleAssetUnitStruct=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("../../internals/index.cjs");n.FungibleAssetUnitStruct=(0,s.object)({name:(0,s.optional)((0,s.string)()),symbol:(0,s.optional)((0,s.string)()),decimals:(0,s.number)()}),n.AssetIconUrlStruct=(0,s.refine)((0,s.string)(),"Asset URL",(e=>{try{const t=new URL(e);return(0,a.assert)("https:"===t.protocol||e.startsWith("data:image/svg+xml;base64,")),!0}catch{return"Invalid URL"}})),n.FungibleAssetMetadataStruct=(0,s.object)({name:(0,s.optional)((0,s.string)()),symbol:(0,s.optional)((0,s.string)()),fungible:(0,s.literal)(!0),iconUrl:n.AssetIconUrlStruct,units:(0,s.size)((0,s.array)(n.FungibleAssetUnitStruct),1,Infinity)}),n.NonFungibleAssetCollectionStruct=(0,s.object)({name:(0,s.string)(),address:a.CaipAccountIdStruct,symbol:(0,s.string)(),tokenCount:(0,s.optional)((0,s.number)()),creator:(0,s.optional)(a.CaipAccountIdStruct),imageUrl:(0,s.optional)(n.AssetIconUrlStruct)}),n.NonFungibleAssetMetadataStruct=(0,s.object)({fungible:(0,s.literal)(!1),name:(0,s.optional)((0,s.string)()),symbol:(0,s.optional)((0,s.string)()),imageUrl:(0,s.optional)(n.AssetIconUrlStruct),description:(0,s.optional)((0,s.string)()),acquiredAt:(0,s.optional)((0,s.number)()),isPossibleSpam:(0,s.optional)((0,s.boolean)()),attributes:(0,s.optional)((0,s.record)((0,s.string)(),(0,s.union)([(0,s.string)(),(0,s.number)()]))),collection:(0,s.optional)(n.NonFungibleAssetCollectionStruct)}),n.AssetMetadataStruct=(0,r.selectiveUnion)((e=>(0,a.isObject)(e)&&e.fungible?n.FungibleAssetMetadataStruct:n.NonFungibleAssetMetadataStruct)),n.OnAssetsLookupResponseStruct=(0,s.object)({assets:(0,s.record)(a.CaipAssetTypeOrIdStruct,(0,s.nullable)(n.AssetMetadataStruct))})}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/handlers/assets-lookup.cjs"}],[2794,{"./assets-lookup.cjs":2793,"./transaction.cjs":2795,"./user-input.cjs":2796},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./assets-lookup.cjs"),n),a(e("./transaction.cjs"),n),a(e("./user-input.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/handlers/index.cjs"}],[2795,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.SeverityLevel=void 0,function(e){e.Critical="critical"}(s||(n.SeverityLevel=s={}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/handlers/transaction.cjs"}],[2796,{"../../internals/index.cjs":2742,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UserInputEventStruct=n.FileUploadEventStruct=n.InputChangeEventStruct=n.FormSubmitEventStruct=n.AssetSelectorStateStruct=n.FileStruct=n.AccountSelectorStateStruct=n.ButtonClickEventStruct=n.GenericEventStruct=n.UserInputEventType=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("../../internals/index.cjs");var i;!function(e){e.ButtonClickEvent="ButtonClickEvent",e.FormSubmitEvent="FormSubmitEvent",e.InputChangeEvent="InputChangeEvent",e.FileUploadEvent="FileUploadEvent"}(i||(n.UserInputEventType=i={})),n.GenericEventStruct=(0,s.object)({type:(0,s.string)(),name:(0,s.optional)((0,s.string)())}),n.ButtonClickEventStruct=(0,s.assign)(n.GenericEventStruct,(0,s.object)({type:(0,r.literal)(i.ButtonClickEvent),name:(0,s.optional)((0,s.string)())})),n.AccountSelectorStateStruct=(0,s.object)({accountId:(0,s.string)(),addresses:(0,s.array)(a.CaipAccountIdStruct)}),n.FileStruct=(0,s.object)({name:(0,s.string)(),size:(0,s.number)(),contentType:(0,s.string)(),contents:(0,s.string)()}),n.AssetSelectorStateStruct=(0,s.object)({asset:a.CaipAssetTypeStruct,name:(0,s.string)(),symbol:(0,s.string)()}),n.FormSubmitEventStruct=(0,s.assign)(n.GenericEventStruct,(0,s.object)({type:(0,r.literal)(i.FormSubmitEvent),value:(0,s.record)((0,s.string)(),(0,s.nullable)((0,s.union)([(0,s.string)(),n.FileStruct,(0,s.boolean)(),n.AccountSelectorStateStruct,n.AssetSelectorStateStruct]))),name:(0,s.string)()})),n.InputChangeEventStruct=(0,s.assign)(n.GenericEventStruct,(0,s.object)({type:(0,r.literal)(i.InputChangeEvent),name:(0,s.string)(),value:(0,s.union)([(0,s.string)(),(0,s.boolean)(),n.AccountSelectorStateStruct,n.AssetSelectorStateStruct])})),n.FileUploadEventStruct=(0,s.assign)(n.GenericEventStruct,(0,s.object)({type:(0,r.literal)(i.FileUploadEvent),name:(0,s.string)(),file:(0,s.nullable)(n.FileStruct)})),n.UserInputEventStruct=(0,r.typedUnion)([n.ButtonClickEventStruct,n.FormSubmitEventStruct,n.InputChangeEventStruct,n.FileUploadEventStruct])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/handlers/user-input.cjs"}],[2797,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/images.cjs"}],[2798,{"./caip.cjs":2791,"./global.cjs":2792,"./handlers/index.cjs":2794,"./images.cjs":2797,"./interface.cjs":2799,"./methods/index.cjs":2802},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),e("./global.cjs"),e("./images.cjs"),a(e("./caip.cjs"),n),a(e("./handlers/index.cjs"),n),a(e("./methods/index.cjs"),n),a(e("./interface.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/index.cjs"}],[2799,{"../internals/index.cjs":2742,"../jsx/index.cjs":2787,"../ui/index.cjs":2820,"./handlers/index.cjs":2794,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ContentType=n.InterfaceContextStruct=n.ComponentOrElementStruct=n.InterfaceStateStruct=n.FormStateStruct=n.StateStruct=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("./handlers/index.cjs"),i=e("../internals/index.cjs"),o=e("../jsx/index.cjs"),c=e("../ui/index.cjs");var u;n.StateStruct=(0,s.union)([r.AccountSelectorStateStruct,r.AssetSelectorStateStruct,r.FileStruct,(0,s.string)(),(0,s.boolean)(),a.CaipAccountIdStruct]),n.FormStateStruct=(0,s.record)((0,s.string)(),(0,s.nullable)(n.StateStruct)),n.InterfaceStateStruct=(0,s.record)((0,s.string)(),(0,s.union)([n.FormStateStruct,(0,s.nullable)(n.StateStruct)])),n.ComponentOrElementStruct=(0,i.selectiveUnion)((e=>(0,a.isObject)(e)&&!(0,a.hasProperty)(e,"props")?c.ComponentStruct:o.RootJSXElementStruct)),n.InterfaceContextStruct=(0,s.record)((0,s.string)(),a.JsonStruct),function(e){e.Insight="Insight",e.Dialog="Dialog",e.Notification="Notification",e.HomePage="HomePage"}(u||(n.ContentType=u={}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/interface.cjs"}],[2800,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.DialogType=void 0,function(e){e.Alert="alert",e.Confirmation="confirmation",e.Prompt="prompt"}(s||(n.DialogType=s={}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/methods/dialog.cjs"}],[2801,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.AuxiliaryFileEncoding=void 0,function(e){e.Base64="base64",e.Hex="hex",e.Utf8="utf8"}(s||(n.AuxiliaryFileEncoding=s={}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/methods/get-file.cjs"}],[2802,{"./dialog.cjs":2800,"./get-file.cjs":2801,"./manage-state.cjs":2803,"./notify.cjs":2804},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./dialog.cjs"),n),a(e("./get-file.cjs"),n),a(e("./manage-state.cjs"),n),a(e("./notify.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/methods/index.cjs"}],[2803,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.ManageStateOperation=void 0,function(e){e.ClearState="clear",e.GetState="get",e.UpdateState="update"}(s||(n.ManageStateOperation=s={}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/methods/manage-state.cjs"}],[2804,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.NotificationType=void 0,function(e){e.InApp="inApp",e.Native="native"}(s||(n.NotificationType=s={}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/types/methods/notify.cjs"}],[2805,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createBuilder=void 0;const s=e("@metamask/utils");n.createBuilder=function(e,t,n=[]){return(...a)=>{if(1===a.length&&(0,s.isPlainObject)(a[0])){const n={...a[0],type:e};return(0,s.assertStruct)(n,t,`Invalid ${e} component`),n}const r=n.reduce(((e,t,n)=>a[n]!==undefined?{...e,[t]:a[n]}:e),{type:e});return(0,s.assertStruct)(r,t,`Invalid ${e} component`),r}}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/builder.cjs"}],[2806,{"./components/index.cjs":2814,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertIsComponent=n.isComponent=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("./components/index.cjs");n.isComponent=function(e){return(0,s.is)(e,r.ComponentStruct)},n.assertIsComponent=function(e){(0,a.assertStruct)(e,r.ComponentStruct,"Invalid component")}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/component.cjs"}],[2807,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.address=n.AddressStruct=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("../../internals/index.cjs"),i=e("../builder.cjs"),o=e("../nodes.cjs");n.AddressStruct=(0,s.assign)(o.LiteralStruct,(0,s.object)({type:(0,r.literal)(o.NodeType.Address),value:a.HexChecksumAddressStruct})),n.address=(0,i.createBuilder)(o.NodeType.Address,n.AddressStruct,["value"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/address.cjs"}],[2808,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.button=n.ButtonStruct=n.ButtonType=n.ButtonVariant=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");var o,c;!function(e){e.Primary="primary",e.Secondary="secondary"}(o||(n.ButtonVariant=o={})),function(e){e.Button="button",e.Submit="submit"}(c||(n.ButtonType=c={})),n.ButtonStruct=(0,s.assign)(i.LiteralStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Button),value:(0,s.string)(),variant:(0,s.optional)((0,s.union)([(0,a.enumValue)(o.Primary),(0,a.enumValue)(o.Secondary)])),buttonType:(0,s.optional)((0,s.union)([(0,a.enumValue)(c.Button),(0,a.enumValue)(c.Submit)])),name:(0,s.optional)((0,s.string)())})),n.button=(0,r.createBuilder)(i.NodeType.Button,n.ButtonStruct,["value","buttonType","name","variant"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/button.cjs"}],[2809,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.copyable=n.CopyableStruct=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");n.CopyableStruct=(0,s.assign)(i.LiteralStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Copyable),value:(0,s.string)(),sensitive:(0,s.optional)((0,s.boolean)())})),n.copyable=(0,r.createBuilder)(i.NodeType.Copyable,n.CopyableStruct,["value","sensitive"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/copyable.cjs"}],[2810,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.divider=n.DividerStruct=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");n.DividerStruct=(0,s.assign)(i.NodeStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Divider)})),n.divider=(0,r.createBuilder)(i.NodeType.Divider,n.DividerStruct)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/divider.cjs"}],[2811,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"./button.cjs":2808,"./input.cjs":2815,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.form=n.FormStruct=n.FormComponentStruct=void 0;const s=e("@metamask/superstruct"),a=e("./button.cjs"),r=e("./input.cjs"),i=e("../../internals/index.cjs"),o=e("../builder.cjs"),c=e("../nodes.cjs");n.FormComponentStruct=(0,s.union)([r.InputStruct,a.ButtonStruct]),n.FormStruct=(0,s.assign)(c.NodeStruct,(0,s.object)({type:(0,i.literal)(c.NodeType.Form),children:(0,s.array)(n.FormComponentStruct),name:(0,s.string)()})),n.form=(0,o.createBuilder)(c.NodeType.Form,n.FormStruct,["name","children"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/form.cjs"}],[2812,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.heading=n.HeadingStruct=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");n.HeadingStruct=(0,s.assign)(i.LiteralStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Heading),value:(0,s.string)()})),n.heading=(0,r.createBuilder)(i.NodeType.Heading,n.HeadingStruct,["value"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/heading.cjs"}],[2813,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.image=n.ImageStruct=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");n.ImageStruct=(0,s.assign)(i.NodeStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Image),value:(0,a.svg)()})),n.image=(0,r.createBuilder)(i.NodeType.Image,n.ImageStruct,["value"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/image.cjs"}],[2814,{"./address.cjs":2807,"./button.cjs":2808,"./copyable.cjs":2809,"./divider.cjs":2810,"./form.cjs":2811,"./heading.cjs":2812,"./image.cjs":2813,"./input.cjs":2815,"./panel.cjs":2816,"./row.cjs":2817,"./spinner.cjs":2818,"./text.cjs":2819},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.PanelStruct=n.panel=n.ComponentStruct=n.ImageStruct=n.image=void 0,a(e("./address.cjs"),n),a(e("./copyable.cjs"),n),a(e("./divider.cjs"),n),a(e("./heading.cjs"),n);var r=e("./image.cjs");Object.defineProperty(n,"image",{enumerable:!0,get:function(){return r.image}}),Object.defineProperty(n,"ImageStruct",{enumerable:!0,get:function(){return r.ImageStruct}});var i=e("./panel.cjs");Object.defineProperty(n,"ComponentStruct",{enumerable:!0,get:function(){return i.ComponentStruct}}),Object.defineProperty(n,"panel",{enumerable:!0,get:function(){return i.panel}}),Object.defineProperty(n,"PanelStruct",{enumerable:!0,get:function(){return i.PanelStruct}}),a(e("./spinner.cjs"),n),a(e("./text.cjs"),n),a(e("./row.cjs"),n),a(e("./button.cjs"),n),a(e("./input.cjs"),n),a(e("./form.cjs"),n)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/index.cjs"}],[2815,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.input=n.InputStruct=n.InputType=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");var o;!function(e){e.Text="text",e.Number="number",e.Password="password"}(o||(n.InputType=o={})),n.InputStruct=(0,s.assign)(i.LiteralStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Input),value:(0,s.optional)((0,s.string)()),name:(0,s.string)(),inputType:(0,s.optional)((0,s.union)([(0,a.enumValue)(o.Text),(0,a.enumValue)(o.Password),(0,a.enumValue)(o.Number)])),placeholder:(0,s.optional)((0,s.string)()),label:(0,s.optional)((0,s.string)()),error:(0,s.optional)((0,s.string)())})),n.input=(0,r.createBuilder)(i.NodeType.Input,n.InputStruct,["name","inputType","placeholder","value","label"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/input.cjs"}],[2816,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"./address.cjs":2807,"./button.cjs":2808,"./copyable.cjs":2809,"./divider.cjs":2810,"./form.cjs":2811,"./heading.cjs":2812,"./image.cjs":2813,"./input.cjs":2815,"./row.cjs":2817,"./spinner.cjs":2818,"./text.cjs":2819,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentStruct=n.panel=n.PanelStruct=n.ParentStruct=void 0;const s=e("@metamask/superstruct"),a=e("./address.cjs"),r=e("./button.cjs"),i=e("./copyable.cjs"),o=e("./divider.cjs"),c=e("./form.cjs"),u=e("./heading.cjs"),l=e("./image.cjs"),d=e("./input.cjs"),p=e("./row.cjs"),m=e("./spinner.cjs"),h=e("./text.cjs"),f=e("../../internals/index.cjs"),g=e("../builder.cjs"),b=e("../nodes.cjs");n.ParentStruct=(0,s.assign)(b.NodeStruct,(0,s.object)({children:(0,s.array)((0,s.lazy)((()=>n.ComponentStruct)))})),n.PanelStruct=(0,s.assign)(n.ParentStruct,(0,s.object)({type:(0,f.literal)(b.NodeType.Panel)})),n.panel=(0,g.createBuilder)(b.NodeType.Panel,n.PanelStruct,["children"]),n.ComponentStruct=(0,f.typedUnion)([i.CopyableStruct,o.DividerStruct,u.HeadingStruct,l.ImageStruct,n.PanelStruct,m.SpinnerStruct,h.TextStruct,p.RowStruct,a.AddressStruct,d.InputStruct,c.FormStruct,r.ButtonStruct])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/panel.cjs"}],[2817,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"./address.cjs":2807,"./image.cjs":2813,"./text.cjs":2819,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.row=n.RowStruct=n.RowVariant=void 0;const s=e("@metamask/superstruct"),a=e("./address.cjs"),r=e("./image.cjs"),i=e("./text.cjs"),o=e("../../internals/index.cjs"),c=e("../builder.cjs"),u=e("../nodes.cjs");var l;!function(e){e.Default="default",e.Critical="critical",e.Warning="warning"}(l||(n.RowVariant=l={}));const d=(0,s.union)([r.ImageStruct,i.TextStruct,a.AddressStruct]);n.RowStruct=(0,s.assign)(u.LiteralStruct,(0,s.object)({type:(0,o.literal)(u.NodeType.Row),variant:(0,s.optional)((0,s.union)([(0,o.enumValue)(l.Default),(0,o.enumValue)(l.Critical),(0,o.enumValue)(l.Warning)])),label:(0,s.string)(),value:d})),n.row=(0,c.createBuilder)(u.NodeType.Row,n.RowStruct,["label","value","variant"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/row.cjs"}],[2818,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.spinner=n.SpinnerStruct=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");n.SpinnerStruct=(0,s.assign)(i.NodeStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Spinner)})),n.spinner=(0,r.createBuilder)(i.NodeType.Spinner,n.SpinnerStruct)}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/spinner.cjs"}],[2819,{"../../internals/index.cjs":2742,"../builder.cjs":2805,"../nodes.cjs":2821,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.text=n.TextStruct=void 0;const s=e("@metamask/superstruct"),a=e("../../internals/index.cjs"),r=e("../builder.cjs"),i=e("../nodes.cjs");n.TextStruct=(0,s.assign)(i.LiteralStruct,(0,s.object)({type:(0,a.literal)(i.NodeType.Text),value:(0,s.string)(),markdown:(0,s.optional)((0,s.boolean)())})),n.text=(0,r.createBuilder)(i.NodeType.Text,n.TextStruct,["value","markdown"])}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/components/text.cjs"}],[2820,{"./component.cjs":2806,"./components/index.cjs":2814,"./nodes.cjs":2821},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.NodeType=void 0,a(e("./components/index.cjs"),n),a(e("./component.cjs"),n);var r=e("./nodes.cjs");Object.defineProperty(n,"NodeType",{enumerable:!0,get:function(){return r.NodeType}})}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/index.cjs"}],[2821,{"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LiteralStruct=n.NodeStruct=n.NodeType=void 0;const s=e("@metamask/superstruct");var a;!function(e){e.Copyable="copyable",e.Divider="divider",e.Heading="heading",e.Panel="panel",e.Spinner="spinner",e.Text="text",e.Image="image",e.Row="row",e.Address="address",e.Button="button",e.Input="input",e.Form="form"}(a||(n.NodeType=a={})),n.NodeStruct=(0,s.object)({type:(0,s.string)()}),n.LiteralStruct=(0,s.assign)(n.NodeStruct,(0,s.object)({value:(0,s.unknown)()}))}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/dist/ui/nodes.cjs"}],[2822,{"./dist/jsx/jsx-runtime.cjs":2789},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("./dist/jsx/jsx-runtime.cjs")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/jsx-runtime.js"}],[2823,{"./dist/jsx/index.cjs":2787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("./dist/jsx/index.cjs")}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/jsx.js"}],[2824,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={name:"@metamask/snaps-sdk",version:"9.2.0",description:"A library containing the core functionality for building MetaMask Snaps",keywords:["MetaMask","Snaps","Ethereum"],homepage:"https://github.com/MetaMask/snaps/tree/main/packages/snaps-sdk#readme",bugs:{url:"https://github.com/MetaMask/snaps/issues"},repository:{type:"git",url:"https://github.com/MetaMask/snaps.git"},license:"ISC",sideEffects:!1,exports:{".":{import:{types:"./dist/index.d.mts",default:"./dist/index.mjs"},require:{types:"./dist/index.d.cts",default:"./dist/index.cjs"}},"./jsx":{import:{types:"./dist/jsx/index.d.mts",default:"./dist/jsx/index.mjs"},require:{types:"./dist/jsx/index.d.cts",default:"./dist/jsx/index.cjs"}},"./jsx-runtime":{import:{types:"./dist/jsx/jsx-runtime.d.mts",default:"./dist/jsx/jsx-runtime.mjs"},require:{types:"./dist/jsx/jsx-runtime.d.cts",default:"./dist/jsx/jsx-runtime.cjs"}},"./jsx-dev-runtime":{import:{types:"./dist/jsx/jsx-dev-runtime.d.mts",default:"./dist/jsx/jsx-dev-runtime.mjs"},require:{types:"./dist/jsx/jsx-dev-runtime.d.cts",default:"./dist/jsx/jsx-dev-runtime.cjs"}},"./package.json":"./package.json"},main:"./dist/index.cjs",module:"./dist/index.mjs",types:"./dist/index.d.cts",files:["dist","jsx.js","jsx-dev-runtime.js","jsx-runtime.js","jsx.d.ts","jsx-dev-runtime.d.ts","jsx-runtime.d.ts"],scripts:{build:"ts-bridge --project tsconfig.build.json --verbose --clean --no-references","changelog:update":"../../scripts/update-changelog.sh @metamask/snaps-sdk","changelog:validate":"../../scripts/validate-changelog.sh @metamask/snaps-sdk",lint:"yarn lint:eslint && yarn lint:misc --check && yarn changelog:validate && yarn lint:dependencies","lint:ci":"yarn lint","lint:dependencies":"depcheck","lint:eslint":"eslint . --cache","lint:fix":"yarn lint:eslint --fix && yarn lint:misc --write","lint:misc":'prettier --no-error-on-unmatched-pattern --log-level warn "**/*.json" "**/*.md" "**/*.html" "!CHANGELOG.md" --ignore-path ../../.gitignore',"publish:preview":"yarn npm publish --tag preview","since-latest-release":"../../scripts/since-latest-release.sh",test:"jest --reporters=jest-silent-reporter","test:clean":"jest --clearCache","test:post":"jest-it-up","test:verbose":"jest --verbose","test:watch":"jest --watch"},dependencies:{"@metamask/key-tree":"^10.1.1","@metamask/providers":"^22.1.0","@metamask/rpc-errors":"^7.0.3","@metamask/superstruct":"^3.2.1","@metamask/utils":"^11.4.2"},devDependencies:{"@lavamoat/allow-scripts":"^3.3.4","@metamask/auto-changelog":"^5.0.2","@ts-bridge/cli":"^0.6.1","@types/jest":"^27.5.1",deepmerge:"^4.2.2",depcheck:"^1.4.7",eslint:"^9.11.0","expect-type":"^0.17.3",jest:"^29.0.2","jest-fetch-mock":"^3.0.3","jest-it-up":"^2.0.0","jest-silent-reporter":"^0.6.0",prettier:"^3.3.3","ts-jest":"^29.1.1",typescript:"~5.3.3"},engines:{node:"^20 || >=22"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"}}}}},{package:"@metamask/snaps-sdk",file:"node_modules/@metamask/snaps-sdk/package.json"}],[2825,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.snapOwnsAccount=n.createChainIdList=n.createAccountList=void 0;const s=e("@metamask/utils");n.createAccountList=function(e,t){return t.map((t=>`${t}:${e}`))},n.createChainIdList=function(e,t){return t&&0!==t.length?e.reduce(((e,n)=>{if("eip155:0"===n){const n=t.filter((e=>{const{namespace:t}=(0,s.parseCaipChainId)(e);return t===s.KnownCaipNamespace.Eip155}));e.push(...n)}else t.includes(n)&&e.push(n);return e}),[]):e},n.snapOwnsAccount=function(e,t){var n;return(null===(n=t.metadata.snap)||void 0===n?void 0:n.id)===e}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/account.cjs"}],[2826,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isEqual=void 0,n.isEqual=function(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/array.cjs"}],[2827,{"./base64.cjs":2828,"./constants.cjs":2832,"@metamask/snaps-sdk":2739,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateAuxiliaryFiles=n.encodeAuxiliaryFile=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/utils"),r=e("./base64.cjs"),i=e("./constants.cjs");n.encodeAuxiliaryFile=async function(e,t){if(t===s.AuxiliaryFileEncoding.Base64)return e;const n=await(0,r.decodeBase64)(e);return t===s.AuxiliaryFileEncoding.Utf8?(0,a.bytesToString)(n):(0,a.bytesToHex)(n)},n.validateAuxiliaryFiles=function(e){for(const t of e)(0,a.assert)(t.size<i.MAX_FILE_SIZE,"Static files required by the Snap must be smaller than 64 MB.")}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/auxiliary-files.cjs"}],[2828,{"./bytes.cjs":2829,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeBase64=n.encodeBase64=void 0;const s=e("@metamask/utils"),a=e("./bytes.cjs");n.encodeBase64=async function(e){const t=(0,a.getBytes)(e);return"FileReader"in globalThis?await new Promise(((e,n)=>{const s=Object.assign(new FileReader,{onload:()=>e(s.result.replace("data:application/octet-stream;base64,","")),onerror:()=>n(s.error)});s.readAsDataURL(new File([t],"",{type:"application/octet-stream"}))})):(0,s.bytesToBase64)(t)},n.decodeBase64=async function(e){const t=await fetch(`data:application/octet-stream;base64,${e}`);return new Uint8Array(await t.arrayBuffer())}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/base64.cjs"}],[2829,{"./virtual-file/VirtualFile.cjs":2872,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getBytes=void 0;const s=e("@metamask/utils"),a=e("./virtual-file/VirtualFile.cjs");n.getBytes=function(e){const t=e instanceof a.VirtualFile?e.value:e;return"string"==typeof t?(0,s.stringToBytes)(t):t}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/bytes.cjs"}],[2830,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.SnapCaveatType=void 0,function(e){e.PermittedDerivationPaths="permittedDerivationPaths",e.PermittedCoinTypes="permittedCoinTypes",e.SnapCronjob="snapCronjob",e.TransactionOrigin="transactionOrigin",e.SignatureOrigin="signatureOrigin",e.RpcOrigin="rpcOrigin",e.KeyringOrigin="keyringOrigin",e.SnapIds="snapIds",e.ChainIds="chainIds",e.LookupMatchers="lookupMatchers",e.MaxRequestTime="maxRequestTime",e.ProtocolSnapScopes="protocolSnapScopes"}(s||(n.SnapCaveatType=s={}))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/caveats.cjs"}],[2831,{"./bytes.cjs":2829,"@metamask/utils":2974,"@noble/hashes/sha256":3027},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.checksumFiles=n.checksum=void 0;const s=e("@metamask/utils"),a=e("@noble/hashes/sha256"),r=e("./bytes.cjs");async function i(e){var t;const n=(0,r.getBytes)(e);return"crypto"in globalThis&&"object"==typeof globalThis.crypto&&null!==(t=crypto.subtle)&&void 0!==t&&t.digest?new Uint8Array(await crypto.subtle.digest("SHA-256",n)):(0,a.sha256)(n)}n.checksum=i,n.checksumFiles=async function(e){const t=await Promise.all([...e].sort(((e,t)=>((0,s.assert)(e.path!==t.path,"Tried to sort files with non-unique paths."),e.path<t.path?-1:1))).map((async e=>i(e))));return i((0,s.concatBytes)(t))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/checksum.cjs"}],[2832,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_FILE_SIZE=void 0,n.MAX_FILE_SIZE=64e6}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/constants.cjs"}],[2833,{"./time.cjs":2866,"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875,"@metamask/utils":2974,"cron-parser":4212},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isCronjobSpecificationArray=n.CronjobSpecificationArrayStruct=n.isCronjobSpecification=n.CronjobSpecificationStruct=n.CronExpressionStruct=n.CronjobRpcRequestStruct=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("cron-parser"),o=e("./time.cjs");n.CronjobRpcRequestStruct=(0,a.object)({jsonrpc:(0,a.optional)(r.JsonRpcVersionStruct),id:(0,a.optional)(r.JsonRpcIdStruct),method:(0,a.string)(),params:(0,a.optional)(r.JsonRpcParamsStruct)}),n.CronExpressionStruct=(0,a.refine)((0,a.string)(),"cronjob expression",(e=>{try{return(0,i.parseExpression)(e),!0}catch{return`Expected a cronjob expression, but received: "${e}"`}}));const c=(0,a.object)({expression:n.CronExpressionStruct,request:n.CronjobRpcRequestStruct}),u=(0,a.object)({duration:o.ISO8601DurationStruct,request:n.CronjobRpcRequestStruct});n.CronjobSpecificationStruct=(0,s.selectiveUnion)((e=>(0,r.isObject)(e)&&(0,r.hasProperty)(e,"duration")?u:c)),n.isCronjobSpecification=function(e){try{return(0,a.create)(e,n.CronjobSpecificationStruct),!0}catch{return!1}},n.CronjobSpecificationArrayStruct=(0,a.array)(n.CronjobSpecificationStruct),n.isCronjobSpecificationArray=function(e){try{return(0,a.create)(e,n.CronjobSpecificationArrayStruct),!0}catch{return!1}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/cronjob.cjs"}],[2834,{"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.currency=void 0;const s=e("@metamask/superstruct");n.currency=function(e){const t=e.toLowerCase();return(0,s.coerce)((0,s.literal)(t),(0,s.literal)(e.toUpperCase()),(e=>(0,s.create)(e.toLowerCase(),(0,s.literal)(t))))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/currency.cjs"}],[2835,{rfdc:5367},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.deepClone=void 0;const a=s(e("rfdc"));n.deepClone=(0,a.default)({proto:!1,circles:!1})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/deep-clone.cjs"}],[2836,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_ENDOWMENTS=void 0,n.DEFAULT_ENDOWMENTS=Object.freeze(["atob","btoa","BigInt","console","crypto","Date","Math","setTimeout","clearTimeout","SubtleCrypto","TextDecoder","TextEncoder","URL","URLSearchParams","setInterval","clearInterval","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","isSecureContext","Intl","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","DataView","ArrayBuffer","AbortController","AbortSignal"])}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/default-endowments.cjs"}],[2837,{"./array.cjs":2826,"@metamask/slip44":2599},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getSlip44ProtocolName=n.getSnapDerivationPathName=n.SNAPS_DERIVATION_PATHS=void 0;const a=s(e("@metamask/slip44")),r=e("./array.cjs");function i(e){var t;return"1"===String(e)?"Test Networks":(null===(t=a.default[e])||void 0===t?void 0:t.name)??null}n.SNAPS_DERIVATION_PATHS=[{path:["m","44'","0'"],curve:"ed25519",name:"Test BIP-32 Path (ed25519)"},{path:["m","44'","1'"],curve:"secp256k1",name:"Testnet"},{path:["m","44'","0'"],curve:"secp256k1",name:"Bitcoin Legacy"},{path:["m","49'","0'"],curve:"secp256k1",name:"Bitcoin Nested SegWit"},{path:["m","49'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Nested SegWit"},{path:["m","84'","0'"],curve:"secp256k1",name:"Bitcoin Native SegWit"},{path:["m","84'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Native SegWit"},{path:["m","86'","0'"],curve:"secp256k1",name:"Bitcoin Taproot"},{path:["m","86'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Taproot"},{path:["m","44'","501'"],curve:"ed25519",name:"Solana"},{path:["m","44'","501'","0'","0'"],curve:"ed25519",name:"Solana"},{path:["m","44'","2'"],curve:"secp256k1",name:"Litecoin"},{path:["m","44'","3'"],curve:"secp256k1",name:"Dogecoin"},{path:["m","44'","60'"],curve:"secp256k1",name:"Ethereum"},{path:["m","44'","118'"],curve:"secp256k1",name:"Atom"},{path:["m","44'","145'"],curve:"secp256k1",name:"Bitcoin Cash"},{path:["m","44'","637'"],curve:"ed25519",name:"Aptos"},{path:["m","44'","714'"],curve:"secp256k1",name:"Binance (BNB)"},{path:["m","44'","784'"],curve:"ed25519",name:"Sui"},{path:["m","44'","931'"],curve:"secp256k1",name:"THORChain (RUNE)"},{path:["m","44'","330'"],curve:"secp256k1",name:"Terra (LUNA)"},{path:["m","44'","459'"],curve:"secp256k1",name:"Kava"},{path:["m","44'","529'"],curve:"secp256k1",name:"Secret Network"},{path:["m","44'","397'","0'"],curve:"ed25519",name:"NEAR Protocol"},{path:["m","44'","1'","0'"],curve:"ed25519",name:"Testnet"},{path:["m","44'","472'"],curve:"ed25519",name:"Arweave"},{path:["m","44'","12586'"],curve:"secp256k1",name:"Mina"},{path:["m","44'","242'"],curve:"ed25519",name:"Nimiq"},{path:["m","44'","1729'","0'","0'"],curve:"ed25519",name:"Tezos"},{path:["m","1789'","0'"],curve:"ed25519",name:"Vega"},{path:["m","1852'","1815'"],curve:"ed25519Bip32",name:"Cardano"},{path:["m","44'","508'","0'","0'","0'"],curve:"ed25519",name:"MultiversX"},{path:["m","44'","709'"],curve:"secp256k1",name:"Avail"},{path:["m","44'","626'"],curve:"ed25519",name:"Kadena"},{path:["m","44'","632'"],curve:"ed25519",name:"Massa"}],n.getSnapDerivationPathName=function(e,t){const s=n.SNAPS_DERIVATION_PATHS.find((n=>n.curve===t&&(0,r.isEqual)(n.path,e)));if(s)return s.name;if("secp256k1"===t&&"m"===e[0]&&"44'"===e[1]&&e[2].endsWith("'")){return i(e[2].slice(0,-1))??null}return null},n.getSlip44ProtocolName=i}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/derivation-paths.cjs"}],[2838,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.STATE_ENCRYPTION_MAGIC_VALUE=n.SIP_6_MAGIC_VALUE=void 0,n.SIP_6_MAGIC_VALUE="1399742832'",n.STATE_ENCRYPTION_MAGIC_VALUE="572232532'"}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/entropy.cjs"}],[2839,{"@metamask/rpc-errors":2524,"@metamask/snaps-sdk":2739,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function a(e,t){return e.get(i(e,t))}function r(e,t,n){return e.set(i(e,t),n),n}function i(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}Object.defineProperty(n,"__esModule",{value:!0}),n.unwrapError=n.isWrappedSnapError=n.isSerializedSnapError=n.isSnapError=n.WrappedSnapError=n.SNAP_ERROR_WRAPPER_MESSAGE=n.SNAP_ERROR_WRAPPER_CODE=void 0;const o=e("@metamask/rpc-errors"),c=e("@metamask/snaps-sdk"),u=e("@metamask/utils");n.SNAP_ERROR_WRAPPER_CODE=-31001,n.SNAP_ERROR_WRAPPER_MESSAGE="Wrapped Snap Error";var l=new WeakMap,d=new WeakMap,p=new WeakMap;class m extends Error{constructor(e){const t=(0,c.getErrorMessage)(e);super(t),s(this,l,void 0),s(this,d,void 0),s(this,p,void 0),r(l,this,e),r(d,this,t),r(p,this,(0,c.getErrorStack)(e)??undefined)}get name(){return"WrappedSnapError"}get message(){return a(d,this)}get stack(){return a(p,this)}toJSON(){const e=h(a(l,this))?a(l,this).serialize():(0,o.serializeCause)(a(l,this));return{code:n.SNAP_ERROR_WRAPPER_CODE,message:n.SNAP_ERROR_WRAPPER_MESSAGE,data:{cause:e}}}serialize(){return this.toJSON()}}function h(e){if((0,u.isObject)(e)&&"serialize"in e&&"function"==typeof e.serialize){const t=e.serialize();return(0,u.isJsonRpcError)(t)&&f(t)}return!1}function f(e){return e.code===c.SNAP_ERROR_CODE&&e.message===c.SNAP_ERROR_MESSAGE}function g(e){return(0,u.isJsonRpcError)(e)&&e.code===n.SNAP_ERROR_WRAPPER_CODE&&e.message===n.SNAP_ERROR_WRAPPER_MESSAGE}function b(e,t,n,s){const a=new o.JsonRpcError(e,t,s);return a.stack=n??undefined,a}n.WrappedSnapError=m,n.isSnapError=h,n.isSerializedSnapError=f,n.isWrappedSnapError=g,n.unwrapError=function(e){if(g(e)){if((0,u.isJsonRpcError)(e.data.cause)){if(f(e.data.cause)){const{code:t,message:n,stack:s,data:a}=e.data.cause.data.cause;return[b(t,n,s,a),!0]}if((0,u.isObject)(e.data.cause.data)&&(0,u.isObject)(e.data.cause.data.cause)&&e.data.cause.message===e.data.cause.data.cause.message){const t=e.data.cause.data.cause,{code:n,message:s}=e.data.cause;return[b(n,s,(0,c.getErrorStack)(t)),!1]}const{code:t,message:n,stack:s,data:a}=e.data.cause;return[b(t,n,s,a),!1]}return[b(o.errorCodes.rpc.internal,(0,c.getErrorMessage)(e.data.cause),(0,c.getErrorStack)(e.data.cause)),!1]}if((0,u.isJsonRpcError)(e)){const{code:t,message:n,stack:s,data:a}=e;return[b(t,n,s,a),!1]}return[b(o.errorCodes.rpc.internal,(0,c.getErrorMessage)(e),(0,c.getErrorStack)(e)),!1]}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/errors.cjs"}],[2840,{"../time.cjs":2866,"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetHistoricalPriceResponseStruct=n.AssetHistoricalPriceStruct=n.HistoricalPriceStruct=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("../time.cjs");n.HistoricalPriceStruct=(0,s.nonEmptyRecord)((0,a.union)([(0,a.literal)("all"),r.ISO8601DurationStruct]),(0,a.array)((0,a.tuple)([(0,a.number)(),(0,a.string)()]))),n.AssetHistoricalPriceStruct=(0,a.nullable)((0,a.object)({intervals:n.HistoricalPriceStruct,updateTime:(0,a.number)(),expirationTime:(0,a.optional)((0,a.number)())})),n.OnAssetHistoricalPriceResponseStruct=(0,a.object)({historicalPrice:n.AssetHistoricalPriceStruct})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/asset-historical-price.cjs"}],[2841,{"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetsConversionResponseStruct=n.AssetConversionStruct=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils");n.AssetConversionStruct=(0,s.object)({rate:(0,s.string)(),conversionTime:(0,s.number)(),expirationTime:(0,s.optional)((0,s.number)())}),n.OnAssetsConversionResponseStruct=(0,s.object)({conversionRates:(0,s.record)(a.CaipAssetTypeStruct,(0,s.record)(a.CaipAssetTypeStruct,(0,s.nullable)(n.AssetConversionStruct)))})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/assets-conversion.cjs"}],[2842,{"../time.cjs":2866,"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnAssetsMarketDataResponseStruct=n.AssetMarketDataStruct=n.NonFungibleAssetMarketDataStruct=n.AssetValueStruct=n.FungibleAssetMarketDataStruct=n.PricePercentChangeStruct=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("../time.cjs");n.PricePercentChangeStruct=(0,s.nonEmptyRecord)((0,a.union)([(0,a.literal)("all"),i.ISO8601DurationStruct]),(0,a.number)()),n.FungibleAssetMarketDataStruct=(0,a.object)({fungible:(0,a.literal)(!0),marketCap:(0,a.optional)((0,a.string)()),totalVolume:(0,a.optional)((0,a.string)()),circulatingSupply:(0,a.optional)((0,a.string)()),allTimeHigh:(0,a.optional)((0,a.string)()),allTimeLow:(0,a.optional)((0,a.string)()),pricePercentChange:(0,a.optional)(n.PricePercentChangeStruct)}),n.AssetValueStruct=(0,a.object)({asset:r.CaipAssetTypeOrIdStruct,amount:(0,a.string)()}),n.NonFungibleAssetMarketDataStruct=(0,a.object)({fungible:(0,a.literal)(!1),lastSale:(0,a.optional)(n.AssetValueStruct),topBid:(0,a.optional)(n.AssetValueStruct),floorPrice:(0,a.optional)(n.AssetValueStruct),rarity:(0,a.optional)((0,a.object)({ranking:(0,a.optional)((0,a.object)({source:(0,a.string)(),rank:(0,a.number)()})),metadata:(0,a.optional)((0,a.record)((0,a.string)(),(0,a.number)()))}))}),n.AssetMarketDataStruct=(0,s.selectiveUnion)((e=>(0,r.isObject)(e)&&e.fungible?n.FungibleAssetMarketDataStruct:n.NonFungibleAssetMarketDataStruct)),n.OnAssetsMarketDataResponseStruct=(0,a.object)({marketData:(0,a.record)(r.CaipAssetTypeOrIdStruct,(0,a.record)(r.CaipAssetTypeStruct,(0,a.nullable)(n.AssetMarketDataStruct)))})}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/assets-market-data.cjs"}],[2843,{"./types.cjs":2850},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SNAP_EXPORT_NAMES=n.SNAP_EXPORTS=void 0;const s=e("./types.cjs");n.SNAP_EXPORTS={[s.HandlerType.OnRpcRequest]:{type:s.HandlerType.OnRpcRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnTransaction]:{type:s.HandlerType.OnTransaction,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnCronjob]:{type:s.HandlerType.OnCronjob,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnNameLookup]:{type:s.HandlerType.OnNameLookup,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnInstall]:{type:s.HandlerType.OnInstall,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnUpdate]:{type:s.HandlerType.OnUpdate,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnStart]:{type:s.HandlerType.OnStart,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnKeyringRequest]:{type:s.HandlerType.OnKeyringRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnHomePage]:{type:s.HandlerType.OnHomePage,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnSettingsPage]:{type:s.HandlerType.OnSettingsPage,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnSignature]:{type:s.HandlerType.OnSignature,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnUserInput]:{type:s.HandlerType.OnUserInput,required:!1,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetHistoricalPrice]:{type:s.HandlerType.OnAssetHistoricalPrice,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetsLookup]:{type:s.HandlerType.OnAssetsLookup,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetsConversion]:{type:s.HandlerType.OnAssetsConversion,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnAssetsMarketData]:{type:s.HandlerType.OnAssetsMarketData,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnProtocolRequest]:{type:s.HandlerType.OnProtocolRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnClientRequest]:{type:s.HandlerType.OnClientRequest,required:!0,validator:e=>"function"==typeof e},[s.HandlerType.OnWebSocketEvent]:{type:s.HandlerType.OnWebSocketEvent,required:!0,validator:e=>"function"==typeof e}},n.SNAP_EXPORT_NAMES=Object.values(s.HandlerType)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/exports.cjs"}],[2844,{"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnHomePageResponseStruct=n.OnHomePageResponseWithIdStruct=n.OnHomePageResponseWithContentStruct=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct");n.OnHomePageResponseWithContentStruct=(0,a.object)({content:s.ComponentOrElementStruct}),n.OnHomePageResponseWithIdStruct=(0,a.object)({id:(0,a.string)()}),n.OnHomePageResponseStruct=(0,a.union)([n.OnHomePageResponseWithContentStruct,n.OnHomePageResponseWithIdStruct])}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/home-page.cjs"}],[2845,{"./asset-historical-price.cjs":2840,"./assets-conversion.cjs":2841,"./assets-market-data.cjs":2842,"./exports.cjs":2843,"./home-page.cjs":2844,"./name-lookup.cjs":2846,"./settings-page.cjs":2847,"./signature.cjs":2848,"./transaction.cjs":2849,"./types.cjs":2850},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./asset-historical-price.cjs"),n),a(e("./assets-conversion.cjs"),n),a(e("./assets-market-data.cjs"),n),a(e("./exports.cjs"),n),a(e("./home-page.cjs"),n),a(e("./name-lookup.cjs"),n),a(e("./settings-page.cjs"),n),a(e("./signature.cjs"),n),a(e("./transaction.cjs"),n),a(e("./types.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/index.cjs"}],[2846,{"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnNameLookupResponseStruct=n.DomainResolutionResponseStruct=n.AddressResolutionResponseStruct=n.DomainResolutionStruct=n.AddressResolutionStruct=void 0;const s=e("@metamask/superstruct");n.AddressResolutionStruct=(0,s.object)({protocol:(0,s.string)(),resolvedDomain:(0,s.string)()}),n.DomainResolutionStruct=(0,s.object)({protocol:(0,s.string)(),resolvedAddress:(0,s.string)(),domainName:(0,s.string)()}),n.AddressResolutionResponseStruct=(0,s.object)({resolvedDomains:(0,s.size)((0,s.array)(n.AddressResolutionStruct),1,Infinity)}),n.DomainResolutionResponseStruct=(0,s.object)({resolvedAddresses:(0,s.size)((0,s.array)(n.DomainResolutionStruct),1,Infinity)}),n.OnNameLookupResponseStruct=(0,s.nullable)((0,s.union)([n.AddressResolutionResponseStruct,n.DomainResolutionResponseStruct]))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/name-lookup.cjs"}],[2847,{"./home-page.cjs":2844},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnSettingsPageResponseStruct=void 0;const s=e("./home-page.cjs");n.OnSettingsPageResponseStruct=s.OnHomePageResponseStruct}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/settings-page.cjs"}],[2848,{"./transaction.cjs":2849},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnSignatureResponseStruct=void 0;const s=e("./transaction.cjs");n.OnSignatureResponseStruct=s.OnTransactionResponseStruct}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/signature.cjs"}],[2849,{"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnTransactionResponseStruct=n.OnTransactionResponseWithContentStruct=n.OnTransactionResponseWithIdStruct=n.OnTransactionSeverityResponseStruct=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct");n.OnTransactionSeverityResponseStruct=(0,a.object)({severity:(0,a.optional)((0,a.literal)(s.SeverityLevel.Critical))}),n.OnTransactionResponseWithIdStruct=(0,a.assign)(n.OnTransactionSeverityResponseStruct,(0,a.object)({id:(0,a.string)()})),n.OnTransactionResponseWithContentStruct=(0,a.assign)(n.OnTransactionSeverityResponseStruct,(0,a.object)({content:s.ComponentOrElementStruct})),n.OnTransactionResponseStruct=(0,a.nullable)((0,a.union)([n.OnTransactionResponseWithContentStruct,n.OnTransactionResponseWithIdStruct]))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/transaction.cjs"}],[2850,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.HandlerType=void 0,function(e){e.OnRpcRequest="onRpcRequest",e.OnSignature="onSignature",e.OnTransaction="onTransaction",e.OnCronjob="onCronjob",e.OnInstall="onInstall",e.OnUpdate="onUpdate",e.OnStart="onStart",e.OnNameLookup="onNameLookup",e.OnKeyringRequest="onKeyringRequest",e.OnHomePage="onHomePage",e.OnSettingsPage="onSettingsPage",e.OnUserInput="onUserInput",e.OnAssetsLookup="onAssetsLookup",e.OnAssetsConversion="onAssetsConversion",e.OnAssetHistoricalPrice="onAssetHistoricalPrice",e.OnAssetsMarketData="onAssetsMarketData",e.OnProtocolRequest="onProtocolRequest",e.OnClientRequest="onClientRequest",e.OnWebSocketEvent="onWebSocketEvent"}(s||(n.HandlerType=s={}))}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/handlers/types.cjs"}],[2851,{"./svg.cjs":2865,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSvgDimensions=n.assertIsSnapIcon=n.SVG_MAX_BYTE_SIZE_TEXT=n.SVG_MAX_BYTE_SIZE=void 0;const s=e("@metamask/utils"),a=e("./svg.cjs");n.SVG_MAX_BYTE_SIZE=1e5,n.SVG_MAX_BYTE_SIZE_TEXT=`${Math.floor(n.SVG_MAX_BYTE_SIZE/1e3)}kb`,n.assertIsSnapIcon=function(e){(0,s.assert)(e.path.endsWith(".svg"),'Expected snap icon to end in ".svg".');const t="string"==typeof e.value?(0,s.stringToBytes)(e.value).byteLength:e.value.byteLength;(0,s.assert)(t<=n.SVG_MAX_BYTE_SIZE,`The specified SVG icon exceeds the maximum size of ${n.SVG_MAX_BYTE_SIZE_TEXT}.`),(0,s.assert)((0,a.isSvg)(e.toString()),"Snap icon must be a valid SVG.")},n.getSvgDimensions=function(e){try{const t=(0,a.parseSvg)(e),n=t["@_height"],r=t["@_width"];if(n&&r)return{height:n,width:r};const i=t["@_viewBox"];if(i){const[e,t,n,a]=i.split(" ");if(n&&a){const e=parseInt(n,10),t=parseInt(a,10);return(0,s.assert)(Number.isInteger(e)&&e>0),(0,s.assert)(Number.isInteger(t)&&t>0),{width:e,height:t}}}}catch{throw new Error("Snap icon must be a valid SVG.")}return null}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/icon.cjs"}],[2852,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createWindow=void 0,n.createWindow=async function({uri:e,id:t,sandbox:n=!0,testId:s="snaps-iframe"}){return await new Promise(((a,r)=>{const i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("data-testid",s),n&&i.setAttribute("sandbox","allow-scripts"),i.setAttribute("src",e),document.body.appendChild(i),i.addEventListener("load",(()=>{i.contentWindow?a(i.contentWindow):r(new Error(`iframe.contentWindow not present on load for job "${t}".`))}))}))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/iframe.cjs"}],[2853,{"./account.cjs":2825,"./array.cjs":2826,"./auxiliary-files.cjs":2827,"./base64.cjs":2828,"./bytes.cjs":2829,"./caveats.cjs":2830,"./checksum.cjs":2831,"./constants.cjs":2832,"./cronjob.cjs":2833,"./currency.cjs":2834,"./deep-clone.cjs":2835,"./default-endowments.cjs":2836,"./derivation-paths.cjs":2837,"./entropy.cjs":2838,"./errors.cjs":2839,"./handlers/index.cjs":2845,"./iframe.cjs":2852,"./json-rpc.cjs":2854,"./json.cjs":2855,"./localization.cjs":2856,"./logging.cjs":2857,"./manifest/index.cjs":2858,"./path.cjs":2860,"./platform-version.cjs":2861,"./snaps.cjs":2862,"./strings.cjs":2863,"./structs.cjs":2864,"./time.cjs":2866,"./types.cjs":2867,"./ui.cjs":2868,"./url.cjs":2869,"./validation.cjs":2870,"./versions.cjs":2871,"./virtual-file/index.cjs":2873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./account.cjs"),n),a(e("./array.cjs"),n),a(e("./auxiliary-files.cjs"),n),a(e("./base64.cjs"),n),a(e("./bytes.cjs"),n),a(e("./caveats.cjs"),n),a(e("./checksum.cjs"),n),a(e("./constants.cjs"),n),a(e("./cronjob.cjs"),n),a(e("./currency.cjs"),n),a(e("./deep-clone.cjs"),n),a(e("./default-endowments.cjs"),n),a(e("./derivation-paths.cjs"),n),a(e("./entropy.cjs"),n),a(e("./errors.cjs"),n),a(e("./handlers/index.cjs"),n),a(e("./iframe.cjs"),n),a(e("./json.cjs"),n),a(e("./json-rpc.cjs"),n),a(e("./localization.cjs"),n),a(e("./logging.cjs"),n),a(e("./manifest/index.cjs"),n),a(e("./path.cjs"),n),a(e("./platform-version.cjs"),n),a(e("./snaps.cjs"),n),a(e("./strings.cjs"),n),a(e("./structs.cjs"),n),a(e("./time.cjs"),n),a(e("./types.cjs"),n),a(e("./ui.cjs"),n),a(e("./url.cjs"),n),a(e("./validation.cjs"),n),a(e("./versions.cjs"),n),a(e("./virtual-file/index.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/index.cjs"}],[2854,{"@metamask/permission-controller":2385,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertIsJsonRpcSuccess=n.isOriginAllowed=n.assertIsKeyringOrigins=n.KeyringOriginsStruct=n.assertIsRpcOrigins=n.RpcOriginsStruct=void 0;const s=e("@metamask/permission-controller"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=(0,a.array)((0,a.refine)((0,a.string)(),"Allowed origin",(e=>!(e.split("*").length-1>2)||'No more than two wildcards ("*") are allowed in an origin specifier.')));function o(e,t){if("*"===e||e===t)return!0;const n=function(e){const t=e.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*");return RegExp(`^${t}$`,"u")}(e);return n.test(t)}n.RpcOriginsStruct=(0,a.refine)((0,a.object)({dapps:(0,a.optional)((0,a.boolean)()),snaps:(0,a.optional)((0,a.boolean)()),allowedOrigins:(0,a.optional)(i)}),"RPC origins",(e=>!!Boolean(!0===e.snaps||!0===e.dapps||e.allowedOrigins&&e.allowedOrigins.length>0)||"Must specify at least one JSON-RPC origin.")),n.assertIsRpcOrigins=function(e,t){(0,r.assertStruct)(e,n.RpcOriginsStruct,"Invalid JSON-RPC origins",t)},n.KeyringOriginsStruct=(0,a.object)({allowedOrigins:(0,a.optional)(i)}),n.assertIsKeyringOrigins=function(e,t){(0,r.assertStruct)(e,n.KeyringOriginsStruct,"Invalid keyring origins",t)},n.isOriginAllowed=function(e,t,n){var a;return"metamask"===n||(!(null===(a=e.allowedOrigins)||void 0===a||!a.some((e=>o(e,n))))||(!(t!==s.SubjectType.Website||!e.dapps)||Boolean(t===s.SubjectType.Snap&&e.snaps)))},n.assertIsJsonRpcSuccess=function(e){if(!(0,r.isJsonRpcSuccess)(e)){if((0,r.isJsonRpcFailure)(e))throw new Error(`JSON-RPC request failed: ${e.error.message}`);throw new Error("Invalid JSON-RPC response.")}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/json-rpc.cjs"}],[2855,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getJsonSizeUnsafe=n.parseJson=void 0;const s=e("@metamask/utils");n.parseJson=function(e){return(0,s.getSafeJson)(JSON.parse(e))},n.getJsonSizeUnsafe=function(e){return JSON.stringify(e).length}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/json.cjs"}],[2856,{"./json.cjs":2855,"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSnapManifestLocalizations=n.getLocalizedSnapManifest=n.translate=n.TRANSLATION_REGEX=n.getLocalizationFile=n.getValidatedLocalizationFiles=n.LocalizationFileStruct=n.LOCALIZABLE_FIELDS=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("./json.cjs");function i(e,t){const n=t.find((t=>t.locale===e));return n||t.find((e=>"en"===e.locale))}function o(e,t){const s=e.matchAll(n.TRANSLATION_REGEX);return Array.from(s).reduce(((n,[s,a])=>{if(!t)throw new Error(`Failed to translate "${e}": No localization file found.`);const r=t.messages[a.trim()];if(!r)throw new Error(`Failed to translate "${e}": No translation found for "${a.trim()}" in "${t.locale}" file.`);return n.replace(s,r.message)}),e)}function c(e,t,s){const a=i(t,s);return n.LOCALIZABLE_FIELDS.reduce(((e,t)=>{const n=o(e[t],a);return{...e,[t]:n}}),e)}n.LOCALIZABLE_FIELDS=["description","proposedName"],n.LocalizationFileStruct=(0,a.object)({locale:(0,a.string)(),messages:(0,a.record)((0,a.string)(),(0,a.object)({message:(0,a.string)(),description:(0,a.optional)((0,a.string)())}))}),n.getValidatedLocalizationFiles=function(e){for(const t of e)try{t.result=(0,a.create)((0,r.parseJson)(t.toString()),n.LocalizationFileStruct)}catch(e){if(e instanceof a.StructError)throw new Error(`Failed to validate localization file "${t.path}": ${e.message}.`);if(e instanceof SyntaxError)throw new Error(`Failed to parse localization file "${t.path}" as JSON.`);throw e}return e},n.getLocalizationFile=i,n.TRANSLATION_REGEX=/\{\{\s?([a-zA-Z0-9-_\s]+)\s?\}\}/gu,n.translate=o,n.getLocalizedSnapManifest=c,n.validateSnapManifestLocalizations=function(e,t){try{t.filter((e=>"en"!==e.locale)).forEach((n=>{c(e,n.locale,t)})),c(e,"en",t)}catch(e){throw new Error(`Failed to localize Snap manifest: ${(0,s.getErrorMessage)(e)}`)}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/localization.cjs"}],[2857,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.logWarning=n.logError=n.logInfo=n.snapsLogger=void 0;const s=e("@metamask/utils");n.snapsLogger=(0,s.createProjectLogger)("snaps"),n.logInfo=function(e,...t){console.log(e,...t)},n.logError=function(e,...t){console.error(e,...t)},n.logWarning=function(e,...t){console.warn(e,...t)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/logging.cjs"}],[2858,{"./validation.cjs":2859},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./validation.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/manifest/index.cjs"}],[2859,{"../array.cjs":2826,"../cronjob.cjs":2833,"../entropy.cjs":2838,"../json-rpc.cjs":2854,"../snaps.cjs":2862,"../structs.cjs":2864,"../types.cjs":2867,"@metamask/key-tree":2051,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSnapManifest=n.assertIsSnapManifest=n.isSnapManifest=n.SnapManifestStruct=n.InitialConnectionsStruct=n.SnapAuxilaryFilesStruct=n.PermissionsStruct=n.EmptyObjectStruct=n.HandlerCaveatsStruct=n.ProtocolScopesStruct=n.MaxRequestTimeStruct=n.MAXIMUM_REQUEST_TIMEOUT=n.MINIMUM_REQUEST_TIMEOUT=n.LookupMatchersStruct=n.ChainIdsStruct=n.SnapIdsStruct=n.SemVerRangeStruct=n.SnapGetBip32EntropyPermissionsStruct=n.Bip32EntropyStruct=n.CurveStruct=n.bip32entropy=n.Bip32PathStruct=n.FORBIDDEN_COIN_TYPES=void 0;const s=e("@metamask/key-tree"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("../array.cjs"),o=e("../cronjob.cjs"),c=e("../entropy.cjs"),u=e("../json-rpc.cjs"),l=e("../snaps.cjs"),d=e("../structs.cjs"),p=e("../types.cjs"),m=[c.SIP_6_MAGIC_VALUE,c.STATE_ENCRYPTION_MAGIC_VALUE];n.FORBIDDEN_COIN_TYPES=[60];const h=n.FORBIDDEN_COIN_TYPES.map((e=>["m","44'",`${e}'`]));n.Bip32PathStruct=(0,a.refine)((0,a.array)((0,a.string)()),"BIP-32 path",(e=>0===e.length?"Path must be a non-empty BIP-32 derivation path array":"m"!==e[0]?'Path must start with "m".':e.length<3?"Paths must have a length of at least three.":e.slice(1).some((e=>!(0,s.isValidBIP32PathSegment)(e)))?"Path must be a valid BIP-32 derivation path array.":m.includes(e[1])?`The purpose "${e[1]}" is not allowed for entropy derivation.`:!h.some((t=>(0,i.isEqual)(e.slice(0,t.length),t)))||`The path "${e.join("/")}" is not allowed for entropy derivation.`));n.bip32entropy=e=>(0,a.refine)(e,"BIP-32 entropy",(e=>"ed25519"!==e.curve||!e.path.slice(1).some((e=>!e.endsWith("'")))||"Ed25519 does not support unhardened paths.")),n.CurveStruct=(0,a.enums)(["ed25519","secp256k1","ed25519Bip32"]),n.Bip32EntropyStruct=(0,n.bip32entropy)((0,a.type)({path:n.Bip32PathStruct,curve:n.CurveStruct})),n.SnapGetBip32EntropyPermissionsStruct=(0,a.size)((0,a.array)(n.Bip32EntropyStruct),1,Infinity),n.SemVerRangeStruct=(0,a.refine)((0,a.string)(),"SemVer range",(e=>!!(0,r.isValidSemVerRange)(e)||"Expected a valid SemVer range.")),n.SnapIdsStruct=(0,a.refine)((0,a.record)(l.SnapIdStruct,(0,a.object)({version:(0,a.optional)(n.SemVerRangeStruct)})),"SnapIds",(e=>0!==Object.keys(e).length)),n.ChainIdsStruct=(0,a.size)((0,a.array)(r.CaipChainIdStruct),1,Infinity),n.LookupMatchersStruct=(0,a.union)([(0,a.object)({tlds:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity)}),(0,a.object)({schemes:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity)}),(0,a.object)({tlds:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity),schemes:(0,a.size)((0,a.array)((0,a.string)()),1,Infinity)})]),n.MINIMUM_REQUEST_TIMEOUT=(0,r.inMilliseconds)(5,r.Duration.Second),n.MAXIMUM_REQUEST_TIMEOUT=(0,r.inMilliseconds)(3,r.Duration.Minute),n.MaxRequestTimeStruct=(0,a.size)((0,a.integer)(),n.MINIMUM_REQUEST_TIMEOUT,n.MAXIMUM_REQUEST_TIMEOUT),n.ProtocolScopesStruct=(0,a.record)(r.CaipChainIdStruct,(0,a.object)({methods:(0,a.array)((0,a.string)())})),n.HandlerCaveatsStruct=(0,a.object)({maxRequestTime:(0,a.optional)(n.MaxRequestTimeStruct)}),n.EmptyObjectStruct=(0,a.object)({}),n.PermissionsStruct=(0,a.type)({"endowment:assets":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,a.object)({scopes:n.ChainIdsStruct}))),"endowment:cronjob":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,a.object)({jobs:(0,a.optional)(o.CronjobSpecificationArrayStruct)}))),"endowment:ethereum-provider":(0,a.optional)(n.EmptyObjectStruct),"endowment:keyring":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,u.KeyringOriginsStruct)),"endowment:protocol":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,a.object)({scopes:n.ProtocolScopesStruct}))),"endowment:lifecycle-hooks":(0,a.optional)(n.HandlerCaveatsStruct),"endowment:name-lookup":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,a.object)({chains:(0,a.optional)(n.ChainIdsStruct),matchers:(0,a.optional)(n.LookupMatchersStruct)}))),"endowment:network-access":(0,a.optional)(n.EmptyObjectStruct),"endowment:page-home":(0,a.optional)(n.HandlerCaveatsStruct),"endowment:rpc":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,u.RpcOriginsStruct)),"endowment:signature-insight":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,a.object)({allowSignatureOrigin:(0,a.optional)((0,a.boolean)())}))),"endowment:transaction-insight":(0,a.optional)((0,d.mergeStructs)(n.HandlerCaveatsStruct,(0,a.object)({allowTransactionOrigin:(0,a.optional)((0,a.boolean)())}))),"endowment:webassembly":(0,a.optional)(n.EmptyObjectStruct),snap_dialog:(0,a.optional)(n.EmptyObjectStruct),snap_manageState:(0,a.optional)(n.EmptyObjectStruct),snap_manageAccounts:(0,a.optional)(n.EmptyObjectStruct),snap_notify:(0,a.optional)(n.EmptyObjectStruct),snap_getBip32Entropy:(0,a.optional)(n.SnapGetBip32EntropyPermissionsStruct),snap_getBip32PublicKey:(0,a.optional)(n.SnapGetBip32EntropyPermissionsStruct),snap_getBip44Entropy:(0,a.optional)((0,a.size)((0,a.array)((0,a.object)({coinType:(0,a.size)((0,a.integer)(),0,2**32-1)})),1,Infinity)),snap_getEntropy:(0,a.optional)(n.EmptyObjectStruct),snap_getLocale:(0,a.optional)(n.EmptyObjectStruct),wallet_snap:(0,a.optional)(n.SnapIdsStruct)}),n.SnapAuxilaryFilesStruct=(0,a.array)((0,a.string)()),n.InitialConnectionsStruct=(0,a.record)((0,a.intersection)([(0,a.string)(),(0,p.uri)()]),(0,a.object)({})),n.SnapManifestStruct=(0,a.object)({version:r.VersionStruct,description:(0,a.size)((0,a.string)(),1,280),proposedName:(0,a.size)((0,a.string)(),1,214),repository:(0,a.optional)((0,a.type)({type:(0,a.size)((0,a.string)(),1,Infinity),url:(0,a.size)((0,a.string)(),1,Infinity)})),source:(0,a.object)({shasum:r.ChecksumStruct,location:(0,a.object)({npm:(0,a.object)({filePath:(0,a.size)((0,a.string)(),1,Infinity),iconPath:(0,a.optional)((0,a.size)((0,a.string)(),1,Infinity)),packageName:p.NameStruct,registry:(0,a.union)([(0,a.literal)("https://registry.npmjs.org"),(0,a.literal)("https://registry.npmjs.org/")])})}),files:(0,a.optional)(n.SnapAuxilaryFilesStruct),locales:(0,a.optional)(n.SnapAuxilaryFilesStruct)}),initialConnections:(0,a.optional)(n.InitialConnectionsStruct),initialPermissions:n.PermissionsStruct,manifestVersion:(0,a.literal)("0.1"),platformVersion:(0,a.optional)(r.VersionStruct),$schema:(0,a.optional)((0,a.string)())}),n.isSnapManifest=function(e){return(0,a.is)(e,n.SnapManifestStruct)},n.assertIsSnapManifest=function(e){(0,r.assertStruct)(e,n.SnapManifestStruct,`"${p.NpmSnapFileNames.Manifest}" is invalid`)},n.createSnapManifest=function(e){return(0,a.create)(e,n.SnapManifestStruct)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/manifest/validation.cjs"}],[2860,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeRelative=void 0;const s=e("@metamask/utils");n.normalizeRelative=function(e){return(0,s.assert)(!e.startsWith("/")),(0,s.assert)(-1===e.search(/:|\/\//u),`Path "${e}" potentially an URI instead of local relative`),e.startsWith("./")?e.slice(2):e}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/path.cjs"}],[2861,{"@metamask/snaps-sdk/package.json":2824},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getPlatformVersion=void 0;const a=s(e("@metamask/snaps-sdk/package.json"));n.getPlatformVersion=function(){return a.default.version}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/platform-version.cjs"}],[2862,{"./caveats.cjs":2830,"./checksum.cjs":2831,"./types.cjs":2867,"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875,"@metamask/utils":2974,"@scure/base":3051,"fast-json-stable-stringify":4490,"validate-npm-package-name":5757},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.verifyRequestedSnapPermissions=n.isSnapPermitted=n.assertIsValidSnapId=n.isSnapId=n.stripSnapPrefix=n.getSnapPrefix=n.SnapIdStruct=n.SnapIdPrefixStruct=n.HttpSnapIdStruct=n.NpmSnapIdStruct=n.LocalSnapIdStruct=n.BaseSnapIdStruct=n.LOCALHOST_HOSTNAMES=n.validateSnapShasum=n.getSnapChecksum=n.SnapStatusEvents=n.SnapStatus=n.PROPOSED_NAME_REGEX=void 0;const a=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),i=e("@metamask/utils"),o=e("@scure/base"),c=s(e("fast-json-stable-stringify")),u=s(e("validate-npm-package-name")),l=e("./caveats.cjs"),d=e("./checksum.cjs"),p=e("./types.cjs");var m,h;function f(e){const t=e.clone();return delete t.result.source.shasum,t.value=(0,c.default)(t.result),t}async function g(e){const{manifest:t,sourceCode:n,svgIcon:s,auxiliaryFiles:a,localizationFiles:r}=e,i=[f(t),n,s,...a,...r].filter((e=>e!==undefined));return o.base64.encode(await(0,d.checksumFiles)(i))}n.PROPOSED_NAME_REGEX=/^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*\/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$/u,function(e){e.Installing="installing",e.Updating="updating",e.Running="running",e.Stopped="stopped",e.Crashed="crashed"}(m||(n.SnapStatus=m={})),function(e){e.Start="START",e.Stop="STOP",e.Crash="CRASH",e.Update="UPDATE"}(h||(n.SnapStatusEvents=h={})),n.getSnapChecksum=g,n.validateSnapShasum=async function(e,t="Invalid Snap manifest: manifest shasum does not match computed shasum."){if(e.manifest.result.source.shasum!==await g(e))throw new Error(t)},n.LOCALHOST_HOSTNAMES=["localhost","127.0.0.1","[::1]"],n.BaseSnapIdStruct=(0,i.definePattern)("Base Snap Id",/^[\x21-\x7E]*$/u);const b=(0,p.uri)({protocol:(0,r.enums)(["http:","https:"]),hostname:(0,r.enums)(n.LOCALHOST_HOSTNAMES),hash:(0,r.empty)((0,r.string)()),search:(0,r.empty)((0,r.string)())});function y(e){const t=Object.values(p.SnapIdPrefixes).find((t=>e.startsWith(t)));if(t!==undefined)return t;throw new Error(`Invalid or no prefix found for "${e}"`)}n.LocalSnapIdStruct=(0,r.refine)(n.BaseSnapIdStruct,"local Snap Id",(e=>{if(!e.startsWith(p.SnapIdPrefixes.local))return`Expected local snap ID, got "${e}".`;const[t]=(0,r.validate)(e.slice(p.SnapIdPrefixes.local.length),b);return t??!0})),n.NpmSnapIdStruct=(0,r.intersection)([n.BaseSnapIdStruct,(0,p.uri)({protocol:(0,r.literal)(p.SnapIdPrefixes.npm),pathname:(0,r.refine)((0,r.string)(),"package name",(function*(e){const t=e.startsWith("/")?e.slice(1):e,{errors:n,validForNewPackages:s,warnings:a}=(0,u.default)(t);return s||(n===undefined?((0,i.assert)(a!==undefined),yield*a):yield*n),!0})),search:(0,r.empty)((0,r.string)()),hash:(0,r.empty)((0,r.string)())})]),n.HttpSnapIdStruct=(0,r.intersection)([n.BaseSnapIdStruct,(0,p.uri)({protocol:(0,r.enums)(["http:","https:"]),search:(0,r.empty)((0,r.string)()),hash:(0,r.empty)((0,r.string)())})]),n.SnapIdPrefixStruct=(0,r.refine)((0,r.string)(),"Snap ID prefix",(e=>{if(Object.values(p.SnapIdPrefixes).some((t=>e.startsWith(t))))return!0;return`Invalid or no prefix found. Expected Snap ID to start with one of: ${Object.values(p.SnapIdPrefixes).map((e=>`"${e}"`)).join(", ")}, but received: "${e}"`})),n.SnapIdStruct=(0,a.selectiveUnion)((e=>"string"==typeof e&&e.startsWith(p.SnapIdPrefixes.npm)?n.NpmSnapIdStruct:"string"==typeof e&&e.startsWith(p.SnapIdPrefixes.local)?n.LocalSnapIdStruct:n.SnapIdPrefixStruct)),n.getSnapPrefix=y,n.stripSnapPrefix=function(e){return e.replace(y(e),"")},n.isSnapId=function(e){return(0,r.is)(e,n.SnapIdStruct)},n.assertIsValidSnapId=function(e){(0,i.assertStruct)(e,n.SnapIdStruct,"Invalid snap ID")},n.isSnapPermitted=function(e,t){var n,s;return Boolean(null===(n=((null==e||null===(s=e.wallet_snap)||void 0===s||null===(s=s.caveats)||void 0===s?void 0:s.find((e=>e.type===l.SnapCaveatType.SnapIds)))??{}).value)||void 0===n?void 0:n[t])},n.verifyRequestedSnapPermissions=function(e){(0,i.assert)((0,i.isObject)(e),"Requested permissions must be an object.");const{wallet_snap:t}=e;(0,i.assert)((0,i.isObject)(t),"wallet_snap is missing from the requested permissions.");const{caveats:n}=t;(0,i.assert)(Array.isArray(n)&&1===n.length,"wallet_snap must have a caveat property with a single-item array value.");const[s]=n;(0,i.assert)((0,i.isObject)(s)&&s.type===l.SnapCaveatType.SnapIds&&(0,i.isObject)(s.value),`The requested permissions do not have a valid ${l.SnapCaveatType.SnapIds} caveat.`)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/snaps.cjs"}],[2863,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.indent=void 0,n.indent=function(e,t=2){return e.replace(/^/gmu," ".repeat(t))}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/strings.cjs"}],[2864,{"./strings.cjs":2863,"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875,"@metamask/utils":2974,chalk:4128},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mergeStructs=n.createUnion=n.validateUnion=n.getStructErrorMessage=n.getStructFailureMessage=n.getStructErrorPrefix=n.getUnionStructNames=n.getStructFromPath=n.createFromStruct=n.getError=n.arrayToGenerator=n.SnapsStructError=n.named=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("chalk"),o=e("./strings.cjs");function c(e,t,n){return n?t(e):e}n.named=function(e,t){return new a.Struct({...t,type:e})};class u extends a.StructError{constructor(e,t,n,s,a,r=!0){super(s,a),this.name="SnapsStructError",this.message=`${t}.\n\n${g(e,[...a()],r)}${n?`\n\n${n}`:""}`}}function*l(e){for(const t of e)yield t}function d({struct:e,prefix:t,suffix:n="",error:s,colorize:a}){return new u(e,t,n,s,(()=>l(s.failures())),a)}function p(e,t){return t.reduce(((t,n)=>(0,r.isObject)(e.schema)&&e.schema[n]?e.schema[n]:t),e)}function m(e,t=!0){return Array.isArray(e.schema)?e.schema.map((({type:e})=>c(e,i.green,t))):null}function h(e,t=!0){return"never"===e.type||0===e.path.length?"":`At path: ${c(e.path.join("."),i.bold,t)}  `}function f(e,t,n=!0){const s=c(JSON.stringify(t.value),i.red,n),a=h(t,n);if("union"===t.type){const r=m(p(e,t.path),n);return r?`${a}Expected the value to be one of: ${r.join(", ")}, but received: ${s}.`:`${a}${t.message}.`}if("literal"===t.type){return`${a}${t.message.replace(/the literal `(.+)`,/u,`the value to be \`${c("$1",i.green,n)}\`,`).replace(/, but received: (.+)/u,`, but received: ${c("$1",i.red,n)}`)}.`}if("never"===t.type)return`Unknown key: ${c(t.path.join("."),i.bold,n)}, received: ${s}.`;if("size"===t.refinement){return`${a}${t.message.replace(/length between `(\d+)` and `(\d+)`/u,`length between ${c("$1",i.green,n)} and ${c("$2",i.green,n)},`).replace(/length of `(\d+)`/u,`length of ${c("$1",i.red,n)}`).replace(/a array/u,"an array")}.`}return t.refinement!==undefined?`${a}${t.message}.`:`${a}Expected a value of type ${c(t.type,i.green,n)}, but received: ${s}.`}function g(e,t,n=!0){return t.map((t=>(0,o.indent)(` ${f(e,t,n)}`))).join("\n")}function b(e,t,n,i=!1){(0,r.assert)(t.schema,"Expected a struct with a schema. Make sure to use `union` from `@metamask/snaps-sdk`."),(0,r.assert)(t.schema.length>0,"Expected a non-empty array of structs.");const o=t.schema.map((e=>e.schema[n])),c=(0,a.type)({[n]:(0,s.union)(o)}),[u]=(0,a.validate)(e,c,{coerce:i});if(u)throw new Error(f(c,u.failures()[0],!1));const l=e,d=t.schema.filter((e=>(0,a.is)(l[n],e.schema[n])));(0,r.assert)(d.length>0,"Expected a struct to match the value.");const p=d.map((e=>(0,a.validate)(l,e,{coerce:i}))),m=p.find((([e])=>!e));if(m)return m[1];(0,r.assert)(p[0][0],"Expected at least one error.");const h=p.reduce(((e,[t])=>((0,r.assert)(t,"Expected an error."),t.failures().length<e.failures().length?t:e)),p[0][0]);throw new Error(f(t,h.failures()[0],!1))}n.SnapsStructError=u,n.arrayToGenerator=l,n.getError=d,n.createFromStruct=function(e,t,n,s=""){try{return(0,a.create)(e,t)}catch(e){if(e instanceof a.StructError)throw d({struct:t,prefix:n,suffix:s,error:e});throw e}},n.getStructFromPath=p,n.getUnionStructNames=m,n.getStructErrorPrefix=h,n.getStructFailureMessage=f,n.getStructErrorMessage=g,n.validateUnion=b,n.createUnion=function(e,t,n){return b(e,t,n,!0)},n.mergeStructs=function(...e){const t=a.assign(...e);return new a.Struct({...t,*refiner(t,n){for(const s of e)yield*s.refiner(t,n)}})}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/structs.cjs"}],[2865,{"@metamask/utils":2974,"fast-xml-parser":4492},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSvg=n.parseSvg=void 0;const s=e("@metamask/utils"),a=e("fast-xml-parser");function r(e){try{const t=e.trim();(0,s.assert)(t.length>0);const n=new a.XMLParser({ignoreAttributes:!1,parseAttributeValue:!0}).parse(t,!0);return(0,s.assert)((0,s.hasProperty)(n,"svg")),(0,s.isObject)(n.svg)?n.svg:{}}catch{throw new Error("Snap icon must be a valid SVG.")}}n.parseSvg=r,n.isSvg=function(e){try{return r(e),!0}catch{return!1}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/svg.cjs"}],[2866,{"@metamask/superstruct":2875,luxon:4922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toCensoredISO8601String=n.ISO8601DateStruct=n.ISO8601DurationStruct=void 0;const s=e("@metamask/superstruct"),a=e("luxon");n.ISO8601DurationStruct=(0,s.refine)((0,s.string)(),"ISO 8601 duration",(e=>!!a.Duration.fromISO(e).isValid||"Not a valid ISO 8601 duration"));const r=/Z|([+-]\d{2}:?\d{2})$/u;n.ISO8601DateStruct=(0,s.refine)((0,s.string)(),"ISO 8601 date",(e=>a.DateTime.fromISO(e).isValid?!!r.test(e)||"ISO 8601 date must have timezone information":"Not a valid ISO 8601 date")),n.toCensoredISO8601String=function(e){return a.DateTime.fromISO(e,{setZone:!0}).startOf("second").toISO({suppressMilliseconds:!0})}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/time.cjs"}],[2867,{"@metamask/snaps-sdk":2739,"@metamask/superstruct":2875,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WALLET_SNAP_PERMISSION_KEY=n.isValidUrl=n.uri=n.SNAP_STREAM_NAMES=n.SnapIdPrefixes=n.NpmSnapPackageJsonStruct=n.NameStruct=n.NpmSnapFileNames=void 0;const s=e("@metamask/snaps-sdk"),a=e("@metamask/superstruct"),r=e("@metamask/utils");var i,o,c;!function(e){e.PackageJson="package.json",e.Manifest="snap.manifest.json"}(i||(n.NpmSnapFileNames=i={})),n.NameStruct=(0,a.size)((0,r.definePattern)("Snap Name",/^(?:@[a-z0-9-*~][a-z0-9-*._~]*\/)?[a-z0-9-~][a-z0-9-._~]*$/u),1,214),n.NpmSnapPackageJsonStruct=(0,a.type)({version:r.VersionStruct,name:n.NameStruct,main:(0,a.optional)((0,a.size)((0,a.string)(),1,Infinity)),repository:(0,a.optional)((0,a.type)({type:(0,a.size)((0,a.string)(),1,Infinity),url:(0,a.size)((0,a.string)(),1,Infinity)}))}),function(e){e.npm="npm:",e.local="local:"}(o||(n.SnapIdPrefixes=o={})),function(e){e.JSON_RPC="jsonRpc",e.COMMAND="command"}(c||(n.SNAP_STREAM_NAMES=c={}));n.uri=(e={})=>(0,a.refine)((0,a.string)(),"uri",(t=>{try{const n=new URL(t),s=(0,a.type)(e);return(0,a.assert)(n,s),!0}catch(e){return e instanceof a.StructError?(0,s.getErrorMessage)(e):`Expected URL, got "${t.toString()}"`}})),n.isValidUrl=function(e,t={}){return(0,a.is)(e,(0,n.uri)(t))},n.WALLET_SNAP_PERMISSION_KEY="wallet_snap"}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/types.cjs"}],[2868,{"./url.cjs":2869,"@metamask/snaps-sdk":2739,"@metamask/snaps-sdk/jsx":2823,"@metamask/snaps-sdk/jsx-runtime":2822,"@metamask/utils":2974,marked:4923},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.serialiseJsx=n.walkJsx=n.getJsxChildren=n.hasChildren=n.getTotalTextLength=n.validateJsxElements=n.validateAssetSelector=n.validateTextLinks=n.validateLink=n.getJsxElementFromComponent=n.getTextChildren=void 0;const s=e("@metamask/snaps-sdk/jsx-runtime"),a=e("@metamask/snaps-sdk"),r=e("@metamask/snaps-sdk/jsx"),i=e("@metamask/utils"),o=e("marked"),c=e("./url.cjs"),u=5e4,l=["https:","mailto:","metamask:"];function d(e){switch(e){case"primary":return"primary";case"secondary":return"destructive";default:return undefined}}function p(e){return 1===e.length?e[0]:e}function m(e){return e.tokens&&e.tokens.length>0?p(e.tokens.flatMap(f)):e.href}function h(e){return p(e.flatMap(f))}function f(e){switch(e.type){case"link":return(0,s.jsx)(r.Link,{href:e.href,children:m(e)});case"text":return e.text;case"strong":return(0,s.jsx)(r.Bold,{children:h(e.tokens)});case"em":return(0,s.jsx)(r.Italic,{children:h(e.tokens)});default:return null}}function g(e){const t=(0,o.lexer)(e,{gfm:!1}),n=[];return(0,o.walkTokens)(t,(e=>{if("paragraph"===e.type){n.length>0&&n.push("\n\n");const{tokens:t}=e;n.push(...t.flatMap(f))}})),n.filter((e=>null!==e))}function b(e,t,n){try{const s=new URL(e);if((0,i.assert)(l.includes(s.protocol),`Protocol must be one of: ${l.join(", ")}.`),"metamask:"===s.protocol){const t=(0,c.parseMetaMaskUrl)(e);t.snapId&&(0,i.assert)(n(t.snapId),"The Snap being navigated to is not installed.")}else if("mailto:"===s.protocol){const e=s.pathname.split(",");for(const n of e){const e=n.split("@")[1];(0,i.assert)(!e.includes(":"));const s=`https://${e}`;(0,i.assert)(!t(s),"The specified URL is not allowed.")}return}(0,i.assert)(!t(s.href),"The specified URL is not allowed.")}catch(e){throw new Error(`Invalid URL: ${"ERR_ASSERTION"===(null==e?void 0:e.code)?e.message:"Unable to parse URL."}`)}}function y(e,t){const n=t(e);(0,i.assert)(n,`Could not find account for address: ${e}`)}function S(e){const{type:t}=e;switch(t){case a.NodeType.Panel:return e.children.reduce(((e,t)=>e+S(t)),0);case a.NodeType.Row:return S(e.value);case a.NodeType.Text:return e.value.length;default:return 0}}function k(e){return(0,i.hasProperty)(e.props,"children")}function T(e){return Boolean(e)&&!0!==e}function w(e){if(k(e)){if(Array.isArray(e.props.children))return e.props.children.filter(T).flat(Infinity);if(e.props.children)return[e.props.children]}return[]}function v(e,t,n=0){if(Array.isArray(e)){for(const s of e){const e=v(s,t,n);if(e!==undefined)return e}return undefined}const s=t(e,n);if(s!==undefined)return s;if((0,i.hasProperty)(e,"props")&&(0,i.isPlainObject)(e.props)&&(0,i.hasProperty)(e.props,"children")){const s=w(e);for(const e of s)if((0,i.isPlainObject)(e)){const s=v(e,t,n+1);if(s!==undefined)return s}}return undefined}function E(e){return Object.entries(e).filter((([e])=>"children"!==e)).sort((([e],[t])=>e.localeCompare(t))).map((([e,t])=>{return` ${e}=${n=t,"string"==typeof n?`"${n}"`:`{${JSON.stringify(n)}}`}`;var n})).join("")}n.getTextChildren=g,n.getJsxElementFromComponent=function(e){return function(e){const t=S(e);(0,i.assert)(t<=u,`The text in a Snap UI may not be larger than ${u/1e3} kB.`)}(e),function e(t){switch(t.type){case a.NodeType.Address:return(0,s.jsx)(r.Address,{address:t.value});case a.NodeType.Button:return(0,s.jsx)(r.Button,{name:t.name,variant:d(t.variant),type:t.buttonType,children:t.value});case a.NodeType.Copyable:return(0,s.jsx)(r.Copyable,{value:t.value,sensitive:t.sensitive});case a.NodeType.Divider:return(0,s.jsx)(r.Divider,{});case a.NodeType.Form:return(0,s.jsx)(r.Form,{name:t.name,children:p(t.children.map(e))});case a.NodeType.Heading:return(0,s.jsx)(r.Heading,{children:t.value});case a.NodeType.Image:return(0,s.jsx)(r.Image,{src:t.value});case a.NodeType.Input:return(0,s.jsx)(r.Field,{label:t.label,error:t.error,children:(0,s.jsx)(r.Input,{name:t.name,type:t.inputType,value:t.value,placeholder:t.placeholder})});case a.NodeType.Panel:return(0,s.jsx)(r.Box,{children:p(t.children.map(e))});case a.NodeType.Row:return(0,s.jsx)(r.Row,{label:t.label,variant:t.variant,children:e(t.value)});case a.NodeType.Spinner:return(0,s.jsx)(r.Spinner,{});case a.NodeType.Text:return(0,s.jsx)(r.Text,{children:p(g(t.value))});default:return(0,i.assertExhaustive)(t)}}(e)},n.validateLink=b,n.validateTextLinks=function(e,t,n){const s=function(e){const t=(0,o.lexer)(e,{gfm:!1}),n=[];return(0,o.walkTokens)(t,(e=>{"link"===e.type&&n.push(e)})),n}(e);for(const e of s)b(e.href,t,n)},n.validateAssetSelector=y,n.validateJsxElements=function(e,{isOnPhishingList:t,getSnap:n,getAccountByAddress:s}){v(e,(e=>{switch(e.type){case"Link":b(e.props.href,t,n);break;case"AssetSelector":y(e.props.addresses[0],s)}}))},n.getTotalTextLength=S,n.hasChildren=k,n.getJsxChildren=w,n.walkJsx=v,n.serialiseJsx=function e(t,n=0){if(Array.isArray(t))return t.map((t=>e(t,n))).join("");const s="  ".repeat(n);if("string"==typeof t)return`${s}${t}\n`;if(!t)return"";const{type:a,props:r}=t,o=n>0?"\n":"";if((0,i.hasProperty)(r,"children")){const t=e(r.children,n+1);return`${s}<${a}${E(r)}>\n${t}${s}</${a}>${o}`}return`${s}<${a}${E(r)} />${o}`}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/ui.cjs"}],[2869,{"./snaps.cjs":2862,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseMetaMaskUrl=n.SNAP_PATHS=n.CLIENT_PATHS=void 0;const s=e("@metamask/utils"),a=e("./snaps.cjs");n.CLIENT_PATHS=["/"],n.SNAP_PATHS=["/home"],n.parseMetaMaskUrl=function(e){const t=new URL(e),{protocol:r}=t;if("metamask:"!==r)throw new Error(`Unable to parse URL. Expected the protocol to be "metamask:", but received "${r}".`);const[i,...o]=t.href.replace("metamask://","").split("/"),c=`/${o.join("/")}`;switch(i){case"client":return(0,s.assert)(n.CLIENT_PATHS.includes(c),`Unable to navigate to "${c}". The provided path is not allowed.`),{authority:i,path:c};case"snap":return function(e){const t="Invalid MetaMask url:",r=(0,a.stripSnapPrefix)(e.slice(1)),i=e.slice(1).startsWith("npm:")?"npm:":"local:",o=r.startsWith("@"),c=r.split("/"),u=`/${c[c.length-1]}`;let l;if("local:"===i){const[e,,...a]=c.slice(0,-1);l=`${e}//${a.join("/")}`,(0,s.assert)(n.SNAP_PATHS.includes(u),`${t} invalid snap path.`)}else l=o?`${c[0]}/${c[1]}`:c[0],(0,s.assert)(o?3===c.length&&n.SNAP_PATHS.includes(u):2===c.length&&n.SNAP_PATHS.includes(u),`${t} invalid snap path.`);const d=`${i}${l}`;return(0,a.assertIsValidSnapId)(d),{authority:"snap",snapId:d,path:u}}(c);default:throw new Error(`Expected "metamask:" URL to start with "client" or "snap", but received "${i}".`)}}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/url.cjs"}],[2870,{"./icon.cjs":2851,"./localization.cjs":2856,"./manifest/validation.cjs":2859,"./snaps.cjs":2862},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateFetchedSnap=void 0;const s=e("./icon.cjs"),a=e("./localization.cjs"),r=e("./manifest/validation.cjs"),i=e("./snaps.cjs");n.validateFetchedSnap=async function(e){(0,r.assertIsSnapManifest)(e.manifest.result),await(0,i.validateSnapShasum)(e),(0,a.validateSnapManifestLocalizations)(e.manifest.result,e.localizationFiles.map((e=>e.result))),e.svgIcon&&(0,s.assertIsSnapIcon)(e.svgIcon)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/validation.cjs"}],[2871,{"@metamask/superstruct":2875,"@metamask/utils":2974,semver:5627},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resolveVersionRange=n.getTargetVersion=n.DEFAULT_REQUESTED_SNAP_VERSION=void 0;const s=e("@metamask/superstruct"),a=e("@metamask/utils"),r=e("semver");n.DEFAULT_REQUESTED_SNAP_VERSION="*",n.getTargetVersion=function(e,t){const n=(0,r.maxSatisfying)(e,t);return n||(0,r.maxSatisfying)(e,t,{includePrerelease:!0})},n.resolveVersionRange=function(e){return e===undefined||"latest"===e?[undefined,n.DEFAULT_REQUESTED_SNAP_VERSION]:(0,s.validate)(e,a.VersionRangeStruct)}}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/versions.cjs"}],[2872,{"../deep-clone.cjs":2835,"@metamask/utils":2974,"@scure/base":3051},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.VirtualFile=void 0;const a=e("@metamask/utils"),r=e("@scure/base"),i=e("../deep-clone.cjs");class o{constructor(e){var t,n,a,r;let i;s(this,"value",void 0),s(this,"result",void 0),s(this,"data",void 0),s(this,"path",void 0),i="string"==typeof e||e instanceof Uint8Array?{value:e}:e,this.value=(null===(t=i)||void 0===t?void 0:t.value)??"",this.result=(null===(n=i)||void 0===n?void 0:n.result)??undefined,this.data=(null===(a=i)||void 0===a?void 0:a.data)??{},this.path=(null===(r=i)||void 0===r?void 0:r.path)??"/"}get size(){return"string"==typeof this.value?this.value.length:this.value.byteLength}toString(e){if("string"==typeof this.value)return(0,a.assert)(e===undefined,"Tried to encode string."),this.value;if(this.value instanceof Uint8Array&&"hex"===e)return(0,a.bytesToHex)(this.value);if(this.value instanceof Uint8Array&&"base64"===e)return r.base64.encode(this.value);return new TextDecoder(e).decode(this.value)}clone(){const e=new o;return"string"==typeof this.value?e.value=this.value:e.value=this.value.slice(0),e.result=(0,i.deepClone)(this.result),e.data=(0,i.deepClone)(this.data),e.path=this.path,e}}n.VirtualFile=o}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/virtual-file/VirtualFile.cjs"}],[2873,{"./VirtualFile.cjs":2872},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]},a=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./VirtualFile.cjs"),n)}}},{package:"@metamask/snaps-utils",file:"node_modules/@metamask/snaps-utils/dist/virtual-file/index.cjs"}],[2874,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.StructError=void 0;class s extends TypeError{constructor(e,t){let n;const{message:s,explanation:a,...r}=e,{path:i}=e,o=0===i.length?s:`At path: ${i.join(".")} -- ${s}`;super(a??o),null!==a&&a!==undefined&&(this.cause=o),Object.assign(this,r),this.name=this.constructor.name,this.failures=()=>n??(n=[e,...t()])}}n.StructError=s}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/error.cjs"}],[2875,{"./error.cjs":2874,"./struct.cjs":2876,"./structs/coercions.cjs":2877,"./structs/refinements.cjs":2878,"./structs/types.cjs":2879,"./structs/utilities.cjs":2880},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./error.cjs"),n),a(e("./struct.cjs"),n),a(e("./structs/coercions.cjs"),n),a(e("./structs/refinements.cjs"),n),a(e("./structs/types.cjs"),n),a(e("./structs/utilities.cjs"),n)}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/index.cjs"}],[2876,{"./error.cjs":2874,"./utils.cjs":2881},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validate=n.is=n.mask=n.create=n.assert=n.ExactOptionalStruct=n.Struct=void 0;const s=e("./error.cjs"),a=e("./utils.cjs");class r{constructor(e){const{type:t,schema:n,validator:s,refiner:r,coercer:i=(e=>e),entries:o=function*(){}}=e;this.type=t,this.schema=n,this.entries=o,this.coercer=i,this.validator=s?(e,t)=>{const n=s(e,t);return(0,a.toFailures)(n,t,this,e)}:()=>[],this.refiner=r?(e,t)=>{const n=r(e,t);return(0,a.toFailures)(n,t,this,e)}:()=>[]}assert(e,t){return o(e,this,t)}create(e,t){return c(e,this,t)}is(e){return l(e,this)}mask(e,t){return u(e,this,t)}validate(e,t={}){return d(e,this,t)}}n.Struct=r;const i="EXACT_OPTIONAL";function o(e,t,n){const s=d(e,t,{message:n});if(s[0])throw s[0]}function c(e,t,n){const s=d(e,t,{coerce:!0,message:n});if(s[0])throw s[0];return s[1]}function u(e,t,n){const s=d(e,t,{coerce:!0,mask:!0,message:n});if(s[0])throw s[0];return s[1]}function l(e,t){return!d(e,t)[0]}function d(e,t,n={}){const r=(0,a.run)(e,t,n),i=(0,a.shiftIterator)(r);if(i[0]){return[new s.StructError(i[0],(function*(){for(const e of r)e[0]&&(yield e[0])})),undefined]}const o=i[1];return[undefined,o]}n.ExactOptionalStruct=class extends r{constructor(e){super({...e,type:`exact optional ${e.type}`}),this.brand=i}static isExactOptional(e){return(0,a.isObject)(e)&&"brand"in e&&e.brand===i}},n.assert=o,n.create=c,n.mask=u,n.is=l,n.validate=d}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/struct.cjs"}],[2877,{"../struct.cjs":2876,"../utils.cjs":2881,"./types.cjs":2879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.trimmed=n.defaulted=n.coerce=void 0;const s=e("../struct.cjs"),a=e("../utils.cjs"),r=e("./types.cjs");function i(e,t,n){return new s.Struct({...e,coercer:(a,r)=>(0,s.is)(a,t)?e.coercer(n(a,r),r):e.coercer(a,r)})}n.coerce=i,n.defaulted=function(e,t,n={}){return i(e,(0,r.unknown)(),(e=>{const s="function"==typeof t?t():t;if(e===undefined)return s;if(!n.strict&&(0,a.isPlainObject)(e)&&(0,a.isPlainObject)(s)){const t={...e};let n=!1;for(const e in s)t[e]===undefined&&(t[e]=s[e],n=!0);if(n)return t}return e}))},n.trimmed=function(e){return i(e,(0,r.string)(),(e=>e.trim()))}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/coercions.cjs"}],[2878,{"../struct.cjs":2876,"../utils.cjs":2881},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.refine=n.size=n.pattern=n.nonempty=n.min=n.max=n.empty=void 0;const s=e("../struct.cjs"),a=e("../utils.cjs");function r(e){return e instanceof Map||e instanceof Set?e.size:e.length}function i(e,t,n){return new s.Struct({...e,*refiner(s,r){yield*e.refiner(s,r);const i=n(s,r),o=(0,a.toFailures)(i,r,e,s);for(const e of o)yield{...e,refinement:t}}})}n.empty=function(e){return i(e,"empty",(t=>{const n=r(t);return 0===n||`Expected an empty ${e.type} but received one with a size of \`${n}\``}))},n.max=function(e,t,n={}){const{exclusive:s}=n;return i(e,"max",(n=>s?n<t:n<=t||`Expected a ${e.type} less than ${s?"":"or equal to "}${t} but received \`${n}\``))},n.min=function(e,t,n={}){const{exclusive:s}=n;return i(e,"min",(n=>s?n>t:n>=t||`Expected a ${e.type} greater than ${s?"":"or equal to "}${t} but received \`${n}\``))},n.nonempty=function(e){return i(e,"nonempty",(t=>r(t)>0||`Expected a nonempty ${e.type} but received an empty one`))},n.pattern=function(e,t){return i(e,"pattern",(n=>t.test(n)||`Expected a ${e.type} matching \`/${t.source}/\` but received "${n}"`))},n.size=function(e,t,n=t){const s=`Expected a ${e.type}`,a=t===n?`of \`${t}\``:`between \`${t}\` and \`${n}\``;return i(e,"size",(e=>{if("number"==typeof e||e instanceof Date)return t<=e&&e<=n||`${s} ${a} but received \`${e}\``;if(e instanceof Map||e instanceof Set){const{size:r}=e;return t<=r&&r<=n||`${s} with a size ${a} but received one with a size of \`${r}\``}const{length:r}=e;return t<=r&&r<=n||`${s} with a length ${a} but received one with a length of \`${r}\``}))},n.refine=i}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/refinements.cjs"}],[2879,{"../struct.cjs":2876,"../utils.cjs":2881,"./utilities.cjs":2880},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unknown=n.union=n.type=n.tuple=n.string=n.set=n.regexp=n.record=n.exactOptional=n.optional=n.object=n.number=n.nullable=n.never=n.map=n.literal=n.intersection=n.integer=n.instance=n.func=n.enums=n.date=n.boolean=n.bigint=n.array=n.any=void 0;const s=e("../struct.cjs"),a=e("../utils.cjs"),r=e("./utilities.cjs");function i(){return(0,r.define)("never",(()=>!1))}n.any=function(){return(0,r.define)("any",(()=>!0))},n.array=function(e){return new s.Struct({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[n,s]of t.entries())yield[n,s,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${(0,a.print)(e)}`})},n.bigint=function(){return(0,r.define)("bigint",(e=>"bigint"==typeof e))},n.boolean=function(){return(0,r.define)("boolean",(e=>"boolean"==typeof e))},n.date=function(){return(0,r.define)("date",(e=>e instanceof Date&&!isNaN(e.getTime())||`Expected a valid \`Date\` object, but received: ${(0,a.print)(e)}`))},n.enums=function(e){const t={},n=e.map((e=>(0,a.print)(e))).join();for(const n of e)t[n]=n;return new s.Struct({type:"enums",schema:t,validator:t=>e.includes(t)||`Expected one of \`${n}\`, but received: ${(0,a.print)(t)}`})},n.func=function(){return(0,r.define)("func",(e=>"function"==typeof e||`Expected a function, but received: ${(0,a.print)(e)}`))},n.instance=function(e){return(0,r.define)("instance",(t=>t instanceof e||`Expected a \`${e.name}\` instance, but received: ${(0,a.print)(t)}`))},n.integer=function(){return(0,r.define)("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${(0,a.print)(e)}`))},n.intersection=function(e){return new s.Struct({type:"intersection",schema:null,*entries(t,n){for(const{entries:s}of e)yield*s(t,n)},*validator(t,n){for(const{validator:s}of e)yield*s(t,n)},*refiner(t,n){for(const{refiner:s}of e)yield*s(t,n)}})},n.literal=function(e){const t=(0,a.print)(e),n=typeof e;return new s.Struct({type:"literal",schema:"string"===n||"number"===n||"boolean"===n?e:null,validator:n=>n===e||`Expected the literal \`${t}\`, but received: ${(0,a.print)(n)}`})},n.map=function(e,t){return new s.Struct({type:"map",schema:null,*entries(n){if(e&&t&&n instanceof Map)for(const[s,a]of n.entries())yield[s,s,e],yield[s,a,t]},coercer:e=>e instanceof Map?new Map(e):e,validator:e=>e instanceof Map||`Expected a \`Map\` object, but received: ${(0,a.print)(e)}`})},n.never=i,n.nullable=function(e){return new s.Struct({...e,validator:(t,n)=>null===t||e.validator(t,n),refiner:(t,n)=>null===t||e.refiner(t,n)})},n.number=function(){return(0,r.define)("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${(0,a.print)(e)}`))},n.object=function(e){const t=e?Object.keys(e):[],n=i();return new s.Struct({type:"object",schema:e??null,*entries(r){if(e&&(0,a.isObject)(r)){const a=new Set(Object.keys(r));for(const n of t){a.delete(n);const t=e[n];s.ExactOptionalStruct.isExactOptional(t)&&!Object.prototype.hasOwnProperty.call(r,n)||(yield[n,r[n],e[n]])}for(const e of a)yield[e,r[e],n]}},validator:e=>(0,a.isObject)(e)||`Expected an object, but received: ${(0,a.print)(e)}`,coercer:e=>(0,a.isObject)(e)?{...e}:e})},n.optional=function(e){return new s.Struct({...e,validator:(t,n)=>t===undefined||e.validator(t,n),refiner:(t,n)=>t===undefined||e.refiner(t,n)})},n.exactOptional=function(e){return new s.ExactOptionalStruct(e)},n.record=function(e,t){return new s.Struct({type:"record",schema:null,*entries(n){if((0,a.isObject)(n))for(const s in n){const a=n[s];yield[s,s,e],yield[s,a,t]}},validator:e=>(0,a.isObject)(e)||`Expected an object, but received: ${(0,a.print)(e)}`})},n.regexp=function(){return(0,r.define)("regexp",(e=>e instanceof RegExp))},n.set=function(e){return new s.Struct({type:"set",schema:null,*entries(t){if(e&&t instanceof Set)for(const n of t)yield[n,n,e]},coercer:e=>e instanceof Set?new Set(e):e,validator:e=>e instanceof Set||`Expected a \`Set\` object, but received: ${(0,a.print)(e)}`})},n.string=function(){return(0,r.define)("string",(e=>"string"==typeof e||`Expected a string, but received: ${(0,a.print)(e)}`))},n.tuple=function(e){const t=i();return new s.Struct({type:"tuple",schema:null,*entries(n){if(Array.isArray(n)){const s=Math.max(e.length,n.length);for(let a=0;a<s;a++)yield[a,n[a],e[a]||t]}},validator:e=>Array.isArray(e)||`Expected an array, but received: ${(0,a.print)(e)}`})},n.type=function(e){const t=Object.keys(e);return new s.Struct({type:"type",schema:e,*entries(n){if((0,a.isObject)(n))for(const s of t)yield[s,n[s],e[s]]},validator:e=>(0,a.isObject)(e)||`Expected an object, but received: ${(0,a.print)(e)}`,coercer:e=>(0,a.isObject)(e)?{...e}:e})},n.union=function(e){const t=e.map((e=>e.type)).join(" | ");return new s.Struct({type:"union",schema:null,coercer(t){for(const n of e){const[e,s]=n.validate(t,{coerce:!0});if(!e)return s}return t},validator(n,s){const r=[];for(const t of e){const[...e]=(0,a.run)(n,t,s),[i]=e;if(!i?.[0])return[];for(const[t]of e)t&&r.push(t)}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${(0,a.print)(n)}`,...r]}})},n.unknown=function(){return(0,r.define)("unknown",(()=>!0))}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/types.cjs"}],[2880,{"../struct.cjs":2876,"./types.cjs":2879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.pick=n.partial=n.omit=n.lazy=n.dynamic=n.deprecated=n.define=n.assign=void 0;const s=e("../struct.cjs"),a=e("./types.cjs");n.assign=function(...e){const t="type"===e[0]?.type,n=e.map((({schema:e})=>e)),s=Object.assign({},...n);return t?(0,a.type)(s):(0,a.object)(s)},n.define=function(e,t){return new s.Struct({type:e,schema:null,validator:t})},n.deprecated=function(e,t){return new s.Struct({...e,refiner:(t,n)=>t===undefined||e.refiner(t,n),validator:(n,s)=>n===undefined||(t(n,s),e.validator(n,s))})},n.dynamic=function(e){return new s.Struct({type:"dynamic",schema:null,*entries(t,n){const s=e(t,n);yield*s.entries(t,n)},validator:(t,n)=>e(t,n).validator(t,n),coercer:(t,n)=>e(t,n).coercer(t,n),refiner:(t,n)=>e(t,n).refiner(t,n)})},n.lazy=function(e){let t;return new s.Struct({type:"lazy",schema:null,*entries(n,s){t??(t=e()),yield*t.entries(n,s)},validator:(n,s)=>(t??(t=e()),t.validator(n,s)),coercer:(n,s)=>(t??(t=e()),t.coercer(n,s)),refiner:(n,s)=>(t??(t=e()),t.refiner(n,s))})},n.omit=function(e,t){const{schema:n}=e,s={...n};for(const e of t)delete s[e];return"type"===e.type?(0,a.type)(s):(0,a.object)(s)},n.partial=function(e){const t=e instanceof s.Struct,n=t?{...e.schema}:{...e};for(const e in n)n[e]=(0,a.optional)(n[e]);return t&&"type"===e.type?(0,a.type)(n):(0,a.object)(n)},n.pick=function(e,t){const{schema:n}=e,s={};for(const e of t)s[e]=n[e];return"type"===e.type?(0,a.type)(s):(0,a.object)(s)}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/structs/utilities.cjs"}],[2881,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function s(e){return"object"==typeof e&&null!==e}function a(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function r(e,t,n,s){if(!0===e)return undefined;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:r,branch:i}=t,{type:o}=n,{refinement:c,message:u=`Expected a value of type \`${o}\`${c?` with refinement \`${c}\``:""}, but received: \`${a(s)}\``}=e;return{value:s,type:o,refinement:c,key:r[r.length-1],path:r,branch:i,...e,message:u}}Object.defineProperty(n,"__esModule",{value:!0}),n.run=n.toFailures=n.toFailure=n.shiftIterator=n.print=n.isPlainObject=n.isObject=void 0,n.isObject=s,n.isPlainObject=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype},n.print=a,n.shiftIterator=function(e){const{done:t,value:n}=e.next();return t?undefined:n},n.toFailure=r,n.toFailures=function*(e,t,n,a){(function(e){return s(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const s of e){const e=r(s,t,n,a);e&&(yield e)}},n.run=function*e(t,n,a={}){const{path:r=[],branch:i=[t],coerce:o=!1,mask:c=!1}=a,u={path:r,branch:i};if(o&&(t=n.coercer(t,u),c&&"type"!==n.type&&s(n.schema)&&s(t)&&!Array.isArray(t)))for(const e in t)n.schema[e]===undefined&&delete t[e];let l="valid";for(const e of n.validator(t,u))e.explanation=a.message,l="not_valid",yield[e,undefined];for(let[d,p,m]of n.entries(t,u)){const n=e(p,m,{path:d===undefined?r:[...r,d],branch:d===undefined?i:[...i,p],coerce:o,mask:c,message:a.message});for(const e of n)e[0]?(l=null===e[0].refinement||e[0].refinement===undefined?"not_valid":"not_refined",yield[e[0],undefined]):o&&(p=e[1],d===undefined?t=p:t instanceof Map?t.set(d,p):t instanceof Set?t.add(p):s(t)&&(p!==undefined||d in t)&&(t[d]=p))}if("not_valid"!==l)for(const e of n.refiner(t,u))e.explanation=a.message,l="not_refined",yield[e,undefined];"valid"===l&&(yield[undefined,t])}}}},{package:"@metamask/superstruct",file:"node_modules/@metamask/superstruct/dist/utils.cjs"}],[2882,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createEventEmitterProxy=void 0;const s=()=>!0,a=["newListener","removeListener"],r=e=>!a.includes(e);n.createEventEmitterProxy=function(e,{eventFilter:t=s}={}){const n="skipInternal"===t?r:t;if("function"!=typeof n)throw new Error("createEventEmitterProxy - Invalid eventFilter");let a=[],i=e,o=e=>{const t=i;i=e,a.forEach((({name:n,handler:s,addedWith:a,filtered:r})=>{r||e[a](n,s),t.off(n,s)}))};const c=(e,t)=>{a=a.filter((n=>e!==n.name||t!==n.handler&&t!==n.unwrappedHandler))};return new Proxy(i,{get(e,t,s){if("setTarget"===t)return o;const r=i[t];return"function"==typeof r?function(...e){const o=e[1];if("once"===t){const t=(...n)=>(c(e[0],t),o(...n));e[1]=t}if("on"===t||"addListener"===t||"prependListener"===t||"once"===t)a.push({addedWith:t,name:e[0],unwrappedHandler:o,handler:e[1],filtered:!n(e[0])});else if("off"===t||"removeListener"===t){const t=a.find((({name:t,unwrappedHandler:n})=>t===e[0]&&n===e[1]));if(t===undefined)return i;c(e[0],e[1]),e[1]=t.handler}return r.apply(this===s?i:this,e)}:r},set:(e,t,n)=>"setTarget"===t?(o=n,!0):(i[t]=n,!0)})}}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/createEventEmitterProxy.js"}],[2883,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSwappableProxy=void 0,n.createSwappableProxy=function(e){let t=e,n=e=>{t=e};return new Proxy(t,{get(e,s,a){if("setTarget"===s)return n;const r=t[s];return r instanceof Function?function(...e){return r.apply(this===a?t:this,e)}:r},set:(e,s,a)=>"setTarget"===s?(n=a,!0):(t[s]=a,!0)})}}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/createSwappableProxy.js"}],[2884,{"./createEventEmitterProxy":2882,"./createSwappableProxy":2883,"./types":2885},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),a(e("./createEventEmitterProxy"),n),a(e("./createSwappableProxy"),n),a(e("./types"),n)}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/index.js"}],[2885,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/network-controller>@metamask/swappable-obj-proxy",file:"node_modules/@metamask/swappable-obj-proxy/dist/types.js"}],[2887,{"./constants.cjs":2889,"./errors.cjs":2890,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@toruslabs/http-helpers":2901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.authenticateUser=n.createAuthResponseHandler=void 0;const s=e("@metamask/auth-network-utils"),a=e("@toruslabs/http-helpers"),r=e("./constants.cjs"),i=e("./errors.cjs"),o=e("./utils.cjs");n.createAuthResponseHandler=(e,t)=>{let n=null;return async()=>{const a=(0,s.filterCompletedRequests)(e);if(a.length>=r.AUTHENTICATION_THRESHOLD){n??(n=Date.now());const e=Date.now()-n>1e3;if(t||e){const e=a.map((e=>{const{pubKey:t,keyIndex:n}=e.result;return{pubKey:t,keyIndex:n}})),t=(0,s.thresholdSame)(e,r.AUTHENTICATION_THRESHOLD);if(!t)throw i.TOPRFError.invalidAuthenticateResults(`Authentication threshold met, but pubKey/keyIndex data inconsistent: ${JSON.stringify(e)}`);return{authRequestResults:a.map((e=>e.result)),isNewUser:!t.pubKey}}return undefined}if(t)throw i.TOPRFError.invalidAuthenticateResults(`Authentication threshold not met after all requests processed. Expected: ${r.AUTHENTICATION_THRESHOLD}, got: ${a.length}`);return undefined}};n.authenticateUser=async e=>{const{idToken:t,nodeEndpointsMap:c,authConnectionId:u,userId:l,commitmentSignatures:d,groupedAuthConnectionId:p,hashedIdToken:m,sessionPrivateKey:h}=e,f=(e=>{const t=e.groupedAuthConnectionId?{subVerifierAuthParams:[{subVerifierIdToken:e.idToken,subVerifier:e.authConnectionId}]}:undefined;if(e.groupedAuthConnectionId&&!e.hashedIdToken)throw i.TOPRFError.fromCode(i.TOPRFErrorCode.NoHashedIdToken);return{authData:{authenticationContext:{idToken:e.groupedAuthConnectionId&&e.hashedIdToken?e.hashedIdToken:e.idToken,verifier:e.groupedAuthConnectionId??e.authConnectionId,verifierId:e.userId},singleIdVerifierParams:t},commitmentSignatures:e.commitmentSignatures,clientTime:Math.floor(Date.now()/1e3).toString()}})({idToken:t,authConnectionId:u,userId:l,commitmentSignatures:d,groupedAuthConnectionId:p,hashedIdToken:m}),g=Object.values(c).map((async e=>(async(e,t)=>{const n=(0,a.generateJsonRPCObject)(r.JRPC_METHODS.AUTHENTICATE_REQUEST,t);return(0,o.postJRPCRequest)(e,n)})(e,f))),b=await(0,s.Some)(g,(async(e,t)=>(0,n.createAuthResponseHandler)(e,t.allSettled)()));return{authTokensData:await Promise.all(b.authRequestResults.map((async e=>{const{authToken:t,nodeIndex:n,nodePubKey:s,pubKey:a,keyIndex:r}=e;return{authToken:await(0,o.decryptAuthToken)(t,h),nodeIndex:n,nodePubKey:s,pubKey:a,keyIndex:r}}))),isNewUser:b.isNewUser}}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/authenticateRequest.cjs"}],[2888,{"./constants.cjs":2889,"./errors.cjs":2890,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@noble/hashes/utils":3030,"@toruslabs/http-helpers":2901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.commitIdToken=n.createHandleCommitmentResponses=void 0;const s=e("@metamask/auth-network-utils"),a=e("@noble/hashes/utils"),r=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./utils.cjs");n.createHandleCommitmentResponses=(e,t)=>{let n=null;return async()=>{const a=(0,s.filterCompletedRequests)(e);if(a.length>=i.COMMIT_RESPONSE_THRESHOLD){n??(n=Date.now());const e=Date.now()-n>1e3;return t||e?a.map((e=>e.result)):undefined}if(t)throw o.TOPRFError.invalidCommitResults(`Threshold not met after all requests processed. Expected: ${i.COMMIT_RESPONSE_THRESHOLD}, got: ${a.length}`);return undefined}};n.commitIdToken=async e=>{const{idToken:t,endpoints:o,authConnectionId:u,sessionPubKeyX:l,sessionPubKeyY:d}=e,p=((e,t,n,s)=>({tokenCommitment:e,verifier:t,tempPubKeyX:n,tempPubKeyY:s}))((0,s.keccak256AndHexify)((0,a.utf8ToBytes)(t)).slice(2),u,l,d),m=o.map((async e=>(async(e,t)=>{const n=(0,r.generateJsonRPCObject)(i.JRPC_METHODS.COMMITMENT_REQUEST,t);return(0,c.postJRPCRequest)(e,n)})(e,p)));return(0,s.Some)(m,(async(e,t)=>(0,n.createHandleCommitmentResponses)(e,t.allSettled)()))}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/commitRequest.cjs"}],[2889,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.JsonRpcErrorCodes=n.PW_BACKUP_ITEM_ID=n.MAX_PASSWORD_CHAIN_LENGTH=n.FIRST_KEY_INDEX=n.GENERATE_SHARE_THRESHOLD=n.GET_PUB_KEY_THRESHOLD=n.TOPRF_EVAL_THRESHOLD=n.AUTHENTICATION_THRESHOLD=n.COMMIT_RESPONSE_THRESHOLD=n.JRPC_METHODS=void 0,n.JRPC_METHODS={COMMITMENT_REQUEST:"TOPRFCommitmentRequest",AUTHENTICATE_REQUEST:"TOPRFAuthenticateRequest",STORE_KEY_SHARES_REQUEST:"TOPRFStoreKeyShareRequest",RESET_RATE_LIMIT_REQUEST:"TOPRFResetRateLimitRequest",TOPRF_EVAL_REQUEST:"TOPRFEvalRequest",GET_PUB_KEY_REQUEST:"TOPRFGetPubKeyRequest"},n.COMMIT_RESPONSE_THRESHOLD=4,n.AUTHENTICATION_THRESHOLD=4,n.TOPRF_EVAL_THRESHOLD=3,n.GET_PUB_KEY_THRESHOLD=3,n.GENERATE_SHARE_THRESHOLD=3,n.FIRST_KEY_INDEX=1,n.MAX_PASSWORD_CHAIN_LENGTH=10,n.PW_BACKUP_ITEM_ID="PW_BACKUP",function(e){e[e.ErrorCodeInvalidParams=-32602]="ErrorCodeInvalidParams",e[e.ErrorCodeInternal=-32603]="ErrorCodeInternal"}(s||(n.JsonRpcErrorCodes=s={}))}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/constants.cjs"}],[2890,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.TOPRFError=n.TOPRFErrorCode=void 0,function(e){e[e.Default=1e3]="Default",e[e.InvalidAuthenticateResults=1001]="InvalidAuthenticateResults",e[e.InvalidCommitResults=1002]="InvalidCommitResults",e[e.PwdInputRateLimitExceeded=1003]="PwdInputRateLimitExceeded",e[e.InsufficientValidResponses=1004]="InsufficientValidResponses",e[e.CouldNotDeriveThresholdAuthPubKey=1005]="CouldNotDeriveThresholdAuthPubKey",e[e.CouldNotDeriveEncryptionKey=1006]="CouldNotDeriveEncryptionKey",e[e.EndpointNotFound=1007]="EndpointNotFound",e[e.InsufficientAuthTokens=1008]="InsufficientAuthTokens",e[e.RateLimitExceeded=1009]="RateLimitExceeded",e[e.InvalidAuthToken=1010]="InvalidAuthToken",e[e.AuthTokenExpired=1011]="AuthTokenExpired",e[e.JsonRpcError=1012]="JsonRpcError",e[e.CouldNotFetchPassword=1013]="CouldNotFetchPassword",e[e.NoHashedIdToken=1014]="NoHashedIdToken",e[e.MaxKeyChainLengthExceeded=1015]="MaxKeyChainLengthExceeded"}(s||(n.TOPRFErrorCode=s={}));class a extends Error{constructor(e,t,n){super(t),this.code=e,this.meta=n,Object.defineProperty(this,"name",{value:"TOPRFError"})}static fromCode(e,t="",n){const r=t?` ${t}`:"";return a.messages[e]?new a(e,`${a.messages[e]}${r}`,n):new a(1e3,`${a.messages[s.Default]}${r}`,n)}static default(e=""){return new a(s.Default,`${a.messages[s.Default]} ${e}`)}static invalidAuthenticateResults(e=""){return a.fromCode(s.InvalidAuthenticateResults,e)}static invalidCommitResults(e=""){return a.fromCode(s.InvalidCommitResults,e)}static pwdInputRateLimitExceeded(e=""){return a.fromCode(s.PwdInputRateLimitExceeded,e)}static insufficientValidResponses(e=""){return a.fromCode(s.InsufficientValidResponses,e)}static couldNotDeriveThresholdAuthPubKey(e=""){return a.fromCode(s.CouldNotDeriveThresholdAuthPubKey,e)}static couldNotDeriveEncryptionKey(e=""){return a.fromCode(s.CouldNotDeriveEncryptionKey,e)}static endpointNotFound(e=""){return a.fromCode(s.EndpointNotFound,e)}static insufficientAuthTokens(e=""){return a.fromCode(s.InsufficientAuthTokens,e)}static rateLimitExceeded(e,t=""){return a.fromCode(s.RateLimitExceeded,t||e.message,{rateLimitDetails:e})}static invalidAuthToken(e=""){return a.fromCode(s.InvalidAuthToken,e)}static authTokenExpired(e=""){return a.fromCode(s.AuthTokenExpired,e)}static jsonRpcError(e){return a.fromCode(s.JsonRpcError,e)}static couldNotFetchPassword(e=""){return a.fromCode(s.CouldNotFetchPassword,e)}static maxKeyChainLengthExceeded(e=""){return a.fromCode(s.MaxKeyChainLengthExceeded,e)}toJSON(){return{name:this.name,code:this.code,message:this.message,meta:this.meta}}toString(){return JSON.stringify(this.toJSON())}}n.TOPRFError=a,a.messages={[s.Default]:"Something went wrong.",[s.InvalidAuthenticateResults]:"Invalid authenticate results.",[s.InvalidCommitResults]:"Invalid commit results.",[s.PwdInputRateLimitExceeded]:"Rate limit exceeded for password input attempts.",[s.InsufficientValidResponses]:"Insufficient valid responses.",[s.CouldNotDeriveThresholdAuthPubKey]:"Could not derive threshold auth pub key.",[s.CouldNotDeriveEncryptionKey]:"Could not derive encryption key.",[s.EndpointNotFound]:"Endpoint not found.",[s.InsufficientAuthTokens]:"Insufficient number of auth tokens.",[s.RateLimitExceeded]:"Rate limit error from server.",[s.InvalidAuthToken]:"Invalid auth token.",[s.AuthTokenExpired]:"Auth token expired.",[s.JsonRpcError]:"Json rpc error.",[s.CouldNotFetchPassword]:"Could not fetch password.",[s.MaxKeyChainLengthExceeded]:"Exceeded maximum key chain length.",[s.NoHashedIdToken]:"hashedIdToken is required when using single-id(aggregate) verifier."}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/errors.cjs"}],[2891,{"./constants.cjs":2889,"./errors.cjs":2890,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@noble/hashes/utils":3030,"@toruslabs/http-helpers":2901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPubKey=n.validatePubKey=void 0;const s=e("@metamask/auth-network-utils"),a=e("@noble/hashes/utils"),r=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./utils.cjs");n.validatePubKey=async e=>{const t=(0,s.filterCompletedRequests)(e);if(t.length<i.GET_PUB_KEY_THRESHOLD)throw o.TOPRFError.insufficientValidResponses(`Insufficient get pub key request results, expected ${i.GET_PUB_KEY_THRESHOLD} but got ${t.length}`);const n=(0,s.thresholdSame)(t.map((e=>({pubKey:e.result?.pubKey,keyIndex:e.result?.keyIndex}))),i.GET_PUB_KEY_THRESHOLD);if(!n?.pubKey||!n?.keyIndex)throw o.TOPRFError.couldNotDeriveThresholdAuthPubKey();return{authPubKey:(0,a.hexToBytes)(n.pubKey),keyIndex:n.keyIndex}};n.getPubKey=async e=>{const{authTokens:t,nodeEndpointsMap:a,authConnectionId:u,userId:l,groupedAuthConnectionId:d}=e;if(t.length<i.GET_PUB_KEY_THRESHOLD)throw o.TOPRFError.insufficientAuthTokens(`At least ${i.GET_PUB_KEY_THRESHOLD} auth tokens are required.`);const p=(0,c.mergeEndpointsWithAuthTokens)(t,a).map((async({endpoint:e,authToken:t})=>{const n=((e,t,n,s)=>({authToken:e,verifier:s??t,verifierId:n}))(t.authToken,u,l,d);return(async(e,t)=>{const n=(0,r.generateJsonRPCObject)(i.JRPC_METHODS.GET_PUB_KEY_REQUEST,t);return(0,c.postJRPCRequest)(e,n)})(e,n)}));return(0,s.Some)(p,(async e=>(0,n.validatePubKey)(e)))}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/getPubKeyRequest.cjs"}],[2892,{"./errors.cjs":2890,"./toprfSecureBackup.cjs":2899,"./utils.cjs":2900},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,a)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.TOPRFErrorCode=n.TOPRFError=void 0,a(e("./toprfSecureBackup.cjs"),n);var r=e("./errors.cjs");Object.defineProperty(n,"TOPRFError",{enumerable:!0,get:function(){return r.TOPRFError}}),Object.defineProperty(n,"TOPRFErrorCode",{enumerable:!0,get:function(){return r.TOPRFErrorCode}}),a(e("./utils.cjs"),n)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/index.cjs"}],[2893,{"@noble/curves/abstract/utils":3012,"@noble/curves/secp256k1":3015,"@noble/hashes/hkdf":3020,"@noble/hashes/sha2":3026},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.derivePwEncKey=n.deriveEncryptionKey=n.deriveAuthenticationKeyPair=void 0;const s=e("@noble/curves/abstract/utils"),a=e("@noble/curves/secp256k1"),r=e("@noble/hashes/hkdf"),i=e("@noble/hashes/sha2");n.deriveAuthenticationKeyPair=function(e){const t=(0,r.hkdf)(i.sha256,e,undefined,"authentication-key",32),n=(0,s.bytesToNumberBE)(t)%a.secp256k1.CURVE.n;return{sk:n,pk:a.secp256k1.getPublicKey(n,!1)}},n.deriveEncryptionKey=function(e){return(0,r.hkdf)(i.sha256,e,undefined,"encryption-key",32)},n.derivePwEncKey=function(e){return(0,r.hkdf)(i.sha256,e,undefined,"pwd-encryption-key",32)}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/keyDerivation.cjs"}],[2894,{"./constants.cjs":2889,"@metamask/auth-network-utils":1468,"@noble/ciphers/aes":3002,"@noble/ciphers/webcrypto":3005,"@noble/curves/secp256k1":3015,"@noble/hashes/sha3":3028,"@noble/hashes/utils":3030,buffer:4106},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s,a,r,i,o,c,u,l,d,p,m,h,f,g,b,y=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},S=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MetadataStore=n.MetadataStoreError=n.MetadataLockStatus=void 0;const k=e("@metamask/auth-network-utils"),T=e("@noble/ciphers/aes"),w=e("@noble/ciphers/webcrypto"),v=e("@noble/curves/secp256k1"),E=e("@noble/hashes/sha3"),j=e("@noble/hashes/utils"),P=e("./constants.cjs");var I;!function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS"}(I||(n.MetadataLockStatus=I={}));class _ extends Error{constructor(e){super(e),this.name="MetadataStoreError",Object.setPrototypeOf(this,_.prototype)}}n.MetadataStoreError=_;n.MetadataStore=class{constructor(e){s.add(this),a.set(this,"srp-backup"),r.set(this,void 0),i.set(this,void 0),y(this,r,e.metadataEndpoint,"f"),y(this,i,e.fetchMetadataAccessCreds,"f")}async addSecretDataItem(e){try{const{secretData:t,encKey:n,authKeyPair:a}=e;await S(this,s,"m",o).call(this,{secretData:t,encKey:n,authKeyPair:a,metadataEndpoint:S(this,r,"f")})}catch(e){throw new _(`failed to add metadata: ${e.message}`)}}async batchAddSecretData(e){try{const{secretData:t,encKey:n,authKeyPair:a}=e;await S(this,s,"m",c).call(this,{secretData:t,encKey:n,authKeyPair:a,metadataEndpoint:S(this,r,"f")})}catch(e){throw new _(`failed to add batch metadata: ${e.message}`)}}async fetchAllSecretDataItems(e,t,n){try{return await S(this,s,"m",u).call(this,{encKey:e,authKeyPair:t,metadataEndpoint:S(this,r,"f"),itemId:n})}catch(e){throw new _(`failed to fetch metadata: ${e.message}`)}}async acquireMetadataLock(e){const{status:t,id:n}=await S(this,s,"m",l).call(this,S(this,r,"f"),e);if(t!==I.SUCCESS)throw new _("Failed to acquire metadata lock");if(!n)throw new _("Failed to acquire metadata lock. Missing lock id");return n}async releaseMetadataLock(e,t){const n=await S(this,s,"m",d).call(this,S(this,r,"f"),e,t);if(n!==I.SUCCESS)throw new _(`Failed to release metadata lock with id ${t}`);return n}},a=new WeakMap,r=new WeakMap,i=new WeakMap,s=new WeakSet,o=async function(e){try{const t=`${e.metadataEndpoint}/enc_account_data/set`,n=S(this,s,"m",g).call(this,e.secretData.data,e.encKey),a=await S(this,s,"m",p).call(this,{itemId:e.secretData.itemId,data:n},e.authKeyPair),r=JSON.stringify(a),i=await fetch(t,{headers:{"Content-Type":"application/json"},method:"POST",body:r});if(!i.ok){const e=await i.json();throw new Error(`HTTP error message: ${e.error}`)}return(await i.json()).success}catch(e){const t=e.message||"Unknown error";throw new _(`failed to upsert metadata: ${t}`)}},c=async function(e){const t=Array.isArray(e.encKey)?e.encKey:e.secretData.map((()=>e.encKey));if(t.length!==e.secretData.length)throw new _("encKey must be of same length as secretData");try{const n=`${e.metadataEndpoint}/enc_account_data/batch_set`,a=e.secretData.map(((e,n)=>({data:S(this,s,"m",g).call(this,e.data,t[n]),itemId:e.itemId}))),r=await S(this,s,"m",p).call(this,a,e.authKeyPair),i=await fetch(n,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(r)});if(!i.ok){const e=await i.json();throw new Error(`HTTP error message: ${e.error}`)}return(await i.json()).success}catch(e){const t=e.message||"Unknown error";throw new _(`failed to upsert metadata: ${t}`)}},u=async function(e){try{const n=`${e.metadataEndpoint}/enc_account_data/get`,a=await S(this,s,"m",m).call(this,e.authKeyPair,e.itemId),r=await fetch(n,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)});if(!r.ok){const e=await r.json();throw new Error(`HTTP error message: ${e.error}`)}const i=await r.json();if(!i.data)throw new _("Failed to fetch metadata");return i.data.filter(((t,n)=>e.itemId?i.ids[n]===e.itemId:i.ids[n]!==P.PW_BACKUP_ITEM_ID)).map(((n,a)=>{const r=new Uint8Array(t.from(n,"base64"));return{itemId:i.ids[a],data:S(this,s,"m",b).call(this,r,e.encKey)}})).filter((e=>e.data.length>0))}catch(e){const t=e.message||"Unknown error";throw new _(`failed to fetch metadata: ${t}`)}},l=async function(e,t){try{const n=S(this,s,"m",h).call(this,t),a=`${e}/acquireLock`,r=await fetch(a,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(n)});if(!r.ok){const e=await r.json();throw new Error(`HTTP error message: ${e.error}`)}const i=await r.json();return{status:i.status,id:i.id}}catch(e){const t=e.message||"Unknown error";throw new _(`failed to acquire metadata lock: ${t}`)}},d=async function(e,t,n){try{const a=S(this,s,"m",h).call(this,t,n),r=`${e}/releaseLock`,i=await fetch(r,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)});if(!i.ok){const e=await i.json();throw new Error(`HTTP error message: ${e.error}`)}return(await i.json()).status}catch(e){const t=e.message||"Unknown error";throw new _(`failed to release metadata lock: ${t}`)}},p=async function(e,n){const r=Date.now().toString(),o=S(this,a,"f"),{metadataAccessToken:c}=await S(this,i,"f").call(this),u={timestamp:r,feature:o,authToken:c};Array.isArray(e)?u.data=e.map((e=>{const n=e.data;return{data:t.from(n).toString("base64"),itemId:e.itemId}})):(u.data=t.from(e.data).toString("base64"),u.itemId=e.itemId);const{pk:l,sk:d}=n,p=S(this,s,"m",f).call(this,u,d),m=(0,j.bytesToHex)(l);return{...u,signature:p,pubKey:m}},m=async function(e,t){const n=Date.now().toString(),r=S(this,a,"f"),{pk:o,sk:c}=e,{metadataAccessToken:u}=await S(this,i,"f").call(this),l={feature:r,timestamp:n,itemId:t,authToken:u},d=S(this,s,"m",f).call(this,l,c),p=(0,j.bytesToHex)(o);return{...l,pubKey:p,signature:d}},h=function(e,t){const{pk:n,sk:a}=e,r={timestamp:Date.now()};return{data:r,signature:S(this,s,"m",f).call(this,r,a,!0),key:(0,j.bytesToHex)(n),id:t}},f=function(e,t,n=!1){const s=(0,k.safeStringify)(e),a=(0,E.keccak_256)(s),r=v.secp256k1.sign(a,t);return n?r.toDERHex():r.toCompactHex()},g=function(e,t){return(0,w.managedNonce)(T.gcm)(t).encrypt(e)},b=function(e,t){return(0,w.managedNonce)(T.gcm)(t).decrypt(e)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/metadata.cjs"}],[2895,{"@noble/curves/abstract/modular":3010,"@noble/curves/abstract/utils":3012,"@noble/curves/secp256k1":3015},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OPRF=n.generateRandomScalar=void 0;const s=e("@noble/curves/abstract/modular"),a=e("@noble/curves/abstract/utils"),r=e("@noble/curves/secp256k1");function i(){return(0,a.bytesToNumberBE)(r.secp256k1.utils.randomPrivateKey())}n.generateRandomScalar=i;const o=(0,s.Field)(r.secp256k1.CURVE.n);n.OPRF=class{static blind(e){const t=i(),n=(0,r.hashToCurve)(e).multiply(t);return{a:r.secp256k1.ProjectivePoint.fromAffine(n.toAffine()),r:t}}static blindEval(e,t){return t.multiply(e)}static async unblindAndHash(e,t,n,s){const a=o.inv(n),i=t.multiply(a);let c=r.secp256k1.CURVE.hash(new Uint8Array([...e,...i.toRawBytes()]));if(s){const e=c.length;c=await s.deriveKey(c.slice(0,e/2),c.slice(e/2))}return c}static async localEval(e,t,n){const{a:s,r:a}=this.blind(t),r=s.multiply(e);return this.unblindAndHash(t,r,a,n)}}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/oprf.cjs"}],[2896,{"./constants.cjs":2889,"./errors.cjs":2890,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@noble/hashes/sha3":3028,"@toruslabs/http-helpers":2901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resetRateLimits=n.validateThresholdResetRateLimitResponses=n.sendResetRateLimitRequest=void 0;const s=e("@metamask/auth-network-utils"),a=e("@noble/hashes/sha3"),r=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./utils.cjs");n.sendResetRateLimitRequest=async(e,t)=>{const n=(0,r.generateJsonRPCObject)(i.JRPC_METHODS.RESET_RATE_LIMIT_REQUEST,t);return(0,c.postJRPCRequest)(e,n)};n.validateThresholdResetRateLimitResponses=(e,t)=>{const n=(0,s.filterCompletedRequests)(e);if(n.length<t)throw o.TOPRFError.insufficientValidResponses(`invalid reset rate limit results, expected ${t} but got ${n.length}`);return!0};n.resetRateLimits=async e=>{const{authTokens:t,nodeEndpointsMap:r,authConnectionId:i,groupedAuthConnectionId:o,userId:u,authPrivKey:l}=e,d=(0,c.mergeEndpointsWithAuthTokens)(t,r).map((async({endpoint:e,authToken:t})=>{const r=(0,s.toSnakeCaseKeys)({timestamp:Date.now(),nodeIndex:t.nodeIndex,action:"reset_ratelimit"}),d=(0,s.safeStringify)(r,{cmp:c.preserveKeyOrder}),p=(0,a.keccak_256)(d),m=(0,c.createEthereumSignature)(p,l),h=((e,t,n,s,a,r)=>({authToken:e,signature:t,signedData:n,verifier:r??s,verifierId:a}))(t.authToken,m,d,i,u,o);return(0,n.sendResetRateLimitRequest)(e,h)}));return(0,s.Some)(d,(async e=>(0,n.validateThresholdResetRateLimitResponses)(e,t.length)))}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/resetRateLimits.cjs"}],[2897,{"./constants.cjs":2889,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@toruslabs/http-helpers":2901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.changeKeyShares=n.createKeyChangeRequestParams=n.storeKeyShares=n.sendStoreKeySharesRequest=n.createStoreKeySharesRequestParams=void 0;const s=e("@metamask/auth-network-utils"),a=e("@toruslabs/http-helpers"),r=e("./constants.cjs"),i=e("./utils.cjs");n.createStoreKeySharesRequestParams=async e=>{const{nodeEndpointsMap:t,authTokens:n,authConnectionId:a,groupedAuthConnectionId:r,userId:o,keyShareIndex:c,oprfKey:u,authPubKey:l}=e,d=await(0,i.generateShareImportItems)(t,n,u,c);return{verifier:r??a,verifierId:o,pubKey:(0,s.uint8ArrayToHex)(l),shareImportItems:d}};n.sendStoreKeySharesRequest=async(e,t)=>{const n=(0,a.generateJsonRPCObject)(r.JRPC_METHODS.STORE_KEY_SHARES_REQUEST,(0,s.toSnakeCaseKeys)(t));return(0,i.postJRPCRequest)(e,n)};n.storeKeyShares=async e=>{const{authTokens:t,nodeEndpointsMap:a,authConnectionId:r,groupedAuthConnectionId:o,userId:c,keyShareIndex:u,oprfKey:l,authPubKey:d}=e,p=await(0,n.createStoreKeySharesRequestParams)({nodeEndpointsMap:a,authTokens:t,authConnectionId:r,groupedAuthConnectionId:o,userId:c,keyShareIndex:u,oprfKey:l,authPubKey:d}),m=a[(0,s.getProxyCoordinatorNodeIndex)(t.map((e=>e.nodeIndex)),o??r,c)],h=await(0,n.sendStoreKeySharesRequest)(m,p);if((0,s.isJSONRPCError)(h.error)){throw(0,i.parseJsonRpcError)(h.error)}return h};n.createKeyChangeRequestParams=async e=>{const{nodeEndpointsMap:t,authTokens:n,keyShareIndex:a,newOprfKey:r,newAuthPubKey:o,oldAuthPrivKey:c,authConnectionId:u,groupedAuthConnectionId:l,userId:d}=e,p=await(0,i.generateShareImportItems)(t,n,r,a,c);return{pubKey:(0,s.uint8ArrayToHex)(o),shareImportItems:p,verifier:l??u,verifierId:d}};n.changeKeyShares=async e=>{const{nodeEndpointsMap:t,authTokens:a,keyShareIndex:r,newOprfKey:o,newAuthPubKey:c,oldAuthPrivKey:u,authConnectionId:l,groupedAuthConnectionId:d,userId:p}=e,m=await(0,n.createKeyChangeRequestParams)({nodeEndpointsMap:t,authTokens:a,keyShareIndex:r,newOprfKey:o,newAuthPubKey:c,oldAuthPrivKey:u,authConnectionId:l,groupedAuthConnectionId:d,userId:p}),h=t[(0,s.getProxyCoordinatorNodeIndex)(a.map((e=>e.nodeIndex)),l,p)],f=await(0,n.sendStoreKeySharesRequest)(h,m);if((0,s.isJSONRPCError)(f.error)){throw(0,i.parseJsonRpcError)(f.error)}return f}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/storeSharesRequest.cjs"}],[2898,{"./constants.cjs":2889,"./errors.cjs":2890,"./keyDerivation.cjs":2893,"./oprf.cjs":2895,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@noble/curves/secp256k1":3015,"@toruslabs/http-helpers":2901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.recoverTOPRFSeed=n.validateSeed=void 0;const s=e("@metamask/auth-network-utils"),a=e("@noble/curves/secp256k1"),r=e("@toruslabs/http-helpers"),i=e("./constants.cjs"),o=e("./errors.cjs"),c=e("./keyDerivation.cjs"),u=e("./oprf.cjs"),l=e("./utils.cjs");n.validateSeed=async(e,t,n,r)=>{let d=(0,l.checkRateLimitErrors)(n);if(d)throw o.TOPRFError.rateLimitExceeded(d);const p=(0,s.filterCompletedRequests)(n);if(p.length<i.TOPRF_EVAL_THRESHOLD)throw o.TOPRFError.insufficientValidResponses(`Insufficient toprf eval request results, expected ${i.TOPRF_EVAL_THRESHOLD} but got ${p.length}`);const m=(0,s.thresholdSame)(p.map((e=>e.result?.pubKey)),i.TOPRF_EVAL_THRESHOLD);if(!m)throw o.TOPRFError.couldNotDeriveThresholdAuthPubKey();const h=p.reduce(((e,t)=>{const n=t.result;if(!("object"==typeof(s=n)&&null!==s&&"blindedOutputX"in s&&"string"==typeof s.blindedOutputX&&"blindedOutputY"in s&&"string"==typeof s.blindedOutputY&&"nodeIndex"in s&&"number"==typeof s.nodeIndex&&"keyShareIndex"in s&&"number"==typeof s.keyShareIndex&&"pubKey"in s&&"string"==typeof s.pubKey))return e;var s;const{blindedOutputX:r,blindedOutputY:i,nodeIndex:o,keyShareIndex:c}=n;return e.push({blindedOutput:a.secp256k1.ProjectivePoint.fromAffine({x:BigInt(`0x${r}`),y:BigInt(`0x${i}`)}),nodeIndex:o,keyShareIndex:c}),e}),[]);if(h.length<i.TOPRF_EVAL_THRESHOLD)throw o.TOPRFError.insufficientValidResponses(`Insufficient valid blinded outputs, expected: ${i.TOPRF_EVAL_THRESHOLD}, received: ${h.length}`);const f=await(async(e,t,n,r,o)=>{const l=(0,s.kCombinations)(e.length,i.TOPRF_EVAL_THRESHOLD);for(const i of l){const l=e.filter(((e,t)=>i.includes(t))),d=l.map((e=>e.blindedOutput)),p=l.map((e=>BigInt(e.nodeIndex))),m=(0,s.lagrangeInterpolationForPoints)(a.secp256k1.CURVE.n,d,p),h=await u.OPRF.unblindAndHash(t,m,n,o),{pk:f}=(0,c.deriveAuthenticationKeyPair)(h),g=a.secp256k1.ProjectivePoint.fromHex(f),b=a.secp256k1.ProjectivePoint.fromHex(r);if(g.equals(b))return{seed:h,keyShareIndex:l[0].keyShareIndex}}return null})(h,e,t,m,r);if(!f){if(d=(0,l.extractRateLimitErrorFromResults)(n),d)throw o.TOPRFError.rateLimitExceeded(d);throw o.TOPRFError.couldNotDeriveEncryptionKey()}return f};n.recoverTOPRFSeed=async e=>{const{authTokens:t,nodeEndpointsMap:a,authConnectionId:c,groupedAuthConnectionId:d,userId:p,userInput:m,keyDeriver:h}=e;if(t.length<i.TOPRF_EVAL_THRESHOLD)throw o.TOPRFError.insufficientAuthTokens(`At least ${i.TOPRF_EVAL_THRESHOLD} auth tokens are required.`);const{a:f,r:g}=u.OPRF.blind(m),b=(0,l.mergeEndpointsWithAuthTokens)(t,a).map((async({endpoint:e,authToken:t})=>{const n=((e,t,n,s,a,r)=>({authToken:e,shareCoefficient:"1",blindedInputX:t,blindedInputY:n,verifier:r??s,verifierId:a}))(t.authToken,f.x.toString(16),f.y.toString(16),c,p,d);return(async(e,t)=>{const n=(0,r.generateJsonRPCObject)(i.JRPC_METHODS.TOPRF_EVAL_REQUEST,t);return(0,l.postJRPCRequest)(e,n)})(e,n)}));try{return await(0,s.Some)(b,(async e=>(0,n.validateSeed)(m,g,e,h)))}catch(e){throw(0,l.getTOPRFError)(e)}}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/toprfEvalRequest.cjs"}],[2899,{"./authenticateRequest.cjs":2887,"./commitRequest.cjs":2888,"./constants.cjs":2889,"./errors.cjs":2890,"./getPubKeyRequest.cjs":2891,"./keyDerivation.cjs":2893,"./metadata.cjs":2894,"./oprf.cjs":2895,"./resetRateLimits.cjs":2896,"./storeSharesRequest.cjs":2897,"./toprfEvalRequest.cjs":2898,"./utils.cjs":2900,"@metamask/auth-network-utils":1468,"@noble/ciphers/utils":3004,"@noble/curves/abstract/utils":3012,"@noble/curves/secp256k1":3015,"@noble/hashes/utils":3030,"@toruslabs/fetch-node-details":3268,buffer:4106},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s,a,r,i,o,c,u,l,d,p,m,h,f=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},g=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ToprfSecureBackup=void 0;const b=e("@metamask/auth-network-utils"),y=e("@noble/ciphers/utils"),S=e("@noble/curves/abstract/utils"),k=e("@noble/curves/secp256k1"),T=e("@noble/hashes/utils"),w=e("@toruslabs/fetch-node-details"),v=e("./authenticateRequest.cjs"),E=e("./commitRequest.cjs"),j=e("./constants.cjs"),P=e("./errors.cjs"),I=e("./getPubKeyRequest.cjs"),_=e("./keyDerivation.cjs"),C=e("./metadata.cjs"),A=e("./oprf.cjs"),x=e("./resetRateLimits.cjs"),O=e("./storeSharesRequest.cjs"),R=e("./toprfEvalRequest.cjs"),F=e("./utils.cjs");class M{constructor(e){s.add(this),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),f(this,r,new w.NodeDetailManager({network:e.network}),"f"),f(this,i,e.nodeDetailsOverride,"f"),f(this,o,e.keyDeriver,"f"),f(this,c,e.fetchMetadataAccessCreds,"f"),g(this,s,"m",l).call(this).catch((()=>{}))}async authenticate(e){const{nodeEndpoints:n,nodeEndpointsMap:a}=await g(this,s,"m",l).call(this);let r=k.secp256k1.utils.randomPrivateKey();try{const s=k.secp256k1.ProjectivePoint.fromPrivateKey(r),i=s.x.toString(16),o=s.y.toString(16);let c;e.groupedAuthConnectionId&&(c=(0,b.remove0x)((0,b.keccak256AndHexify)(t.from(e.idTokens[0],"utf8"))));const u=await(0,E.commitIdToken)({idToken:c??e.idTokens[0],authConnectionId:e.groupedAuthConnectionId??e.authConnectionId,sessionPubKeyX:i,sessionPubKeyY:o,endpoints:n}),l=u.reduce(((e,t)=>(e[t.nodeIndex]=a[t.nodeIndex],e)),{}),{authTokensData:d,isNewUser:p}=await(0,v.authenticateUser)({idToken:e.idTokens[0],authConnectionId:e.authConnectionId,userId:e.userId,sessionPrivateKey:r,nodeEndpointsMap:l,commitmentSignatures:u,groupedAuthConnectionId:e.groupedAuthConnectionId,hashedIdToken:c});return{nodeAuthTokens:d.map((e=>({authToken:e.authToken,nodeIndex:e.nodeIndex,nodePubKey:e.nodePubKey}))),isNewUser:p}}finally{r.fill(0),r=null}}async createLocalKey(e){const{password:t,oprfKey:n=(0,A.generateRandomScalar)()}=e;let s=null;try{s=(0,S.utf8ToBytes)(t);const e=await A.OPRF.localEval(n,s,g(this,o,"f")),a=(0,_.deriveAuthenticationKeyPair)(e),r=(0,_.deriveEncryptionKey)(e);return{oprfKey:n,seed:e,authKeyPair:a,encKey:r,pwEncKey:(0,_.derivePwEncKey)(e)}}finally{s&&(s.fill(0),s=null)}}async persistLocalKey(e){const{nodeAuthTokens:t,oprfKey:n,authPubKey:a,authConnectionId:r,groupedAuthConnectionId:i,userId:o,keyShareIndex:c=j.FIRST_KEY_INDEX,oldAuthKeyPair:u}=e,{nodeEndpointsMap:d}=await g(this,s,"m",l).call(this),p=t.reduce(((e,t)=>(e[t.nodeIndex]=d[t.nodeIndex],e)),{});u?await(0,O.changeKeyShares)({nodeEndpointsMap:p,authConnectionId:r,groupedAuthConnectionId:i,userId:o,authTokens:t,keyShareIndex:c,newOprfKey:n,newAuthPubKey:a,oldAuthPrivKey:u.sk}):await(0,O.storeKeyShares)({nodeEndpointsMap:p,authConnectionId:r,groupedAuthConnectionId:i,userId:o,authTokens:t,keyShareIndex:c,oprfKey:n,authPubKey:a})}async createAndPersistEncKey(e){const{nodeAuthTokens:t,password:n,authConnectionId:s,userId:a}=e,{oprfKey:r,authKeyPair:i,encKey:o,pwEncKey:c}=await this.createLocalKey({password:n});return await this.persistLocalKey({nodeAuthTokens:t,oprfKey:r,authPubKey:i.pk,authConnectionId:s,userId:a}),{authKeyPair:{sk:i.sk,pk:i.pk},encKey:o,pwEncKey:c}}async recoverEncKey(e){const{nodeAuthTokens:t,password:n,authConnectionId:a,groupedAuthConnectionId:r,userId:i}=e;let c=null,u=null;try{const{nodeEndpointsMap:e}=await g(this,s,"m",l).call(this);c=(0,S.utf8ToBytes)(n);const{seed:d,keyShareIndex:p}=await(0,R.recoverTOPRFSeed)({authTokens:t,nodeEndpointsMap:e,authConnectionId:a,groupedAuthConnectionId:r,userId:i,userInput:c,keyDeriver:g(this,o,"f")});u=d;const m=(0,_.deriveAuthenticationKeyPair)(u),h=(0,_.deriveEncryptionKey)(u),f=(0,_.derivePwEncKey)(u),b=new Promise(((n,s)=>{(0,x.resetRateLimits)({authTokens:t,nodeEndpointsMap:e,authConnectionId:a,groupedAuthConnectionId:r,userId:i,authPrivKey:m.sk}).then((()=>n())).catch((e=>{s(e)}))}));return{authKeyPair:m,encKey:h,pwEncKey:f,keyShareIndex:p,rateLimitResetResult:b}}finally{c&&(c.fill(0),c=null),u&&(u.fill(0),u=null)}}async changeEncKey(e){const{nodeAuthTokens:t,authConnectionId:n,groupedAuthConnectionId:a,userId:r,oldEncKey:i,oldPwEncKey:o,oldAuthKeyPair:c,newPassword:u,newKeyShareIndex:l,pregeneratedOprfKey:p}=e;if(!p&&!u)throw new Error("Either newPassword or pregeneratedOprfKey is required");if(p&&u)throw new Error("Only one of newPassword or pregeneratedOprfKey is allowed");const{oprfKey:m,authKeyPair:h,encKey:f,pwEncKey:b}=u?await this.createLocalKey({password:u}):p;let y,S,k;try{y=await g(this,s,"m",d).call(this),[S,k]=await Promise.all([y.acquireMetadataLock(c),y.acquireMetadataLock(h)]);const e=(await y.fetchAllSecretDataItems(i,c)).map((e=>({data:e.data})));if(!e||0===e.length)throw new Error("No existing data found to change key");const u=[{data:N("",o,c),itemId:j.PW_BACKUP_ITEM_ID},...e],p=[b,...e.map((()=>f))];return await y.batchAddSecretData({secretData:u,encKey:p,authKeyPair:h}),await this.persistLocalKey({nodeAuthTokens:t,oprfKey:m,authPubKey:h.pk,authConnectionId:n,groupedAuthConnectionId:a,userId:r,keyShareIndex:l,oldAuthKeyPair:c}),{authKeyPair:h,encKey:f,pwEncKey:b}}finally{if(y&&S&&k)try{await Promise.all([y.releaseMetadataLock(c,S),y.releaseMetadataLock(h,k)])}catch(e){console.error("Failed to release metadata lock:",e)}}}async addSecretDataItem(e){const t=await g(this,s,"m",d).call(this);await t.addSecretDataItem({...e,secretData:{data:e.secretData}})}async batchAddSecretDataItems(e){const t=await g(this,s,"m",d).call(this);let n;try{n=await t.acquireMetadataLock(e.authKeyPair),await t.batchAddSecretData({...e,secretData:e.secretData.map((e=>({data:e})))})}finally{if(n)try{await t.releaseMetadataLock(e.authKeyPair,n)}catch(e){console.error("Failed to release metadata lock:",e)}}}async fetchAllSecretDataItems(e){const t=await g(this,s,"m",d).call(this);return(await t.fetchAllSecretDataItems(e.decKey,e.authKeyPair)).map((e=>e.data))}async fetchAuthPubKey(e){const{nodeAuthTokens:t,authConnectionId:n,userId:a,groupedAuthConnectionId:r}=e,{nodeEndpointsMap:i}=await g(this,s,"m",l).call(this);return(0,I.getPubKey)({authTokens:t,nodeEndpointsMap:i,authConnectionId:n,userId:a,groupedAuthConnectionId:r})}async recoverPwEncKey(e){const{targetAuthPubKey:t,curPwEncKey:n,curAuthKeyPair:a,maxPwChainLength:r=j.MAX_PASSWORD_CHAIN_LENGTH}=e;let i={password:"",encKey:n,authKeyPair:a};for(let e=0;e<r;e++)try{if(i=await g(this,s,"m",m).call(this,{encKey:i.encKey,authKeyPair:i.authKeyPair}),(0,y.equalBytes)(i.authKeyPair.pk,t))return{pwEncKey:i.encKey}}catch(e){throw P.TOPRFError.couldNotFetchPassword(e.message)}throw P.TOPRFError.maxKeyChainLengthExceeded()}}function N(e,t,n){return(0,S.utf8ToBytes)(JSON.stringify({pw:e,encKey:(0,T.bytesToHex)(t),authKeyPair:{sk:n.sk.toString(),pk:(0,T.bytesToHex)(n.pk)}}))}n.ToprfSecureBackup=M,a=M,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,s=new WeakSet,l=async function(){let e=g(this,i,"f")?.indexes,t=g(this,i,"f")?.pubKeys,n=g(this,i,"f")?.endpoints;if(e&&t&&Array.isArray(n))return g(a,a,"m",h).call(a,e,t,n),{nodeEndpoints:n,nodeEndpointsMap:(0,F.createNodeEndpointsMap)(n,e),nodeIndexes:e,nodePubkeys:t};const{torusNodeSSSEndpoints:s,torusIndexes:o,torusNodePub:c}=await g(this,r,"f").getNodeDetails({verifier:"auth-connection-id",verifierId:"user-id"});if(e??(e=o),t??(t=c),!Array.isArray(n)){if(!s){throw new Error("Failed to get node details")}n=n?s.map((e=>{const t=new URL(e);return t.pathname=n,t.href})):s}return g(a,a,"m",h).call(a,e,t,n),{nodeEndpoints:n,nodeEndpointsMap:(0,F.createNodeEndpointsMap)(n,e),nodeIndexes:e,nodePubkeys:t}},d=async function(){if(g(this,u,"f"))return g(this,u,"f");const{nodeEndpointsMap:e}=await g(this,s,"m",l).call(this),t=(await g(this,s,"m",p).call(this,e))[1],n=new C.MetadataStore({metadataEndpoint:t,fetchMetadataAccessCreds:g(this,c,"f")});return f(this,u,n,"f"),n},p=async function(e){const t={};return Object.entries(e).forEach((([e,n])=>{const s=new URL(n);t[e]=`${s.origin}/metadata`})),t},m=async function(e){const t=await g(this,s,"m",d).call(this),n=await t.fetchAllSecretDataItems(e.encKey,e.authKeyPair,j.PW_BACKUP_ITEM_ID);if(0===n.length)throw new Error("Failed to get previous password and keys");const a=function(e){const t=JSON.parse((0,y.bytesToUtf8)(e));return{pw:t.pw,encKey:(0,T.hexToBytes)(t.encKey),authKeyPair:{sk:BigInt(t.authKeyPair.sk),pk:(0,T.hexToBytes)(t.authKeyPair.pk)}}}(n[0].data);return{password:a.pw,encKey:a.encKey,authKeyPair:a.authKeyPair}},h=function(e,t,n){if(e.length!==t.length||e.length!==n.length){throw new Error("Node details arrays (indexes, pubKeys, endpoints) must have equal lengths")}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/toprfSecureBackup.cjs"}],[2900,{"./constants.cjs":2889,"./errors.cjs":2890,"@metamask/auth-network-utils":1468,"@noble/curves/secp256k1":3015,"@noble/hashes/sha3":3028,"@toruslabs/eccrypto":3267,"@toruslabs/http-helpers":2901,"bn.js":4045,buffer:4106},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.preserveKeyOrder=n.getTOPRFError=n.parseJsonRpcError=n.mergeEndpointsWithAuthTokens=n.checkRateLimitErrors=n.extractRateLimitErrorFromResults=n.getMaxRateLimitError=n.createNodeEndpointsMap=n.generateShareImportItems=n.createKeyChangeShareImportItems=n.createNewUserShareImportItems=n.createKeyChangeProof=n.createEthereumSignature=n.prepareNodeShares=n.decryptAuthToken=n.postJRPCRequest=n.bigIntToBN=void 0;const a=e("@metamask/auth-network-utils"),r=e("@noble/curves/secp256k1"),i=e("@noble/hashes/sha3"),o=e("@toruslabs/eccrypto"),c=e("@toruslabs/http-helpers"),u=s(e("bn.js")),l=e("./constants.cjs"),d=e("./errors.cjs");n.bigIntToBN=e=>new u.default(e.toString());n.postJRPCRequest=async(e,t)=>{const n={...t};return n.params=(0,a.toSnakeCaseKeys)(t.params),(0,c.post)(e,n,{},{logTracingHeader:!1}).then((e=>(e.result&&(e.result=(0,a.toCamelCaseKeys)(e.result)),e))).catch((e=>({id:t.id,jsonrpc:"2.0",error:{code:-32e3,message:"Internal error",data:e}})))};n.decryptAuthToken=async(e,n)=>{const s=JSON.parse(e),r=(0,a.encParamsHexToBuf)(s.metadata),i=await(0,o.decrypt)(t.from(n),{...r,ciphertext:t.from(s.data,"hex")});return t.from(i).toString("base64")};const p=async(e,n)=>{const s=await(0,o.encrypt)(n,e,{padding:!0}),r=(0,a.encryptedParamsBufToHex)(s);return{data:t.from(s.ciphertext).toString("hex"),metadata:{...r}}};n.prepareNodeShares=(e,t)=>{const s=(0,n.bigIntToBN)(t),r=(0,a.getSecp256K1Curve)(),i=Object.keys(e).map((e=>parseInt(e,10))),o=((e,t,n,s)=>{const r=t.map((e=>new u.default(e))),i=s-1;return(0,a.generateRandomPolynomial)(e,i,n).generateShares(r)})(r,i,s,l.GENERATE_SHARE_THRESHOLD);return{shares:o,nodeIndexes:i}};n.createEthereumSignature=(e,t)=>{const n=t.toString(16).padStart(64,"0"),s=r.secp256k1.sign(e,n);return s.toCompactHex()+(s.recovery+27).toString(16).padStart(2,"0")};n.createKeyChangeProof=(e,s,r,o)=>{const c=Math.floor(Date.now()/1e3),u=(e=>e.toArrayLike(t,"be",32).toString("base64"))(e),l=(0,a.toSnakeCaseKeys)({shareData:u,keyShareIndex:s,nodeIndex:r,timestamp:c}),d=JSON.stringify(l),p=(0,i.keccak_256)(d);return{oldKeySignature:(0,n.createEthereumSignature)(p,o),signatureTimestamp:c}};n.createNewUserShareImportItems=async(e,n,s,a)=>Promise.all(s.map((async s=>{const{nodePubKey:r,nodeIndex:i,authToken:o}=s,c=new u.default(i).toString("hex",64),l=e[c].toJSON(),d=await p(t.from(l.share,"hex"),t.from(r,"hex")),m=await p(t.from(o,"base64"),t.from(r,"hex"));return{encryptedShare:JSON.stringify(d),encryptedAuthToken:JSON.stringify(m),keyShareIndex:a,nodeIndex:i,sssEndpoint:n[i]}})));n.createKeyChangeShareImportItems=async(e,s,a,r,i)=>Promise.all(a.map((async a=>{const{nodePubKey:o,nodeIndex:c,authToken:l}=a,d=new u.default(c).toString("hex",64),m=e[d].toJSON(),h=new u.default(m.share,16),f=(0,n.createKeyChangeProof)(h,r,c,i),g=await p(t.from(m.share,"hex"),t.from(o,"hex")),b=await p(t.from(l,"base64"),t.from(o,"hex"));return{encryptedShare:JSON.stringify(g),encryptedAuthToken:JSON.stringify(b),keyShareIndex:r,nodeIndex:c,sssEndpoint:s[c],...f}})));n.generateShareImportItems=async(e,t,s,a,...r)=>{const{shares:i}=(0,n.prepareNodeShares)(e,s),o=r[0];return o!==undefined?(0,n.createKeyChangeShareImportItems)(i,e,t,a,o):(0,n.createNewUserShareImportItems)(i,e,t,a)};function m(e,t){return e.remainingTime>t.remainingTime?e:t}function h(e){if(!(0,a.isJSONRPCError)(e)||-32602!==e.code||"Rate limit exceeded"!==e.message||!e.data)return undefined;const t=(0,a.toCamelCaseKeys)(e.data);return"string"!=typeof t?.message||"number"!=typeof t?.remainingTime||"number"!=typeof t?.lockTime||"number"!=typeof t?.guessCount?undefined:{message:t.message,remainingTime:t.remainingTime,lockTime:t.lockTime,guessCount:t.guessCount}}n.createNodeEndpointsMap=(e,t)=>t.reduce(((t,n)=>(t[n]=e[n-1],t)),{}),n.getMaxRateLimitError=m,n.extractRateLimitErrorFromResults=function(e){let t;for(const n of e)if(n.result?.lockTimeSeconds&&n.result.lockTimeSeconds>0&&n.result.guessCount){const e={remainingTime:n.result.lockTimeSeconds,message:"Rate limit exceeded",lockTime:n.result.lockTimeSeconds,guessCount:n.result.guessCount};t=t?m(t,e):e}return t},n.checkRateLimitErrors=function(e){const t=(0,a.filterErrorResponses)(e);let n;for(const e of t){const t=h(e.error);t&&(n=n?m(n,t):t)}return n},n.mergeEndpointsWithAuthTokens=function(e,t){return e.map((e=>{const n=t[e.nodeIndex];if(!n)throw d.TOPRFError.endpointNotFound(`Endpoint not found for node index ${e.nodeIndex}`);return{endpoint:n,authToken:e}}))},n.parseJsonRpcError=function(e){if(e.code===l.JsonRpcErrorCodes.ErrorCodeInvalidParams){if(e.message.toLowerCase().includes("auth token expired"))return d.TOPRFError.authTokenExpired();if(e.message.toLowerCase().includes("invalid auth token"))return d.TOPRFError.invalidAuthToken();let t=e.message;if("string"==typeof e.data)t=e.data;else if(e.data){const n=(0,a.toCamelCaseKeys)(e.data);t=JSON.stringify(n)}return d.TOPRFError.jsonRpcError(t)}if(e.code===l.JsonRpcErrorCodes.ErrorCodeInternal){const t=e.data??e.message;return d.TOPRFError.jsonRpcError(t)}return d.TOPRFError.default(e.message)},n.getTOPRFError=function(e){return e instanceof a.SomeError&&e.predicate&&e.predicate instanceof d.TOPRFError?e.predicate:e},n.preserveKeyOrder=function(e,t){return 0}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup",file:"node_modules/@metamask/toprf-secure-backup/dist/utils.cjs"}],[2901,{"@babel/runtime/helpers/objectSpread2":463,deepmerge:4260,loglevel:4920},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=e("@babel/runtime/helpers/objectSpread2"),a=e("deepmerge"),r=e("loglevel");const i=r.getLogger("http-helpers");i.setLevel(r.levels.INFO);let o="torus-default",c="";const u="x-api-key",l="x-embed-host";let d=null;const p=[],m=[];async function h(e,t){let n=null;try{n=new URL(e)}catch{}if(d&&n&&(p.includes(n.origin)||m.includes(n.pathname))){return await d.startSpan({name:e,op:"http.client"},(async()=>await fetch(e,t)))}return fetch(e,t)}function f(){const e={};return o&&(e[u]=o),c&&(e[l]=c),e}function g(e){i.info(`Response: ${e.status} ${e.statusText}`),i.info(`Url: ${e.url}`)}const b=async(e,t)=>{let n=null;try{const s=new Promise(((t,s)=>{n=setTimeout((()=>{s(new Error(`Timed out in ${e}ms`))}),e)})),a=await Promise.race([t,s]);return null!=n&&clearTimeout(n),a}catch(e){throw null!=n&&clearTimeout(n),e}},y=async(e,t={},n={})=>{const r={mode:"cors",headers:{}};n.useAPIKey&&(r.headers=s(s({},r.headers),f())),t.method="GET";const i=a(r,t),o=await h(e,i);if(o.ok){const e=o.headers.get("content-type");return null!=e&&e.includes("application/json")?o.json():o.text()}throw g(o),o};n.clearAPIKey=function(){o="torus-default"},n.clearEmbedHost=function(){c=""},n.enableSentryTracing=function(e,t,n){d=e,p.push(...t),m.push(...n)},n.gatewayAuthHeader=u,n.gatewayEmbedHostHeader=l,n.generateJsonRPCObject=(e,t)=>({jsonrpc:"2.0",method:e,id:10,params:t}),n.get=y,n.getAPIKey=function(){return o},n.getEmbedHost=function(){return c},n.patch=async(e,t={},n={},r={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=s(s({},i.headers),f())),n.method="PATCH";const o=a(i,n);r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const c=await h(e,o);if(c.ok){const e=c.headers.get("content-type");return null!=e&&e.includes("application/json")?c.json():c.text()}throw g(c),c},n.post=(e,t={},n={},r={})=>{const o={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(o.headers=s(s({},o.headers),f())),n.method="POST";const c=a(o,n);return r.isUrlEncodedData?(c.body=t,"application/json; charset=utf-8"===c.headers["Content-Type"]&&delete c.headers["Content-Type"]):c.body=JSON.stringify(t),b(r.timeout||6e4,h(e,c).then((e=>{if(r.logTracingHeader&&function(e){const t=e.headers.get("x-web3-correlation-id");t&&i.info(`Request tracing with traceID = ${t}`)}(e),e.ok){const t=e.headers.get("content-type");return null!=t&&t.includes("application/json")?e.json():e.text()}throw g(e),e})))},n.promiseRace=(e,t,n=6e4)=>Promise.race([y(e,t),new Promise(((e,t)=>{setTimeout((()=>{t(new Error("timed out"))}),n)}))]),n.promiseTimeout=b,n.put=async(e,t={},n={},r={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=s(s({},i.headers),f())),n.method="PUT";const o=a(i,n);r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const c=await h(e,o);if(c.ok){const e=c.headers.get("content-type");return null!=e&&e.includes("application/json")?c.json():c.text()}throw g(c),c},n.remove=async(e,t={},n={},r={})=>{const i={mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};r.useAPIKey&&(i.headers=s(s({},i.headers),f())),n.method="DELETE";const o=a(i,n);r.isUrlEncodedData?(o.body=t,"application/json; charset=utf-8"===o.headers["Content-Type"]&&delete o.headers["Content-Type"]):o.body=JSON.stringify(t);const c=await h(e,o);if(c.ok){const e=c.headers.get("content-type");return null!=e&&e.includes("application/json")?c.json():c.text()}throw g(c),c},n.setAPIKey=function(e){o=e},n.setEmbedHost=function(e){c=e},n.setLogLevel=function(e){i.setLevel(e)}}}},{package:"@metamask/seedless-onboarding-controller>@metamask/toprf-secure-backup>@toruslabs/http-helpers",file:"node_modules/@metamask/toprf-secure-backup/node_modules/@toruslabs/http-helpers/dist/lib.cjs/index.js"}],[2902,{"./api/accounts-api.cjs":2903,"./gas-flows/DefaultGasFeeFlow.cjs":2907,"./gas-flows/LineaGasFeeFlow.cjs":2908,"./gas-flows/OptimismLayer1GasFeeFlow.cjs":2909,"./gas-flows/RandomisedEstimationsGasFeeFlow.cjs":2911,"./gas-flows/ScrollLayer1GasFeeFlow.cjs":2912,"./gas-flows/TestGasFeeFlow.cjs":2913,"./helpers/AccountsApiRemoteTransactionSource.cjs":2914,"./helpers/GasFeePoller.cjs":2915,"./helpers/IncomingTransactionHelper.cjs":2916,"./helpers/MethodDataHelper.cjs":2917,"./helpers/MultichainTrackingHelper.cjs":2918,"./helpers/PendingTransactionTracker.cjs":2919,"./helpers/ResimulateHelper.cjs":2920,"./hooks/ExtraTransactionsPublishHook.cjs":2923,"./logger.cjs":2926,"./types.cjs":2927,"./utils/balance-changes.cjs":2928,"./utils/batch.cjs":2929,"./utils/eip7702.cjs":2930,"./utils/external-transactions.cjs":2931,"./utils/gas-fee-tokens.cjs":2933,"./utils/gas-fees.cjs":2934,"./utils/gas-flow.cjs":2935,"./utils/gas.cjs":2936,"./utils/history.cjs":2937,"./utils/layer1-gas-fee-flow.cjs":2938,"./utils/nonce.cjs":2939,"./utils/prepare.cjs":2940,"./utils/retry.cjs":2941,"./utils/swaps.cjs":2943,"./utils/transaction-type.cjs":2944,"./utils/utils.cjs":2945,"./utils/validation.cjs":2946,"@metamask/base-controller":1476,"@metamask/controller-utils":1559,"@metamask/eth-query":1775,"@metamask/network-controller":2321,"@metamask/nonce-tracker":2327,"@metamask/rpc-errors":2524,"@metamask/utils":2974,events:4454,lodash:4912,uuid:5741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h,f,g,b,y,S,k,T,w,v,E,j,P,I,_,C,A,x,O,R,F,M,N,L,G,D,B,U,H,$,K,W,q,z,V,J,X,Y,Q,Z,ee,te,ne,se,ae,re,ie,oe,ce,ue,le,de,pe,me,he,fe,ge,be,ye,Se,ke,Te,we,ve,Ee,je,Pe,Ie,_e,Ce,Ae,xe,Oe,Re,Fe,Me,Ne,Le,Ge,De,Be,Ue,He,$e,Ke,We,qe,ze,Ve,Je,Xe,Ye,Qe,Ze,et=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},tt=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},nt=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.TransactionController=n.ApprovalState=n.SPEED_UP_RATE=n.CANCEL_RATE=void 0;const st=e("@metamask/base-controller"),at=e("@metamask/controller-utils"),rt=nt(e("@metamask/eth-query")),it=e("@metamask/network-controller"),ot=e("@metamask/nonce-tracker"),ct=e("@metamask/rpc-errors"),ut=e("@metamask/utils"),lt=e("events"),dt=e("lodash"),pt=e("uuid"),mt=e("./api/accounts-api.cjs"),ht=e("./gas-flows/DefaultGasFeeFlow.cjs"),ft=e("./gas-flows/LineaGasFeeFlow.cjs"),gt=e("./gas-flows/OptimismLayer1GasFeeFlow.cjs"),bt=e("./gas-flows/RandomisedEstimationsGasFeeFlow.cjs"),yt=e("./gas-flows/ScrollLayer1GasFeeFlow.cjs"),St=e("./gas-flows/TestGasFeeFlow.cjs"),kt=e("./helpers/AccountsApiRemoteTransactionSource.cjs"),Tt=e("./helpers/GasFeePoller.cjs"),wt=e("./helpers/IncomingTransactionHelper.cjs"),vt=e("./helpers/MethodDataHelper.cjs"),Et=e("./helpers/MultichainTrackingHelper.cjs"),jt=e("./helpers/PendingTransactionTracker.cjs"),Pt=e("./helpers/ResimulateHelper.cjs"),It=e("./hooks/ExtraTransactionsPublishHook.cjs"),_t=e("./logger.cjs"),Ct=e("./types.cjs"),At=e("./utils/balance-changes.cjs"),xt=e("./utils/batch.cjs"),Ot=e("./utils/eip7702.cjs"),Rt=e("./utils/external-transactions.cjs"),Ft=e("./utils/gas.cjs"),Mt=e("./utils/gas-fee-tokens.cjs"),Nt=e("./utils/gas-fees.cjs"),Lt=e("./utils/gas-flow.cjs"),Gt=e("./utils/history.cjs"),Dt=e("./utils/layer1-gas-fee-flow.cjs"),Bt=e("./utils/nonce.cjs"),Ut=e("./utils/prepare.cjs"),Ht=e("./utils/retry.cjs"),$t=e("./utils/swaps.cjs"),Kt=e("./utils/transaction-type.cjs"),Wt=e("./utils/utils.cjs"),qt=e("./utils/validation.cjs"),zt={transactions:{persist:!0,anonymous:!1},transactionBatches:{persist:!0,anonymous:!1},methodData:{persist:!0,anonymous:!1},lastFetchedBlockNumbers:{persist:!0,anonymous:!1},submitHistory:{persist:!0,anonymous:!1}};n.CANCEL_RATE=1.1,n.SPEED_UP_RATE=1.1;const Vt="TransactionController";var Jt;!function(e){e.Approved="approved",e.NotApproved="not-approved",e.SkippedViaBeforePublishHook="skipped-via-before-publish-hook"}(Jt||(n.ApprovalState=Jt={}));class Xt extends st.BaseController{constructor(e){const{disableHistory:t,disableSendFlowHistory:n,disableSwaps:K,getCurrentAccountEIP1559Compatibility:W,getCurrentNetworkEIP1559Compatibility:q,getExternalPendingTransactions:z,getGasFeeEstimates:J,getNetworkClientRegistry:X,getNetworkState:Y,getPermittedAccounts:Q,getSavedGasFees:Z,hooks:te,incomingTransactions:ne={},isAutomaticGasFeeUpdateEnabled:se,isEIP7702GasFeeTokensEnabled:ae,isFirstTimeInteractionEnabled:re,isSimulationEnabled:ie,messenger:oe,pendingTransactions:ce={},publicKeyEIP7702:ue,securityProviderRequest:le,sign:pe,state:me,testGasFeeFlows:he,trace:fe,transactionHistoryLimit:ge=40}=e;super({name:Vt,metadata:zt,messenger:oe,state:{methodData:{},transactions:[],transactionBatches:[],lastFetchedBlockNumbers:{},submitHistory:[],...me}}),s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,new Set),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),p.set(this,void 0),m.set(this,void 0),h.set(this,void 0),f.set(this,void 0),g.set(this,void 0),b.set(this,void 0),y.set(this,void 0),S.set(this,void 0),k.set(this,void 0),T.set(this,void 0),w.set(this,new lt.EventEmitter),v.set(this,void 0),E.set(this,void 0),j.set(this,void 0),P.set(this,void 0),I.set(this,void 0),_.set(this,void 0),C.set(this,void 0),A.set(this,void 0),x.set(this,void 0),O.set(this,void 0),R.set(this,void 0),F.set(this,void 0),M.set(this,void 0),N.set(this,void 0),L.set(this,void 0),G.set(this,void 0),D.set(this,new Map),B.set(this,new Set),U.set(this,void 0),H.set(this,void 0),$.set(this,void 0),_e.set(this,(()=>{tt(this,O,"f").checkForPendingTransactionAndStartPolling()})),this.messagingSystem=oe,et(this,a,te?.afterAdd??(()=>Promise.resolve({})),"f"),et(this,r,te?.afterSign??(()=>!0),"f"),et(this,i,te?.afterSimulate??(()=>Promise.resolve({})),"f"),et(this,c,te?.beforeCheckPendingTransaction??(()=>Promise.resolve(!0)),"f"),et(this,u,te?.beforePublish??(()=>Promise.resolve(!0)),"f"),et(this,l,te?.beforeSign??(()=>Promise.resolve({})),"f"),et(this,p,te?.getAdditionalSignArguments??(()=>[]),"f"),et(this,m,W??(()=>Promise.resolve(!0)),"f"),et(this,h,q,"f"),et(this,f,z??(()=>[]),"f"),et(this,g,J||(()=>Promise.resolve({})),"f"),et(this,b,Y,"f"),et(this,y,Q,"f"),et(this,S,Z??(e=>undefined),"f"),et(this,T,ne,"f"),et(this,v,se??(e=>!1),"f"),et(this,E,ae??(()=>Promise.resolve(!1)),"f"),et(this,j,re??(()=>!0),"f"),et(this,P,t??!1,"f"),et(this,I,n??!1,"f"),et(this,_,ie??(()=>!0),"f"),et(this,C,K??!1,"f"),et(this,R,ce,"f"),et(this,F,ue,"f"),et(this,M,te?.publish??(()=>Promise.resolve({transactionHash:undefined})),"f"),et(this,N,te?.publishBatch,"f"),et(this,L,le,"f"),et(this,G,pe,"f"),et(this,U,!0===he,"f"),et(this,H,fe??((e,t)=>t?.()),"f"),et(this,$,ge,"f");const be=e=>this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",e);et(this,O,new Et.MultichainTrackingHelper({findNetworkClientIdByChainId:be,getNetworkClientById:e=>this.messagingSystem.call("NetworkController:getNetworkClientById",e),getNetworkClientRegistry:X,removePendingTransactionTrackerListeners:tt(this,s,"m",xe).bind(this),createNonceTracker:tt(this,s,"m",Pe).bind(this),createPendingTransactionTracker:tt(this,s,"m",Ie).bind(this),onNetworkStateChange:e=>{this.messagingSystem.subscribe("NetworkController:stateChange",e)}}),"f"),tt(this,O,"f").initialize(),et(this,d,tt(this,s,"m",Ne).call(this),"f"),et(this,A,tt(this,s,"m",Le).call(this),"f");const ye=new Tt.GasFeePoller({findNetworkClientIdByChainId:be,gasFeeFlows:tt(this,d,"f"),getGasFeeControllerEstimates:tt(this,g,"f"),getProvider:e=>tt(this,s,"m",de).call(this,{networkClientId:e}),getTransactions:()=>this.state.transactions,getTransactionBatches:()=>this.state.transactionBatches,layer1GasFeeFlows:tt(this,A,"f"),messenger:this.messagingSystem,onStateChange:e=>{this.messagingSystem.subscribe("TransactionController:stateChange",e)}});ye.hub.on("transaction-updated",tt(this,s,"m",Ue).bind(this)),ye.hub.on("transaction-batch-updated",tt(this,s,"m",He).bind(this)),et(this,x,new vt.MethodDataHelper({getProvider:e=>tt(this,s,"m",de).call(this,{networkClientId:e}),getState:()=>this.state.methodData}),"f"),tt(this,x,"f").hub.on("update",(({fourBytePrefix:e,methodData:t})=>{this.update((n=>{n.methodData[e]=t}))})),et(this,k,new wt.IncomingTransactionHelper({client:tt(this,T,"f").client,getCurrentAccount:()=>tt(this,s,"m",Ke).call(this),getLocalTransactions:()=>this.state.transactions,includeTokenTransfers:tt(this,T,"f").includeTokenTransfers,isEnabled:tt(this,T,"f").isEnabled,messenger:this.messagingSystem,remoteTransactionSource:new kt.AccountsApiRemoteTransactionSource,trimTransactions:tt(this,s,"m",ee).bind(this),updateTransactions:tt(this,T,"f").updateTransactions}),"f"),tt(this,s,"m",Ae).call(this,tt(this,k,"f")),this.messagingSystem.subscribe("TransactionController:stateChange",tt(this,_e,"f")),new Pt.ResimulateHelper({simulateTransaction:tt(this,s,"m",Be).bind(this),onTransactionsUpdate:e=>{this.messagingSystem.subscribe("TransactionController:stateChange",e,(e=>e.transactions))},getTransactions:()=>this.state.transactions}),tt(this,s,"m",V).call(this),tt(this,_e,"f").call(this),tt(this,s,"m",Ve).call(this)}destroy(){tt(this,s,"m",Ce).call(this)}async handleMethodData(e,t){return tt(this,x,"f").lookup(e,t)}async addTransactionBatch(e){const{blockTracker:t}=this.messagingSystem.call("NetworkController:getNetworkClientById",e.networkClientId);return await(0,xt.addTransactionBatch)({addTransaction:this.addTransaction.bind(this),getChainId:tt(this,s,"m",ce).bind(this),getEthQuery:e=>tt(this,s,"m",le).call(this,{networkClientId:e}),getGasFeeEstimates:tt(this,g,"f"),getInternalAccounts:tt(this,s,"m",We).bind(this),getPendingTransactionTracker:e=>tt(this,s,"m",Ie).call(this,{provider:tt(this,s,"m",de).call(this,{networkClientId:e}),blockTracker:t,chainId:tt(this,s,"m",ce).call(this,e),networkClientId:e}),getTransaction:e=>tt(this,s,"m",re).call(this,e),isSimulationEnabled:tt(this,_,"f"),messenger:this.messagingSystem,publishBatchHook:tt(this,N,"f"),publicKeyEIP7702:tt(this,F,"f"),publishTransaction:(e,t)=>tt(this,s,"m",Q).call(this,e,t),request:e,update:this.update.bind(this),updateTransaction:tt(this,s,"m",Ge).bind(this)})}async isAtomicBatchSupported(e){return(0,xt.isAtomicBatchSupported)({...e,getEthQuery:e=>tt(this,s,"m",le).call(this,{chainId:e}),messenger:this.messagingSystem,publicKeyEIP7702:tt(this,F,"f")})}async addTransaction(e,t){(0,_t.projectLogger)("Adding transaction",e,t);const{actionId:n,batchId:r,deviceConfirmedOn:i,disableGasBuffer:o,method:c,nestedTransactions:u,networkClientId:l,origin:d,publishHook:p,requireApproval:m,securityAlertResponse:h,sendFlowHistory:f,swaps:g={},traceContext:b,type:S}=t;if(e=(0,Wt.normalizeTransactionParams)(e),!tt(this,O,"f").has(l))throw new Error(`Network client not found - ${l}`);const k=tt(this,s,"m",ce).call(this,l),T=tt(this,s,"m",le).call(this,{networkClientId:l}),w=d===undefined?undefined:await(tt(this,y,"f")?.call(this,d)),v=tt(this,s,"m",We).call(this);await(0,qt.validateTransactionOrigin)({data:e.data,from:e.from,internalAccounts:v,origin:d,permittedAddresses:w,txParams:e,type:S});const E=(0,Ot.getDelegationAddress)(e.from,T).catch((()=>undefined)),j=await tt(this,s,"m",ke).call(this,l);(0,qt.validateTxParams)(e,j,k),e.type||(0,Wt.setEnvelopeType)(e,j);if(r?.length&&this.state.transactions.some((e=>e.batchId?.toLowerCase()===r?.toLowerCase()))&&d&&d!==at.ORIGIN_METAMASK)throw new ct.JsonRpcError(qt.ErrorCode.DuplicateBundleId,"Batch ID already exists");const _=tt(this,s,"m",me).call(this,e,d),A=S??(await(0,Kt.determineTransactionType)(e,T)).type,x=await E,R=tt(this,s,"m",be).call(this,n);let F=R?(0,dt.cloneDeep)(R):{actionId:n,batchId:r,chainId:k,dappSuggestedGasFees:_,delegationAddress:x,deviceConfirmedOn:i,disableGasBuffer:o,id:(0,pt.v1)(),isFirstTimeInteraction:undefined,nestedTransactions:u,networkClientId:l,origin:d,securityAlertResponse:h,status:Ct.TransactionStatus.unapproved,time:Date.now(),txParams:e,type:A,userEditedGasLimit:!1,verifiedOnBlockchain:!1};const{updateTransaction:M}=await tt(this,a,"f").call(this,{transactionMeta:F});if(M&&((0,_t.projectLogger)("Updating transaction using afterAdd hook"),F.txParamsOriginal=(0,dt.cloneDeep)(F.txParams),M(F)),await tt(this,H,"f").call(this,{name:"Estimate Gas Properties",parentContext:b},(e=>tt(this,s,"m",z).call(this,F,{traceContext:e}))),!R){if(c&&tt(this,L,"f")){const e=await tt(this,L,"f").call(this,F,c);F.securityProviderResponse=e}tt(this,I,"f")||(F.sendFlowHistory=f??[]),tt(this,P,"f")||(F=(0,Gt.addInitialHistorySnapshot)(F)),F=(0,$t.updateSwapsTransaction)(F,A,g,{isSwapsDisabled:tt(this,C,"f"),cancelTransaction:tt(this,s,"m",Z).bind(this),messenger:this.messagingSystem}),tt(this,s,"m",q).call(this,F),!1!==m?(tt(this,s,"m",Be).call(this,F,{traceContext:b}).catch((e=>{throw(0,_t.projectLogger)("Error while updating simulation data",e),e})),tt(this,s,"m",De).call(this,F,{traceContext:b}).catch((e=>{(0,_t.projectLogger)("Error while updating first interaction properties",e)}))):(0,_t.projectLogger)("Skipping simulation & first interaction update as approval not required"),this.messagingSystem.publish(`${Vt}:unapprovedTransactionAdded`,F)}return{result:tt(this,s,"m",X).call(this,F,{actionId:n,isExisting:Boolean(R),publishHook:p,requireApproval:m,traceContext:b}),transactionMeta:F}}startIncomingTransactionPolling(){tt(this,k,"f").start()}stopIncomingTransactionPolling(){tt(this,k,"f").stop()}async updateIncomingTransactions({tags:e}={}){await tt(this,k,"f").update({tags:e})}async stopTransaction(e,t,{estimatedBaseFee:a,actionId:r}={}){await tt(this,s,"m",K).call(this,{actionId:r,estimatedBaseFee:a,gasValues:t,label:"cancel",rate:n.CANCEL_RATE,transactionId:e,transactionType:Ct.TransactionType.cancel,prepareTransactionParams:e=>{delete e.data,e.to=e.from,e.value="0x0"},afterSubmit:e=>{this.messagingSystem.publish(`${Vt}:transactionFinished`,e),tt(this,w,"f").emit(`${e.id}:finished`,e)}})}async speedUpTransaction(e,t,{actionId:a,estimatedBaseFee:r}={}){await tt(this,s,"m",K).call(this,{actionId:a,estimatedBaseFee:r,gasValues:t,label:"speed up",rate:n.SPEED_UP_RATE,transactionId:e,transactionType:Ct.TransactionType.retry,afterSubmit:e=>{this.messagingSystem.publish(`${Vt}:speedupTransactionAdded`,e)}})}async estimateGas(e,t,{ignoreDelegationSignatures:n}={}){const a=tt(this,s,"m",le).call(this,{networkClientId:t}),{estimatedGas:r,simulationFails:i}=await(0,Ft.estimateGas)({chainId:tt(this,s,"m",ce).call(this,t),ethQuery:a,ignoreDelegationSignatures:n,isSimulationEnabled:tt(this,_,"f").call(this),messenger:this.messagingSystem,txParams:e});return{gas:r,simulationFails:i}}async estimateGasBuffered(e,t,n){const a=tt(this,s,"m",le).call(this,{networkClientId:n}),{blockGasLimit:r,estimatedGas:i,simulationFails:o}=await(0,Ft.estimateGas)({chainId:tt(this,s,"m",ce).call(this,n),ethQuery:a,isSimulationEnabled:tt(this,_,"f").call(this),messenger:this.messagingSystem,txParams:e});return{gas:(0,Ft.addGasBuffer)(i,r,t),simulationFails:o}}updateTransaction(e,t){const{id:n}=e;tt(this,s,"m",Ge).call(this,{transactionId:n,note:t},(()=>({...e})))}updateSecurityAlertResponse(e,t){if(!t)throw new Error("updateSecurityAlertResponse: securityAlertResponse should not be null");const n=tt(this,s,"m",ae).call(this,e);if(!n)throw new Error("Cannot update security alert response as no transaction metadata found");const a={...n,securityAlertResponse:t};this.updateTransaction(a,`${Vt}:updatesecurityAlertResponse - securityAlertResponse updated`)}wipeTransactions({address:e,chainId:t}={}){if(!t&&!e)return void this.update((e=>{e.transactions=[]}));const n=this.state.transactions.filter((({chainId:n,txParams:s,type:a})=>{if(!(!t||t===n))return!0;return!(!e||s.from?.toLowerCase()===e.toLowerCase()||a===Ct.TransactionType.incoming&&s.to?.toLowerCase()===e.toLowerCase())}));this.update((e=>{e.transactions=tt(this,s,"m",ee).call(this,n)}))}async confirmExternalTransaction(e,t,n){const a=tt(this,s,"m",he).call(this,e);try{const e=a.id,r={...a,status:Ct.TransactionStatus.confirmed,txReceipt:t};n&&(r.baseFeePerGas=n),tt(this,s,"m",fe).call(this,e),this.updateTransaction(r,`${Vt}:confirmExternalTransaction - Add external transaction`),tt(this,s,"m",we).call(this,r),tt(this,s,"m",je).call(this,r).catch((e=>{throw(0,_t.projectLogger)("Error while updating post balance",e),e})),this.messagingSystem.publish(`${Vt}:transactionConfirmed`,r)}catch(e){console.error("Failed to confirm external transaction",e)}}updateTransactionSendFlowHistory(e,t,n){if(tt(this,I,"f"))throw new Error("Send flow history is disabled for the current transaction controller");const a=tt(this,s,"m",ae).call(this,e);if(!a)throw new Error("Cannot update send flow history as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(a,"updateTransactionSendFlowHistory");const r=a.sendFlowHistory??[];if(t===r.length){const e={...a,sendFlowHistory:[...r,...n]};this.updateTransaction(e,`${Vt}:updateTransactionSendFlowHistory - sendFlowHistory updated`)}return tt(this,s,"m",ae).call(this,e)}updateTransactionGasFees(e,{defaultGasEstimates:t,estimateUsed:n,estimateSuggested:a,gas:r,gasLimit:i,gasPrice:o,maxPriorityFeePerGas:c,maxFeePerGas:u,originalGasEstimate:l,userEditedGasLimit:d,userFeeLevel:p}){const m=tt(this,s,"m",ae).call(this,e);if(!m)throw new Error("Cannot update transaction as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(m,"updateTransactionGasFees");const h=(0,dt.cloneDeep)(m),f=m.gasFeeEstimates,g=tt(this,v,"f").call(this,m),b=p,y=Object.values(Ct.GasFeeEstimateLevel).includes(b),S=f&&g&&y;S&&(0,Tt.updateTransactionGasEstimates)({txMeta:h,userFeeLevel:b});const k={gas:r,gasLimit:i};S?Object.assign(k,{gasPrice:h.txParams.gasPrice,maxPriorityFeePerGas:h.txParams.maxPriorityFeePerGas,maxFeePerGas:h.txParams.maxFeePerGas}):Object.assign(k,{gasPrice:o,maxPriorityFeePerGas:c,maxFeePerGas:u});const T={txParams:(0,dt.pickBy)(k),defaultGasEstimates:t,estimateUsed:n,estimateSuggested:a,originalGasEstimate:l,userEditedGasLimit:d,userFeeLevel:b},w=(0,dt.pickBy)(T);return tt(this,s,"m",Ge).call(this,{transactionId:e,note:`${Vt}:updateTransactionGasFees - gas values updated`,skipResimulateCheck:!0},(e=>{const{txParams:t,...n}=w;Object.assign(e,n),t&&Object.assign(e.txParams,t)})),tt(this,s,"m",ae).call(this,e)}updatePreviousGasParams(e,{gasLimit:t,maxFeePerGas:n,maxPriorityFeePerGas:a}){const r=tt(this,s,"m",ae).call(this,e);if(!r)throw new Error("Cannot update transaction as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(r,"updatePreviousGasParams");const i={previousGas:{gasLimit:t,maxFeePerGas:n,maxPriorityFeePerGas:a}};i.previousGas=(0,dt.pickBy)(i.previousGas);const o=(0,dt.merge)({},r,i);return this.updateTransaction(o,`${Vt}:updatePreviousGasParams - Previous gas values updated`),tt(this,s,"m",ae).call(this,e)}async getNonceLock(e,t){return tt(this,O,"f").getNonceLock(e,t)}async updateEditableParams(e,{containerTypes:t,data:n,from:a,gas:r,gasPrice:i,maxFeePerGas:o,maxPriorityFeePerGas:c,to:u,value:l}){const d=tt(this,s,"m",ae).call(this,e);if(!d)throw new Error("Cannot update editable params as no transaction metadata found");(0,Wt.validateIfTransactionUnapproved)(d,"updateEditableParams");const p={txParams:{data:n,from:a,to:u,value:l,gas:r,gasPrice:i,maxFeePerGas:o,maxPriorityFeePerGas:c}};p.txParams=(0,dt.pickBy)(p.txParams);const m=(0,dt.merge)({},d,p),{networkClientId:h}=d,f=tt(this,s,"m",de).call(this,{networkClientId:h}),g=new rt.default(f),{type:b}=await(0,Kt.determineTransactionType)(m.txParams,g);return m.type=b,t&&(m.containerTypes=t),await(0,Dt.updateTransactionLayer1GasFee)({layer1GasFeeFlows:tt(this,A,"f"),messenger:this.messagingSystem,provider:f,transactionMeta:m}),this.updateTransaction(m,`Update Editable Params for ${e}`),tt(this,s,"m",ae).call(this,e)}setTransactionActive(e,t){if(!tt(this,s,"m",ae).call(this,e))throw new Error(`Transaction with id ${e} not found`);tt(this,s,"m",Ge).call(this,{transactionId:e,note:"TransactionController#setTransactionActive - Transaction isActive updated",skipHistory:!0,skipValidation:!0,skipResimulateCheck:!0},(e=>{e.isActive=t}))}async approveTransactionsWithSameNonce(e=[],{hasNonce:t}={}){if((0,_t.projectLogger)("Approving transactions with same nonce",{transactions:e}),0===e.length)return"";const n=e[0],{chainId:a}=n,r=tt(this,s,"m",ue).call(this,{chainId:a}),i=(0,Ut.prepareTransaction)(a,n),c=(0,Ut.serializeTransaction)(i);if(tt(this,o,"f").has(c))return"";let u,l;tt(this,o,"f").add(c);try{const a=n.from;l=!0!==t?await this.getNonceLock(a,r):undefined;const i=l?(0,ut.add0x)(l.nextNonce.toString(16)):n.nonce;l&&(0,_t.projectLogger)("Using nonce from nonce tracker",i,l.nonceDetails),u=await Promise.all(e.map((e=>(e.nonce=i,tt(this,s,"m",W).call(this,e.chainId,e)))))}catch(e){throw(0,_t.projectLogger)("Error while signing transactions with same nonce",e),e}finally{l?.releaseLock(),tt(this,o,"f").delete(c)}return u}updateCustodialTransaction(e){const{transactionId:t,errorMessage:n,hash:a,status:r,gasLimit:i,gasPrice:o,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,type:d}=e,p=tt(this,s,"m",ae).call(this,t);if(!p)throw new Error("Cannot update custodial transaction as no transaction metadata found");if(r&&![Ct.TransactionStatus.submitted,Ct.TransactionStatus.signed,Ct.TransactionStatus.failed].includes(r))throw new Error(`Cannot update custodial transaction with status: ${r}`);const m=(0,dt.merge)({},p,(0,dt.pickBy)({hash:a,status:r}));return m.status===Ct.TransactionStatus.submitted&&(m.submittedTime=(new Date).getTime()),m.status===Ct.TransactionStatus.failed&&(m.error=(0,Wt.normalizeTxError)(new Error(n))),m.txParams=(0,dt.merge)({},m.txParams,(0,dt.pickBy)({gasLimit:i,gasPrice:o,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,type:d})),d===Ct.TransactionEnvelopeType.legacy&&(delete m.txParams.maxFeePerGas,delete m.txParams.maxPriorityFeePerGas),this.updateTransaction(m,`${Vt}:updateCustodialTransaction - Custodial transaction updated`),r&&[Ct.TransactionStatus.submitted,Ct.TransactionStatus.failed].includes(r)&&(this.messagingSystem.publish(`${Vt}:transactionFinished`,m),tt(this,w,"f").emit(`${m.id}:finished`,m)),m}getTransactions({initialList:e,limit:t,searchCriteria:n={}}={}){const s=(0,dt.mapValues)(n,(e=>"function"==typeof e?e:t=>t===e)),a=e??this.state.transactions,r=(0,dt.sortBy)((0,dt.pickBy)(a,(e=>{for(const[t,n]of Object.entries(s))if(t in e.txParams){if(!1===n(e.txParams[t]))return!1}else if(!1===n(e[t]))return!1;return!0})),"time");if(t!==undefined){const e=new Set,n=[];for(let s=r.length-1;s>-1;s--){const a=r[s],{nonce:i}=a.txParams;if(!e.has(i)){if(!(e.size<t))continue;e.add(i)}n.unshift(a)}return n}return r}async estimateGasFee({transactionParams:e,chainId:t,networkClientId:n}){const{id:s,provider:a}=tt(this,O,"f").getNetworkClient({chainId:t,networkClientId:n}),r={txParams:e,chainId:t,networkClientId:s},i=(0,Lt.getGasFeeFlow)(r,tt(this,d,"f"),this.messagingSystem),o=new rt.default(a),c=await tt(this,g,"f").call(this,{networkClientId:s});return i.getGasFees({ethQuery:o,gasFeeControllerData:c,messenger:this.messagingSystem,transactionMeta:r})}async getLayer1GasFee({transactionParams:e,chainId:t,networkClientId:n}){const a=tt(this,s,"m",de).call(this,{chainId:t,networkClientId:n});return await(0,Dt.getTransactionLayer1GasFee)({layer1GasFeeFlows:tt(this,A,"f"),messenger:this.messagingSystem,provider:a,transactionMeta:{txParams:e,chainId:t}})}clearUnapprovedTransactions(){const e=this.state.transactions.filter((({status:e})=>e!==Ct.TransactionStatus.unapproved));this.update((t=>{t.transactions=tt(this,s,"m",ee).call(this,e)}))}abortTransactionSigning(e){if(!tt(this,s,"m",ae).call(this,e))throw new Error("Cannot abort signing as no transaction metadata found");const t=tt(this,D,"f").get(e);if(!t)throw new Error("Cannot abort signing as transaction is not waiting for signing");t(),tt(this,D,"f").delete(e)}async updateAtomicBatchData({transactionId:e,transactionIndex:t,transactionData:n}){(0,_t.projectLogger)("Updating atomic batch data",{transactionId:e,transactionIndex:t,transactionData:n});const a=tt(this,s,"m",Ge).call(this,{transactionId:e,note:"TransactionController#updateAtomicBatchData - Atomic batch data updated"},(e=>{const{nestedTransactions:s,txParams:a}=e,r=a.from,i=s?.[t];if(!i)throw new Error(`Nested transaction not found with index - ${t}`);i.data=n;const o=(0,Ot.generateEIP7702BatchTransaction)(r,s);e.txParams.data=o.data})),r=(0,dt.cloneDeep)({...a,txParams:{...a.txParams,gas:undefined}});return await tt(this,s,"m",ze).call(this,r),tt(this,s,"m",Ge).call(this,{transactionId:e,note:"TransactionController#updateAtomicBatchData - Gas estimate updated"},(e=>{e.txParams.gas=r.txParams.gas,e.simulationFails=r.simulationFails,e.gasLimitNoBuffer=r.gasLimitNoBuffer})),a.txParams.data}updateBatchTransactions({transactionId:e,batchTransactions:t}){(0,_t.projectLogger)("Updating batch transactions",{transactionId:e,batchTransactions:t}),tt(this,s,"m",Ge).call(this,{transactionId:e,note:"TransactionController#updateBatchTransactions - Batch transactions updated"},(e=>{e.batchTransactions=t}))}updateSelectedGasFeeToken(e,t){tt(this,s,"m",Ge).call(this,{transactionId:e},(e=>{const n=e.gasFeeTokens?.some((e=>e.tokenAddress.toLowerCase()===t?.toLowerCase()));if(t&&!n)throw new Error(`No matching gas fee token found with address - ${t}`);e.selectedGasFeeToken=t}))}}n.TransactionController=Xt,a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,m=new WeakMap,h=new WeakMap,f=new WeakMap,g=new WeakMap,b=new WeakMap,y=new WeakMap,S=new WeakMap,k=new WeakMap,T=new WeakMap,w=new WeakMap,v=new WeakMap,E=new WeakMap,j=new WeakMap,P=new WeakMap,I=new WeakMap,_=new WeakMap,C=new WeakMap,A=new WeakMap,x=new WeakMap,O=new WeakMap,R=new WeakMap,F=new WeakMap,M=new WeakMap,N=new WeakMap,L=new WeakMap,G=new WeakMap,D=new WeakMap,B=new WeakMap,U=new WeakMap,H=new WeakMap,$=new WeakMap,_e=new WeakMap,s=new WeakSet,K=async function({actionId:e,afterSubmit:t,estimatedBaseFee:n,gasValues:a,label:r,prepareTransactionParams:i,rate:o,transactionId:c,transactionType:u}){if(tt(this,s,"m",be).call(this,e))return;a&&(a=(0,Wt.normalizeGasFeeValues)(a),(0,Wt.validateGasValues)(a)),(0,_t.projectLogger)(`Creating ${r} transaction`,c,a);const l=tt(this,s,"m",ae).call(this,c);if(!l)return;if(!tt(this,G,"f"))throw new Error("No sign method defined.");const d=(0,Ht.getTransactionParamsWithIncreasedGasFee)(l.txParams,o,a);i?.(d);const p=(0,Ut.prepareTransaction)(l.chainId,d),m=await tt(this,G,"f").call(this,p,l.txParams.from),h=tt(this,s,"m",Se).call(this,l,m),f=(0,Ut.serializeTransaction)(m),g=d.maxFeePerGas??d.gasPrice,b=d.maxFeePerGas?h.txParams.maxFeePerGas:h.txParams.gasPrice;(0,_t.projectLogger)(`Submitting ${r} transaction`,{oldFee:b,newFee:g,txParams:d});const{networkClientId:y}=l,S=tt(this,s,"m",le).call(this,{networkClientId:y}),k={...h,actionId:e,estimatedBaseFee:n,id:(0,pt.v1)(),originalGasEstimate:l.txParams.gas,originalType:l.type,rawTx:f,time:Date.now(),txParams:d,type:u},T=await tt(this,s,"m",Fe).call(this,S,{...k,origin:r});k.hash=T,tt(this,s,"m",q).call(this,k),this.messagingSystem.publish(`${Vt}:transactionApproved`,{transactionMeta:k,actionId:e}),this.messagingSystem.publish(`${Vt}:transactionSubmitted`,{transactionMeta:k,actionId:e}),t?.(k)},W=async function(e,t){if(!tt(this,G,"f"))throw new Error("No sign method defined.");const n=(0,Wt.normalizeTransactionParams)(t),s=(0,Wt.isEIP1559Transaction)(n)?Ct.TransactionEnvelopeType.feeMarket:Ct.TransactionEnvelopeType.legacy,a={...n,type:s,gasLimit:n.gas,chainId:e},{from:r}=a,i=(0,Ut.prepareTransaction)(e,a),o=await tt(this,G,"f").call(this,i,r);return(0,Ut.serializeTransaction)(o)},q=function(e){(0,qt.validateTxParams)(e.txParams),this.update((t=>{t.transactions=tt(this,s,"m",ee).call(this,[...t.transactions,e])}))},z=async function(e,{traceContext:t}={}){const n=e.txParams.type!==Ct.TransactionEnvelopeType.legacy&&await tt(this,s,"m",ke).call(this,e.networkClientId),{networkClientId:a}=e,r=tt(this,s,"m",le).call(this,{networkClientId:a}),i=tt(this,s,"m",de).call(this,{networkClientId:a});await tt(this,H,"f").call(this,{name:"Update Gas",parentContext:t},(async()=>{await tt(this,s,"m",ze).call(this,e)})),await tt(this,H,"f").call(this,{name:"Update Gas Fees",parentContext:t},(async()=>await(0,Nt.updateGasFees)({eip1559:n,ethQuery:r,gasFeeFlows:tt(this,d,"f"),getGasFeeEstimates:tt(this,g,"f"),getSavedGasFees:tt(this,S,"f").bind(this),messenger:this.messagingSystem,txMeta:e}))),await tt(this,H,"f").call(this,{name:"Update Layer 1 Gas Fees",parentContext:t},(async()=>await(0,Dt.updateTransactionLayer1GasFee)({layer1GasFeeFlows:tt(this,A,"f"),messenger:this.messagingSystem,provider:i,transactionMeta:e})))},V=function(){this.clearUnapprovedTransactions(),tt(this,s,"m",J).call(this)},J=function(){const e=this.state.transactions.filter((e=>[Ct.TransactionStatus.approved,Ct.TransactionStatus.signed].includes(e.status)));for(const t of e)tt(this,s,"m",Qe).call(this,t,new Error("Transaction incomplete at startup"))},X=async function(e,{actionId:t,isExisting:n=!1,publishHook:a,requireApproval:r,shouldShowRequest:i=!0,traceContext:o}){const c=e.id;let u;const{meta:l,isCompleted:d}=tt(this,s,"m",oe).call(this,c),p=d?Promise.resolve(l):tt(this,s,"m",ye).call(this,c);if(l&&!n&&!d)try{if(!1!==r){const t=await tt(this,H,"f").call(this,{name:"Await Approval",parentContext:o},(t=>tt(this,s,"m",se).call(this,e,{shouldShowRequest:i,traceContext:t})));u=t.resultCallbacks;const n=t.value,a=n?.txMeta;a&&((0,_t.projectLogger)("Updating transaction with approval data",{customNonce:a.customNonceValue,params:a.txParams}),this.updateTransaction(a,"TransactionController#processApproval - Updated with approval data"))}const{isCompleted:n}=tt(this,s,"m",oe).call(this,c);if(!n){await tt(this,s,"m",Y).call(this,c,o,a)===Jt.SkippedViaBeforePublishHook&&u&&u.success();const e=tt(this,s,"m",ae).call(this,c);this.messagingSystem.publish(`${Vt}:transactionApproved`,{transactionMeta:e,actionId:t})}}catch(e){const n=e,{isCompleted:a}=tt(this,s,"m",oe).call(this,c);a||(tt(this,s,"m",Xe).call(this,n)?tt(this,s,"m",Ye).call(this,c,t,n):tt(this,s,"m",Qe).call(this,l,n,t))}finally{tt(this,B,"f").delete(c)}const m=await p;switch(m?.status){case Ct.TransactionStatus.failed:const e=m.error;throw u?.error(e),ct.rpcErrors.internal(e.message);case Ct.TransactionStatus.submitted:return u?.success(),m.hash;default:const t=ct.rpcErrors.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(m||c)}`);throw u?.error(t),t}},Y=async function(e,t,n){let a,r,i=tt(this,s,"m",re).call(this,e);(0,_t.projectLogger)("Approving transaction",i);try{if(!tt(this,G,"f"))return tt(this,s,"m",Qe).call(this,i,new Error("No sign method defined.")),Jt.NotApproved;if(!i.chainId)return tt(this,s,"m",Qe).call(this,i,new Error("No chainId defined.")),Jt.NotApproved;if(tt(this,o,"f").has(e))return(0,_t.projectLogger)("Skipping approval as signing in progress",e),Jt.NotApproved;tt(this,o,"f").add(e),a=()=>tt(this,o,"f").delete(e);const[c,l]=await(0,Bt.getNextNonce)(i,(e=>tt(this,O,"f").getNonceLock(e,i.networkClientId)));r=l,i=tt(this,s,"m",Ge).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction approved"},(e=>{const{chainId:t,txParams:n}=e,{gas:s,type:a}=n;e.status=Ct.TransactionStatus.approved,e.txParams.chainId=t,e.txParams.gasLimit=s,e.txParams.nonce=c,!a&&(0,Wt.isEIP1559Transaction)(n)&&(e.txParams.type=Ct.TransactionEnvelopeType.feeMarket)})),tt(this,s,"m",we).call(this,i);const d=await tt(this,H,"f").call(this,{name:"Sign",parentContext:t},(()=>tt(this,s,"m",Te).call(this,i)));if(!await tt(this,u,"f").call(this,i))return(0,_t.projectLogger)("Skipping publishing transaction based on hook"),this.messagingSystem.publish(`${Vt}:transactionPublishingSkipped`,i),Jt.SkippedViaBeforePublishHook;if(!d&&!i.isExternalSign)return Jt.NotApproved;const{networkClientId:p}=i,m=tt(this,s,"m",le).call(this,{networkClientId:p});let h;const f=i.type===Ct.TransactionType.swap;let g;if(f&&((0,_t.projectLogger)("Determining pre-transaction balance"),h=await(0,at.query)(m,"getBalance",[i.txParams.from])),(0,_t.projectLogger)("Publishing transaction",i.txParams),r?.(),r=undefined,i.batchTransactions?.length){(0,_t.projectLogger)("Found batch transactions",i.batchTransactions);const e=new It.ExtraTransactionsPublishHook({addTransactionBatch:this.addTransactionBatch.bind(this),transactions:i.batchTransactions});n=e.getHook()}return await tt(this,H,"f").call(this,{name:"Publish",parentContext:t},(async()=>{const e=n??tt(this,M,"f");({transactionHash:g}=await e(i,d??"0x")),g===undefined&&(g=await tt(this,s,"m",Q).call(this,m,{...i,rawTx:d}))})),(0,_t.projectLogger)("Publish successful",g),i=tt(this,s,"m",Ge).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction submitted"},(e=>{e.hash=g,e.status=Ct.TransactionStatus.submitted,e.submittedTime=(new Date).getTime(),f&&(e.preTxBalance=h,(0,_t.projectLogger)("Updated pre-transaction balance",h))})),this.messagingSystem.publish(`${Vt}:transactionSubmitted`,{transactionMeta:i}),this.messagingSystem.publish(`${Vt}:transactionFinished`,i),tt(this,w,"f").emit(`${e}:finished`,i),tt(this,s,"m",we).call(this,i),Jt.Approved}catch(e){return tt(this,s,"m",Qe).call(this,i,e),Jt.NotApproved}finally{a?.(),r?.()}},Q=async function(e,t,{skipSubmitHistory:n}={}){const a=await(0,at.query)(e,"sendRawTransaction",[t.rawTx]);return!0!==n&&tt(this,s,"m",qe).call(this,t,a),a},Z=function(e,t,n){const a=tt(this,s,"m",ae).call(this,e);if(!a)return;tt(this,s,"m",Je).call(this,e);const r={...a,status:Ct.TransactionStatus.rejected,error:(0,Wt.normalizeTxError)(n??ct.providerErrors.userRejectedRequest())};this.messagingSystem.publish(`${Vt}:transactionFinished`,r),tt(this,w,"f").emit(`${a.id}:finished`,r),this.messagingSystem.publish(`${Vt}:transactionRejected`,{transactionMeta:r,actionId:t}),tt(this,s,"m",we).call(this,r)},ee=function(e){const t=new Set,n=[...e].sort(((e,t)=>e.time>t.time?-1:1)).filter((e=>{const{chainId:n,status:a,txParams:r,time:i}=e;if(r){const e=`${String(r.nonce)}-${(0,at.convertHexToDecimal)(n)}-${new Date(i).toDateString()}`;if(t.has(e))return!0;if(t.size<tt(this,$,"f")||!tt(this,s,"m",te).call(this,a))return t.add(e),!0}return!1}));return n.reverse(),n},te=function(e){return e===Ct.TransactionStatus.rejected||e===Ct.TransactionStatus.confirmed||e===Ct.TransactionStatus.failed},ne=function(e){return[Ct.TransactionStatus.confirmed,Ct.TransactionStatus.failed,Ct.TransactionStatus.rejected,Ct.TransactionStatus.submitted].includes(e)},se=async function(e,{shouldShowRequest:t,traceContext:n}){const a=tt(this,s,"m",ie).call(this,e),{origin:r}=e,i=at.ApprovalType.Transaction,o={txId:e.id};return await tt(this,H,"f").call(this,{name:"Notification Display",id:a,parentContext:n}),await this.messagingSystem.call("ApprovalController:addRequest",{id:a,origin:r||at.ORIGIN_METAMASK,type:i,requestData:o,expectsResult:!0},t)},ae=function(e){const{transactions:t}=this.state;return t.find((({id:t})=>t===e))},re=function(e,t="TransactionController"){const n=tt(this,s,"m",ae).call(this,e);if(!n)throw new Error(`${t}: No transaction found with id ${e}`);return n},ie=function(e){return String(e.id)},oe=function(e){const t=tt(this,s,"m",ae).call(this,e);if(!t)return{meta:undefined,isCompleted:!1};return{meta:t,isCompleted:tt(this,s,"m",ne).call(this,t.status)}},ce=function(e){return tt(this,O,"f").getNetworkClient({networkClientId:e}).configuration.chainId},ue=function({chainId:e,networkClientId:t}){return t||tt(this,O,"f").getNetworkClient({chainId:e}).id},le=function({chainId:e,networkClientId:t}){return new rt.default(tt(this,s,"m",de).call(this,{chainId:e,networkClientId:t}))},de=function({chainId:e,networkClientId:t}){return tt(this,O,"f").getNetworkClient({chainId:e,networkClientId:t}).provider},pe=function(e){if(!e.length)return;const t=[];for(const n of e){const{chainId:e}=n;try{const a=tt(this,s,"m",ue).call(this,{chainId:e});t.push({...n,networkClientId:a})}catch(t){(0,_t.projectLogger)("Failed to get network client ID for incoming transaction",{chainId:e,error:t})}}this.update((e=>{const{transactions:n}=e;e.transactions=tt(this,s,"m",ee).call(this,[...t,...n]),(0,_t.projectLogger)("Added incoming transactions to state",t.length,t)})),this.messagingSystem.publish(`${Vt}:incomingTransactionsReceived`,t)},me=function(e,t){if(!t||t===at.ORIGIN_METAMASK)return undefined;const{gasPrice:n,maxFeePerGas:s,maxPriorityFeePerGas:a,gas:r}=e;if(n===undefined&&s===undefined&&a===undefined&&r===undefined)return undefined;const i={};return n!==undefined?i.gasPrice=n:s===undefined&&a===undefined||(i.maxFeePerGas=s,i.maxPriorityFeePerGas=a),r!==undefined&&(i.gas=r),i},he=function(e){const{chainId:t}=e,{transactions:n}=this.state,a=e?.txParams?.from,r=n.filter((e=>e.txParams.from===a&&e.chainId===t)),i=r.filter((e=>e.status===Ct.TransactionStatus.confirmed)),o=r.filter((e=>e.status===Ct.TransactionStatus.submitted));(0,Rt.validateConfirmedExternalTransaction)(e,i,o);const c=0!==(e.history??[]).length||tt(this,P,"f")?e:(0,Gt.addInitialHistorySnapshot)(e);return this.update((e=>{e.transactions=tt(this,s,"m",ee).call(this,[...e.transactions,c])})),c},fe=function(e){const t=tt(this,s,"m",ae).call(this,e);if(!t)return;const n=t.txParams?.nonce,a=t.txParams?.from,{chainId:r}=t,i=this.state.transactions.filter((t=>t.id!==e&&t.txParams.from===a&&n&&t.txParams.nonce===n&&t.chainId===r&&t.type!==Ct.TransactionType.incoming)),o=i.map((e=>e.id));if(0!==i.length){this.update((e=>{for(const n of e.transactions)o.includes(n.id)&&(n.replacedBy=t?.hash,n.replacedById=t?.id)}));for(const e of this.state.transactions)o.includes(e.id)&&e.status!==Ct.TransactionStatus.failed&&tt(this,s,"m",ge).call(this,e)}},ge=function(e){const t={...e,status:Ct.TransactionStatus.dropped};this.messagingSystem.publish(`${Vt}:transactionDropped`,{transactionMeta:t}),this.updateTransaction(t,"TransactionController#setTransactionStatusDropped - Transaction dropped"),tt(this,s,"m",we).call(this,t)},be=function(e){return this.state.transactions.find((t=>e&&t.actionId===e))},ye=async function(e){return new Promise((t=>{tt(this,w,"f").once(`${e}:finished`,(e=>{t(e)}))}))},Se=function(e,t){const n=(0,dt.cloneDeep)(e);for(const e of["r","s","v"]){const s=t[e];s!==undefined&&null!==s&&(n[e]=(0,ut.add0x)(s.toString(16)))}return n},ke=async function(e){const t=await tt(this,h,"f").call(this,e),n=await tt(this,m,"f").call(this);return t&&n},Te=async function(e){const{chainId:t,id:n,isExternalSign:a,txParams:i}=e;if(a)return(0,_t.projectLogger)("Skipping sign as signed externally"),undefined;const{authorizationList:c,from:u}=i,d=await(0,Ot.signAuthorizationList)({authorizationList:c,messenger:this.messagingSystem,transactionMeta:e});d&&tt(this,s,"m",Ge).call(this,{transactionId:n},(e=>{e.txParams.authorizationList=d})),(0,_t.projectLogger)("Calling before sign hook",e);const{updateTransaction:m}=await tt(this,l,"f").call(this,{transactionMeta:e})??{};m&&(tt(this,s,"m",Ge).call(this,{transactionId:n,skipResimulateCheck:!0,note:"beforeSign Hook"},m),(0,_t.projectLogger)("Updated transaction after before sign hook"));const h=tt(this,s,"m",re).call(this,n),{txParams:f}=h,g=(0,Ut.prepareTransaction)(t,f);tt(this,o,"f").add(n),(0,_t.projectLogger)("Signing transaction",f);const b=await new Promise(((e,t)=>{tt(this,G,"f")?.call(this,g,u,...tt(this,p,"f").call(this,h)).then(e,t),tt(this,D,"f").set(n,(()=>t(new Error("Signing aborted by user"))))}));if(tt(this,D,"f").delete(n),!b)return(0,_t.projectLogger)("Skipping signed status as no signed transaction"),undefined;const y=(0,dt.cloneDeep)(h);if(!tt(this,r,"f").call(this,y,b))return this.updateTransaction(y,"TransactionController#signTransaction - Update after sign"),(0,_t.projectLogger)("Skipping signed status based on hook"),undefined;const S={...tt(this,s,"m",Se).call(this,y,b),status:Ct.TransactionStatus.signed,txParams:f};this.updateTransaction(S,"TransactionController#approveTransaction - Transaction signed"),tt(this,s,"m",we).call(this,S);const k=(0,Ut.serializeTransaction)(b),T=(0,dt.merge)({},S,{rawTx:k});return this.updateTransaction(T,"TransactionController#approveTransaction - RawTransaction added"),k},we=function(e){this.messagingSystem.publish(`${Vt}:transactionStatusUpdated`,{transactionMeta:e})},ve=function(e,t,n){return(0,Bt.getAndFormatTransactionsForNonceTracker)(n,t,e,this.state.transactions)},Ee=function(e){(0,_t.projectLogger)("Processing confirmed transaction",e.id),tt(this,s,"m",fe).call(this,e.id),this.messagingSystem.publish(`${Vt}:transactionConfirmed`,e),tt(this,s,"m",we).call(this,e),tt(this,s,"m",je).call(this,e).catch((e=>{throw(0,_t.projectLogger)("Error while updating post balance",e),e}))},je=async function(e){try{const{networkClientId:t,type:n}=e;if(n!==Ct.TransactionType.swap)return;const a=tt(this,s,"m",le).call(this,{networkClientId:t}),{updatedTransactionMeta:r,approvalTransactionMeta:i}=await(0,$t.updatePostTransactionBalance)(e,{ethQuery:a,getTransaction:tt(this,s,"m",ae).bind(this),updateTransaction:this.updateTransaction.bind(this)});this.messagingSystem.publish(`${Vt}:postTransactionBalanceUpdated`,{transactionMeta:r,approvalTransactionMeta:i})}catch(e){(0,_t.projectLogger)("Error while updating post transaction balance",e)}},Pe=function({provider:e,blockTracker:t,chainId:n}){return new ot.NonceTracker({provider:e,blockTracker:t,getPendingTransactions:tt(this,s,"m",Re).bind(this,n),getConfirmedTransactions:tt(this,s,"m",ve).bind(this,[Ct.TransactionStatus.confirmed],n)})},Ie=function({provider:e,blockTracker:t,chainId:n,networkClientId:a}){const r=new rt.default(e),i=new jt.PendingTransactionTracker({blockTracker:t,getChainId:()=>n,getEthQuery:()=>r,getNetworkClientId:()=>a,getTransactions:()=>this.state.transactions,isResubmitEnabled:tt(this,R,"f").isResubmitEnabled,getGlobalLock:()=>tt(this,O,"f").acquireNonceLockForChainIdKey({chainId:n}),messenger:this.messagingSystem,publishTransaction:(e,t)=>tt(this,s,"m",Q).call(this,e,t,{skipSubmitHistory:!0}),hooks:{beforeCheckPendingTransaction:tt(this,c,"f").bind(this)}});return tt(this,s,"m",Oe).call(this,i),i},Ce=function(){tt(this,O,"f").stopAllTracking()},Ae=function(e){e.hub.on("transactions",tt(this,s,"m",pe).bind(this))},xe=function(e){e.hub.removeAllListeners("transaction-confirmed"),e.hub.removeAllListeners("transaction-dropped"),e.hub.removeAllListeners("transaction-failed"),e.hub.removeAllListeners("transaction-updated")},Oe=function(e){e.hub.on("transaction-confirmed",tt(this,s,"m",Ee).bind(this)),e.hub.on("transaction-dropped",tt(this,s,"m",ge).bind(this)),e.hub.on("transaction-failed",tt(this,s,"m",Qe).bind(this)),e.hub.on("transaction-updated",this.updateTransaction.bind(this))},Re=function(e,t){return[...tt(this,s,"m",ve).call(this,[Ct.TransactionStatus.approved,Ct.TransactionStatus.signed,Ct.TransactionStatus.submitted],t,e),...tt(this,f,"f").call(this,t,e)]},Fe=async function(e,t){try{return await tt(this,s,"m",Q).call(this,e,t)}catch(e){if(tt(this,s,"m",Me).call(this,e))throw new Error("Previous transaction is already confirmed");throw e}},Me=function(e){return e?.message?.includes("nonce too low")||e?.data?.message?.includes("nonce too low")},Ne=function(){return tt(this,U,"f")?[new St.TestGasFeeFlow]:[new bt.RandomisedEstimationsGasFeeFlow,new ft.LineaGasFeeFlow,new ht.DefaultGasFeeFlow]},Le=function(){return[new gt.OptimismLayer1GasFeeFlow,new yt.ScrollLayer1GasFeeFlow]},Ge=function({transactionId:e,note:t,skipHistory:n,skipValidation:a,skipResimulateCheck:r},i){let o;this.update((s=>{const c=s.transactions.findIndex((({id:t})=>t===e));if(-1===c)throw new Error(`Cannot update transaction as ID not found - ${e}`);let u=s.transactions[c];const l=(0,dt.cloneDeep)(u);u=i(u)??u,!0!==a&&(u.txParams=(0,Wt.normalizeTransactionParams)(u.txParams),(0,qt.validateTxParams)(u.txParams)),!r&&tt(this,_,"f").call(this)&&(o=(0,Pt.shouldResimulate)(l,u));tt(this,P,"f")||n||(u=(0,Gt.updateTransactionHistory)(u,t??"Transaction updated")),s.transactions[c]=u}));const c=tt(this,s,"m",ae).call(this,e);return o?.resimulate&&tt(this,s,"m",Be).call(this,c,{blockTime:o.blockTime}).catch((e=>{throw(0,_t.projectLogger)("Error during re-simulation",e),e})),c},De=async function(e,{traceContext:t}={}){if(!tt(this,j,"f").call(this))return;const{chainId:n,id:a,txParams:{to:r,from:i}}=e,o={chainId:(0,ut.hexToNumber)(n),to:r,from:i};(0,qt.validateParamTo)(r);if(!this.state.transactions.find((e=>e.chainId===n&&e.txParams.from===i&&e.txParams.to===r&&e.id!==a)))try{const{count:e}=await tt(this,H,"f").call(this,{name:"Account Address Relationship",parentContext:t},(()=>(0,mt.getAccountAddressRelationship)(o))),n=e===undefined?undefined:0===e;if(!tt(this,s,"m",ae).call(this,a))return void(0,_t.projectLogger)("Cannot update first time interaction as transaction not found",a);tt(this,s,"m",Ge).call(this,{transactionId:a,note:"TransactionController#updateFirstInteraction - Update first time interaction"},(e=>{e.isFirstTimeInteraction=n})),(0,_t.projectLogger)("Updated first time interaction",a,{isFirstTimeInteraction:n})}catch(e){(0,_t.projectLogger)("Error fetching account address relationship, skipping first time interaction update",e)}},Be=async function(e,{blockTime:t,traceContext:n}={}){const{chainId:a,id:r,nestedTransactions:i,networkClientId:o,simulationData:c,txParams:u}=e;let l={error:{code:Ct.SimulationErrorCode.Disabled,message:"Simulation disabled"},tokenBalanceChanges:[]},d=[];const p=tt(this,B,"f").has(r);tt(this,_,"f").call(this)&&!p&&(l=await tt(this,H,"f").call(this,{name:"Simulate",parentContext:n},(()=>(0,At.getBalanceChanges)({blockTime:t,chainId:a,ethQuery:tt(this,s,"m",le).call(this,{networkClientId:o}),nestedTransactions:i,txParams:u}))),t&&c&&(0,Pt.hasSimulationDataChanged)(c,l)&&(l={...l,isUpdatedAfterSecurityCheck:!0}),d=await(0,Mt.getGasFeeTokens)({chainId:a,isEIP7702GasFeeTokensEnabled:tt(this,E,"f"),messenger:this.messagingSystem,publicKeyEIP7702:tt(this,F,"f"),transactionMeta:e}));if(!tt(this,s,"m",ae).call(this,r))return void(0,_t.projectLogger)("Cannot update simulation data as transaction not found",r,l);const m=tt(this,s,"m",Ge).call(this,{transactionId:r,note:"TransactionController#updateSimulationData - Update simulation data",skipResimulateCheck:Boolean(t)},(e=>{e.gasFeeTokens=d,p||(e.simulationData=l)}));(0,_t.projectLogger)("Updated simulation data",r,m),await tt(this,s,"m",Ze).call(this,m)},Ue=function({transactionId:e,gasFeeEstimates:t,gasFeeEstimatesLoaded:n,layer1GasFee:a}){tt(this,s,"m",Ge).call(this,{transactionId:e,skipHistory:!0},(e=>{(0,Tt.updateTransactionGasProperties)({txMeta:e,gasFeeEstimates:t,gasFeeEstimatesLoaded:n,isTxParamsGasFeeUpdatesEnabled:tt(this,v,"f"),layer1GasFee:a})}))},He=function({transactionBatchId:e,gasFeeEstimates:t}){tt(this,s,"m",$e).call(this,e,(e=>({...e,gasFeeEstimates:t})))},$e=function(e,t){this.update((n=>{const s=n.transactionBatches.findIndex((t=>t.id===e));if(-1===s)throw new Error(`Cannot update batch, ID not found - ${e}`);const a=n.transactionBatches[s],r=t(a);n.transactionBatches[s]=r??a}))},Ke=function(){return this.messagingSystem.call("AccountsController:getSelectedAccount")},We=function(){const e=this.messagingSystem.call("AccountsController:getState");return Object.values(e.internalAccounts?.accounts??{}).filter((e=>"eip155:eoa"===e.type)).map((e=>e.address))},qe=function(e,t){const{chainId:n,networkClientId:s,origin:a,rawTx:r,txParams:i}=e,{networkConfigurationsByChainId:o}=tt(this,b,"f").call(this),c=o[n],u=c?.rpcEndpoints.find((e=>e.networkClientId===s)),l=u?.url,d={chainId:n,hash:t,networkType:u?.name??s,networkUrl:l,origin:a,rawTransaction:r,time:Date.now(),transaction:i};(0,_t.projectLogger)("Updating submit history",d),this.update((e=>{const{submitHistory:t}=e;100===t.length&&t.pop(),t.unshift(d)}))},ze=async function(e){const{chainId:t,networkClientId:n}=e,a=tt(this,O,"f").getNetworkClient({networkClientId:n}).configuration.type===it.NetworkClientType.Custom,r=tt(this,s,"m",le).call(this,{networkClientId:n});await(0,Ft.updateGas)({chainId:t,ethQuery:r,isCustomNetwork:a,isSimulationEnabled:tt(this,_,"f").call(this),messenger:this.messagingSystem,txMeta:e})},Ve=function(){this.messagingSystem.registerActionHandler(`${Vt}:estimateGas`,this.estimateGas.bind(this)),this.messagingSystem.registerActionHandler(`${Vt}:updateCustodialTransaction`,this.updateCustodialTransaction.bind(this))},Je=function(e){this.update((t=>{const n=t.transactions.filter((({id:t})=>t!==e));t.transactions=tt(this,s,"m",ee).call(this,n)}))},Xe=function(e){return[ct.errorCodes.provider.userRejectedRequest,qt.ErrorCode.RejectedUpgrade].includes(e.code)},Ye=function(e,t,n){if(tt(this,s,"m",Z).call(this,e,t,n),n.code===ct.errorCodes.provider.userRejectedRequest)throw ct.providerErrors.userRejectedRequest({message:"MetaMask Tx Signature: User denied transaction signature.",data:n?.data});throw n},Qe=function(e,t,n){let a;try{a=tt(this,s,"m",Ge).call(this,{transactionId:e.id,note:"TransactionController#failTransaction - Add error message and set status to failed",skipValidation:!0},(e=>{e.status=Ct.TransactionStatus.failed,e.error=(0,Wt.normalizeTxError)(t)}))}catch(n){(0,_t.projectLogger)("Failed to mark transaction as failed",n),a={...e,status:Ct.TransactionStatus.failed,error:(0,Wt.normalizeTxError)(t)}}this.messagingSystem.publish(`${Vt}:transactionFailed`,{actionId:n,error:t.message,transactionMeta:a}),tt(this,s,"m",we).call(this,a),this.messagingSystem.publish(`${Vt}:transactionFinished`,a),tt(this,w,"f").emit(`${e.id}:finished`,a)},Ze=async function(e){(0,_t.projectLogger)("Calling afterSimulate hook",e);const{id:t}=e,n=await tt(this,i,"f").call(this,{transactionMeta:e}),{skipSimulation:a,updateTransaction:r}=n||{};if(a?tt(this,B,"f").add(t):!1===a&&tt(this,B,"f").delete(t),!r)return;const o=tt(this,s,"m",Ge).call(this,{transactionId:t,skipResimulateCheck:!0,note:"afterSimulate Hook"},(e=>{e.txParamsOriginal=(0,dt.cloneDeep)(e.txParams),r(e)}));(0,_t.projectLogger)("Updated transaction with afterSimulate data",o)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/TransactionController.cjs"}],[2903,{"../errors.cjs":2906,"../logger.cjs":2926,"@metamask/controller-utils":1559,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAccountTransactions=n.getAccountAddressRelationship=void 0;const s=e("@metamask/controller-utils"),a=e("@metamask/utils"),r=e("../errors.cjs"),i=e("../logger.cjs"),o="https://accounts.api.cx.metamask.io",c=`${o}/v1/accounts/`,u="x-metamask-clientproduct",l="metamask-transaction-controller",d=[1,10,56,137,8453,42161,59144,534352,1329],p=(0,a.createModuleLogger)(i.projectLogger,"accounts-api");n.getAccountAddressRelationship=async function(e){const{chainId:t,from:n,to:a}=e;if(!d.includes(t))throw p("Unsupported chain ID for account relationship API",t),new r.FirstTimeInteractionError("Unsupported chain ID");const i=`${o}/v1/networks/${t}/accounts/${n}/relationships/${a}`;p("Getting account address relationship",{request:e,url:i});const c={[u]:l},m=await(0,s.successfulFetch)(i,{headers:c});if(204===m.status)return{count:0};const h=await m.json();if(p("Retrieved account address relationship",h),h.error){const{code:e,message:t}=h.error;throw new r.FirstTimeInteractionError(t,e)}return h},n.getAccountTransactions=async function(e){const{address:t,chainIds:n,cursor:a,endTimestamp:r,sortDirection:i,startTimestamp:o,tags:d}=e;let m=`${c}${t}/transactions`;const h=[];if(n){const e=n.join(",");h.push(`networks=${e}`)}o&&h.push(`startTimestamp=${o}`),r&&h.push(`endTimestamp=${r}`),a&&h.push(`cursor=${a}`),i&&h.push(`sortDirection=${i}`),h.length&&(m+=`?${h.join("&")}`),p("Getting account transactions",{request:e,url:m});const f=[l,...d||[]].join("__"),g={[u]:f},b=await(0,s.successfulFetch)(m,{headers:g}),y=await b.json();return p("Retrieved account transactions",y),y}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/api/accounts-api.cjs"}],[2904,{"../constants.cjs":2905,"../errors.cjs":2906,"../logger.cjs":2926,"@metamask/controller-utils":1559,"@metamask/utils":2974,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.simulateTransactions=void 0;const s=e("@metamask/controller-utils"),a=e("@metamask/utils"),r=e("lodash"),i=e("../constants.cjs"),o=e("../errors.cjs"),c=e("../logger.cjs"),u=(0,a.createModuleLogger)(c.projectLogger,"simulation-api"),l="https://tx-sentinel-{0}.api.cx.metamask.io/",d="networks";let p=0;function m(e){return l.replace("{0}",e)}n.simulateTransactions=async function(e,t){const n=await async function(e){const t=await async function(){const e=`${m("ethereum-mainnet")}${d}`,t=await fetch(e);return t.json()}(),n=(0,s.convertHexToDecimal)(e),a=t[n];if(!a?.confirmations)throw u("Chain is not supported",e),new o.SimulationChainNotSupportedError(e);return m(a.network)}(e),a=p;p+=1;const c=function(e){const t=(0,r.cloneDeep)(e);for(const e of t.transactions){const n=e.to?.toLowerCase();i.DELEGATION_MANAGER_ADDRESSES.includes(n)&&(t.overrides=t.overrides||{},t.overrides[n]={code:i.CODE_DELEGATION_MANAGER_NO_SIGNATURE_ERRORS})}return t}(t);u("Sending request",n,t);const l=await fetch(n,{method:"POST",body:JSON.stringify({id:String(a),jsonrpc:"2.0",method:"infura_simulateTransactions",params:[c]})}),h=await l.json();if(u("Received response",h),h.error){const{code:e,message:t}=h.error;throw new o.SimulationError(t,e)}return h?.result}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/api/simulation-api.cjs"}],[2905,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CODE_DELEGATION_MANAGER_NO_SIGNATURE_ERRORS=n.DELEGATION_MANAGER_ADDRESSES=n.ABI_IERC7821=n.ABI_SIMULATION_ERC721_LEGACY=n.ABI_SIMULATION_ERC20_WRAPPED=n.CHAIN_IDS=void 0,n.CHAIN_IDS={MAINNET:"0x1",GOERLI:"0x5",BASE:"0x2105",BASE_TESTNET:"0x14a33",BSC:"0x38",BSC_TESTNET:"0x61",OPTIMISM:"0xa",OPTIMISM_TESTNET:"0x1a4",OPBNB:"0xcc",OPBNB_TESTNET:"0x15eb",OPTIMISM_SEPOLIA:"0xaa37dc",POLYGON:"0x89",POLYGON_TESTNET:"0x13881",AVALANCHE:"0xa86a",AVALANCHE_TESTNET:"0xa869",FANTOM:"0xfa",FANTOM_TESTNET:"0xfa2",SEPOLIA:"0xaa36a7",LINEA_GOERLI:"0xe704",LINEA_SEPOLIA:"0xe705",LINEA_MAINNET:"0xe708",MOONBEAM:"0x504",MOONBEAM_TESTNET:"0x507",MOONRIVER:"0x505",GNOSIS:"0x64",ARBITRUM:"0xa4b1",ZKSYNC_ERA:"0x144",ZORA:"0x76adf1",SCROLL:"0x82750",SCROLL_SEPOLIA:"0x8274f",MEGAETH_TESTNET:"0x18c6",SEI:"0x531"},n.ABI_SIMULATION_ERC20_WRAPPED=[{anonymous:!1,inputs:[{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Withdrawal",type:"event"}],n.ABI_SIMULATION_ERC721_LEGACY=[{anonymous:!1,inputs:[{indexed:!1,name:"_from",type:"address"},{indexed:!1,name:"_to",type:"address"},{indexed:!1,name:"_tokenId",type:"uint256"}],name:"Transfer",type:"event"}],n.ABI_IERC7821=[{type:"function",name:"execute",inputs:[{name:"mode",type:"bytes32",internalType:"ModeCode"},{name:"executionData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"supportsExecutionMode",inputs:[{name:"mode",type:"bytes32",internalType:"ModeCode"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"}],n.DELEGATION_MANAGER_ADDRESSES=["0xdb9b1e94b5b69df7e401ddbede43491141047db3"],n.CODE_DELEGATION_MANAGER_NO_SIGNATURE_ERRORS="0x608060405234801561001057600080fd5b506004361061012c5760003560e01c806383ebb771116100ad578063acb8cc4911610071578063acb8cc491461027f578063cef6d2091461029f578063e30c3978146102b2578063f2fde38b146102c3578063ffa1ad74146102d657600080fd5b806383ebb771146102065780638456cb591461020e57806384b0196e146102165780638da5cb5b14610231578063a3f4df7e1461024257600080fd5b806358909ebc116100f457806358909ebc146101b05780635c975abb146101d157806366134607146101e3578063715018a6146101f657806379ba5097146101fe57600080fd5b80631b13cac2146101315780632d40d0521461014d5780633ed01015146101805780633f4ba83a14610195578063499340471461019d575b600080fd5b61013a60001981565b6040519081526020015b60405180910390f35b61017061015b36600461207e565b60046020526000908152604090205460ff1681565b6040519015158152602001610144565b61019361018e366004612097565b6102fa565b005b6101936103f4565b6101936101ab366004612097565b610406565b6101b9610a1181565b6040516001600160a01b039091168152602001610144565b600154600160a01b900460ff16610170565b61013a6101f1366004612097565b6104f6565b61019361050f565b610193610521565b61013a61056a565b610193610579565b61021e610589565b6040516101449796959493929190612128565b6000546001600160a01b03166101b9565b610272604051806040016040528060118152602001702232b632b3b0ba34b7b726b0b730b3b2b960791b81525081565b60405161014491906121c1565b610272604051806040016040528060018152602001603160f81b81525081565b6101936102ad36600461221f565b6105cf565b6001546001600160a01b03166101b9565b6101936102d13660046122d4565b611829565b610272604051806040016040528060058152602001640312e332e360dc1b81525081565b61030a60408201602083016122d4565b6001600160a01b03811633146103335760405163b9f0f17160e01b815260040160405180910390fd5b600061033e836104f6565b60008181526004602052604090205490915060ff1661037057604051637952fbad60e11b815260040160405180910390fd5b6000818152600460209081526040909120805460ff19169055610395908401846122d4565b6001600160a01b03166103ae60408501602086016122d4565b6001600160a01b0316827f3feadce88fc1b49db633a56fd5307ed6ee18734df83bcc4011daa720c9cd95f1866040516103e7919061241c565b60405180910390a4505050565b6103fc61189a565b6104046118c7565b565b61041660408201602083016122d4565b6001600160a01b038116331461043f5760405163b9f0f17160e01b815260040160405180910390fd5b600061044a836104f6565b60008181526004602052604090205490915060ff161561047c57604051625ecddb60e01b815260040160405180910390fd5b6000818152600460209081526040909120805460ff191660011790556104a4908401846122d4565b6001600160a01b03166104bd60408501602086016122d4565b6001600160a01b0316827fea589ba9473ee1fe77d352c7ed919747715a5d22931b972de9b02a907c66d5dd866040516103e7919061241c565b6000610509610504836127bb565b61191c565b92915050565b61051761189a565b61040460006119b7565b60015433906001600160a01b0316811461055e5760405163118cdaa760e01b81526001600160a01b03821660048201526024015b60405180910390fd5b610567816119b7565b50565b60006105746119d0565b905090565b61058161189a565b610404611afb565b60006060806000806000606061059d611b3e565b6105a5611b6b565b60408051600080825260208201909252600f60f81b9b939a50919850469750309650945092509050565b6105d7611b98565b8481811415806105e75750808414155b1561060557604051631bcaf69f60e01b815260040160405180910390fd5b6000816001600160401b0381111561061f5761061f6124ed565b60405190808252806020026020018201604052801561065257816020015b606081526020019060019003908161063d5790505b5090506000826001600160401b0381111561066f5761066f6124ed565b6040519080825280602002602001820160405280156106a257816020015b606081526020019060019003908161068d5790505b50905060005b83811015610c195760008a8a838181106106c4576106c46127c7565b90506020028101906106d691906127dd565b8101906106e39190612823565b905080516000036107d1576040805160008082526020820190925290610765565b6107526040518060c0016040528060006001600160a01b0316815260200160006001600160a01b03168152602001600080191681526020016060815260200160008152602001606081525090565b8152602001906001900390816107045790505b50848381518110610778576107786127c7565b602090810291909101015260006040519080825280602002602001820160405280156107ae578160200160208202803683370190505b508383815181106107c1576107c16127c7565b6020026020010181905250610c10565b808483815181106107e4576107e46127c7565b6020026020010181905250600081516001600160401b0381111561080a5761080a6124ed565b604051908082528060200260200182016040528015610833578160200160208202803683370190505b50905080848481518110610849576108496127c7565b6020026020010181905250336001600160a01b031682600081518110610871576108716127c7565b6020026020010151600001516001600160a01b0316141580156108c65750610a116001600160a01b0316826000815181106108ae576108ae6127c7565b6020026020010151600001516001600160a01b031614155b156108e457604051632d618d8160e21b815260040160405180910390fd5b60005b8251811015610a4d576000838281518110610904576109046127c7565b602002602001015190506109178161191c565b838381518110610929576109296127c7565b60200260200101818152505080602001516001600160a01b03163b6000036109a657600061099e61099461095b61056a565b86868151811061096d5761096d6127c7565b602002602001015160405161190160f01b8152600281019290925260228201526042902090565b8360a00151611bc3565b905050610a44565b60006109c56109b361056a565b85858151811061096d5761096d6127c7565b9050600082602001516001600160a01b0316631626ba7e838560a001516040518363ffffffff1660e01b81526004016109ff9291906128d3565b602060405180830381865afa158015610a1c573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610a4091906128f4565b5050505b506001016108e7565b5060005b8251811015610c0d5760046000838381518110610a7057610a706127c7565b60209081029190910181015182528101919091526040016000205460ff1615610aac576040516302dd502960e11b815260040160405180910390fd5b60018351610aba9190612934565b8114610bc35781610acc826001612947565b81518110610adc57610adc6127c7565b6020026020010151838281518110610af657610af66127c7565b60200260200101516040015114610b2057604051636f6a1b8760e11b815260040160405180910390fd5b600083610b2e836001612947565b81518110610b3e57610b3e6127c7565b6020026020010151600001519050610a116001600160a01b0316816001600160a01b031614158015610b9f5750806001600160a01b0316848381518110610b8757610b876127c7565b6020026020010151602001516001600160a01b031614155b15610bbd57604051632d618d8160e21b815260040160405180910390fd5b50610c05565b60001960001b838281518110610bdb57610bdb6127c7565b60200260200101516040015114610c0557604051636f6a1b8760e11b815260040160405180910390fd5b600101610a51565b50505b506001016106a8565b5060005b83811015610e3e576000838281518110610c3957610c396127c7565b6020026020010151511115610e365760005b838281518110610c5d57610c5d6127c7565b602002602001015151811015610e34576000848381518110610c8157610c816127c7565b60200260200101518281518110610c9a57610c9a6127c7565b602002602001015160600151905060005b8151811015610e2a576000828281518110610cc857610cc86127c7565b6020026020010151600001519050806001600160a01b031663414c3e33848481518110610cf757610cf76127c7565b602002602001015160200151858581518110610d1557610d156127c7565b6020026020010151604001518f8f8a818110610d3357610d336127c7565b905060200201358e8e8b818110610d4c57610d4c6127c7565b9050602002810190610d5e91906127dd565b8c8c81518110610d7057610d706127c7565b60200260200101518b81518110610d8957610d896127c7565b60200260200101518e8d81518110610da357610da36127c7565b60200260200101518c81518110610dbc57610dbc6127c7565b602002602001015160200151336040518963ffffffff1660e01b8152600401610dec98979695949392919061295a565b600060405180830381600087803b158015610e0657600080fd5b505af1158015610e1a573d6000803e3d6000fd5b5050505050806001019050610cab565b5050600101610c4b565b505b600101610c1d565b5060005b8381101561146257828181518110610e5c57610e5c6127c7565b602002602001015151600003610f1a573363d691c964898984818110610e8457610e846127c7565b90506020020135888885818110610e9d57610e9d6127c7565b9050602002810190610eaf91906127dd565b6040518463ffffffff1660e01b8152600401610ecd939291906129c5565b6000604051808303816000875af1158015610eec573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610f1491908101906129e8565b5061145a565b60005b838281518110610f2f57610f2f6127c7565b602002602001015151811015611106576000848381518110610f5357610f536127c7565b60200260200101518281518110610f6c57610f6c6127c7565b602002602001015160600151905060005b81518110156110fc576000828281518110610f9a57610f9a6127c7565b6020026020010151600001519050806001600160a01b031663a145832a848481518110610fc957610fc96127c7565b602002602001015160200151858581518110610fe757610fe76127c7565b6020026020010151604001518f8f8a818110611005576110056127c7565b905060200201358e8e8b81811061101e5761101e6127c7565b905060200281019061103091906127dd565b8c8c81518110611042576110426127c7565b60200260200101518b8151811061105b5761105b6127c7565b60200260200101518e8d81518110611075576110756127c7565b60200260200101518c8151811061108e5761108e6127c7565b602002602001015160200151336040518963ffffffff1660e01b81526004016110be98979695949392919061295a565b600060405180830381600087803b1580156110d857600080fd5b505af11580156110ec573d6000803e3d6000fd5b5050505050806001019050610f7d565b5050600101610f1d565b50828181518110611119576111196127c7565b60200260200101516001848381518110611135576111356127c7565b6020026020010151516111489190612934565b81518110611158576111586127c7565b6020026020010151602001516001600160a01b031663d691c964898984818110611184576111846127c7565b9050602002013588888581811061119d5761119d6127c7565b90506020028101906111af91906127dd565b6040518463ffffffff1660e01b81526004016111cd939291906129c5565b6000604051808303816000875af11580156111ec573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261121491908101906129e8565b506000838281518110611229576112296127c7565b60200260200101515190505b801561145857600084838151811061124f5761124f6127c7565b60200260200101516001836112649190612934565b81518110611274576112746127c7565b60200260200101516060015190506000815190505b80156114455760008261129d600184612934565b815181106112ad576112ad6127c7565b6020026020010151600001519050806001600160a01b031663d3eddcc5846001856112d89190612934565b815181106112e8576112e86127c7565b602002602001015160200151856001866113029190612934565b81518110611312576113126127c7565b6020026020010151604001518f8f8a818110611330576113306127c7565b905060200201358e8e8b818110611349576113496127c7565b905060200281019061135b91906127dd565b8c8c8151811061136d5761136d6127c7565b602002602001015160018c6113829190612934565b81518110611392576113926127c7565b60200260200101518e8d815181106113ac576113ac6127c7565b602002602001015160018d6113c19190612934565b815181106113d1576113d16127c7565b602002602001015160200151336040518963ffffffff1660e01b815260040161140198979695949392919061295a565b600060405180830381600087803b15801561141b57600080fd5b505af115801561142f573d6000803e3d6000fd5b50505050508061143e90612ac7565b9050611289565b50508061145190612ac7565b9050611235565b505b600101610e42565b5060005b838110156116de576000838281518110611482576114826127c7565b60200260200101515111156116d65760008382815181106114a5576114a56127c7565b60200260200101515190505b80156116d45760008483815181106114cb576114cb6127c7565b60200260200101516001836114e09190612934565b815181106114f0576114f06127c7565b60200260200101516060015190506000815190505b80156116c157600082611519600184612934565b81518110611529576115296127c7565b6020026020010151600001519050806001600160a01b031663ed463367846001856115549190612934565b81518110611564576115646127c7565b6020026020010151602001518560018661157e9190612934565b8151811061158e5761158e6127c7565b6020026020010151604001518f8f8a8181106115ac576115ac6127c7565b905060200201358e8e8b8181106115c5576115c56127c7565b90506020028101906115d791906127dd565b8c8c815181106115e9576115e96127c7565b602002602001015160018c6115fe9190612934565b8151811061160e5761160e6127c7565b60200260200101518e8d81518110611628576116286127c7565b602002602001015160018d61163d9190612934565b8151811061164d5761164d6127c7565b602002602001015160200151336040518963ffffffff1660e01b815260040161167d98979695949392919061295a565b600060405180830381600087803b15801561169757600080fd5b505af11580156116ab573d6000803e3d6000fd5b5050505050806116ba90612ac7565b9050611505565b5050806116cd90612ac7565b90506114b1565b505b600101611466565b5060005b8381101561181d5760008382815181106116fe576116fe6127c7565b60200260200101515111156118155760005b838281518110611722576117226127c7565b60200260200101515181101561181357336001600160a01b031684838151811061174e5761174e6127c7565b6020026020010151600186858151811061176a5761176a6127c7565b60200260200101515161177d9190612934565b8151811061178d5761178d6127c7565b6020026020010151602001516001600160a01b03167f40dadaa36c6c2e3d7317e24757451ffb2d603d875f0ad5e92c5dd156573b18738685815181106117d5576117d56127c7565b602002602001015184815181106117ee576117ee6127c7565b60200260200101516040516118039190612ade565b60405180910390a3600101611710565b505b6001016116e2565b50505050505050505050565b61183161189a565b600180546001600160a01b0383166001600160a01b031990911681179091556118626000546001600160a01b031690565b6001600160a01b03167f38d16b8cac22d99fc7c124b9cd0de2d3fa1faef420bfe791d8c362d765e2270060405160405180910390a350565b6000546001600160a01b031633146104045760405163118cdaa760e01b8152336004820152602401610555565b6118cf611bed565b6001805460ff60a01b191690557f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa335b6040516001600160a01b03909116815260200160405180910390a1565b6000807f88c1d2ecf185adf710588203a5f263f0ff61be0d33da39792cde19ba9aa4331e83600001518460200151856040015161195c8760600151611c17565b6080808901516040805160208101989098526001600160a01b03968716908801529490931660608601529184015260a083015260c082015260e0015b60408051601f1981840301815291905280516020909101209392505050565b600180546001600160a01b031916905561056781611ce2565b6000306001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016148015611a2957507f000000000000000000000000000000000000000000000000000000000000000046145b15611a5357507f000000000000000000000000000000000000000000000000000000000000000090565b610574604080517f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f60208201527f0000000000000000000000000000000000000000000000000000000000000000918101919091527f000000000000000000000000000000000000000000000000000000000000000060608201524660808201523060a082015260009060c00160405160208183030381529060405280519060200120905090565b611b03611b98565b6001805460ff60a01b1916600160a01b1790557f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a2586118ff3390565b60606105747f00000000000000000000000000000000000000000000000000000000000000006002611d32565b60606105747f00000000000000000000000000000000000000000000000000000000000000006003611d32565b600154600160a01b900460ff16156104045760405163d93c066560e01b815260040160405180910390fd5b600080600080611bd38686611ddd565b925092509250611be38282611e2a565b5090949350505050565b600154600160a01b900460ff1661040457604051638dfc202b60e01b815260040160405180910390fd5b60008082516001600160401b03811115611c3357611c336124ed565b604051908082528060200260200182016040528015611c5c578160200160208202803683370190505b50905060005b8351811015611cb257611c8d848281518110611c8057611c806127c7565b6020026020010151611ee7565b828281518110611c9f57611c9f6127c7565b6020908102919091010152600101611c62565b5080604051602001611cc49190612bcb565b60405160208183030381529060405280519060200120915050919050565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b606060ff8314611d4c57611d4583611f48565b9050610509565b818054611d5890612c01565b80601f0160208091040260200160405190810160405280929190818152602001828054611d8490612c01565b8015611dd15780601f10611da657610100808354040283529160200191611dd1565b820191906000526020600020905b815481529060010190602001808311611db457829003601f168201915b50505050509050610509565b60008060008351604103611e175760208401516040850151606086015160001a611e0988828585611f87565b955095509550505050611e23565b50508151600091506002905b9250925092565b6000826003811115611e3e57611e3e612c3b565b03611e47575050565b6001826003811115611e5b57611e5b612c3b565b03611e795760405163f645eedf60e01b815260040160405180910390fd5b6002826003811115611e8d57611e8d612c3b565b03611eae5760405163fce698f760e01b815260048101829052602401610555565b6003826003811115611ec257611ec2612c3b565b03611ee3576040516335e2f38360e21b815260048101829052602401610555565b5050565b6000807f80ad7e1b04ee6d994a125f4714ca0720908bd80ed16063ec8aee4b88e9253e2d8360000151846020015180519060200120604051602001611998939291909283526001600160a01b03919091166020830152604082015260600190565b60606000611f5583612056565b604080516020808252818301909252919250600091906020820181803683375050509182525060208101929092525090565b600080807f7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0841115611fc2575060009150600390508261204c565b604080516000808252602082018084528a905260ff891692820192909252606081018790526080810186905260019060a0016020604051602081039080840390855afa158015612016573d6000803e3d6000fd5b5050604051601f1901519150506001600160a01b0381166120425750600092506001915082905061204c565b9250600091508190505b9450945094915050565b600060ff8216601f81111561050957604051632cd44ac360e21b815260040160405180910390fd5b60006020828403121561209057600080fd5b5035919050565b6000602082840312156120a957600080fd5b81356001600160401b038111156120bf57600080fd5b820160c081850312156120d157600080fd5b9392505050565b60005b838110156120f35781810151838201526020016120db565b50506000910152565b600081518084526121148160208601602086016120d8565b601f01601f19169290920160200192915050565b60ff60f81b881681526000602060e0602084015261214960e084018a6120fc565b838103604085015261215b818a6120fc565b606085018990526001600160a01b038816608086015260a0850187905284810360c08601528551808252602080880193509091019060005b818110156121af57835183529284019291840191600101612193565b50909c9b505050505050505050505050565b6020815260006120d160208301846120fc565b60008083601f8401126121e657600080fd5b5081356001600160401b038111156121fd57600080fd5b6020830191508360208260051b850101111561221857600080fd5b9250929050565b6000806000806000806060878903121561223857600080fd5b86356001600160401b038082111561224f57600080fd5b61225b8a838b016121d4565b9098509650602089013591508082111561227457600080fd5b6122808a838b016121d4565b9096509450604089013591508082111561229957600080fd5b506122a689828a016121d4565b979a9699509497509295939492505050565b80356001600160a01b03811681146122cf57600080fd5b919050565b6000602082840312156122e657600080fd5b6120d1826122b8565b6000808335601e1984360301811261230657600080fd5b83016020810192503590506001600160401b0381111561232557600080fd5b80360382131561221857600080fd5b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b60008383855260208086019550808560051b830101846000805b8881101561240e57858403601f19018a52823536899003605e1901811261239c578283fd5b880160606001600160a01b036123b1836122b8565b1686526123c0878301836122ef565b82898901526123d28389018284612334565b9250505060406123e4818401846122ef565b9350878303828901526123f8838583612334565b9d89019d97505050938601935050600101612377565b509198975050505050505050565b6020815260006001600160a01b0380612434856122b8565b16602084015280612447602086016122b8565b16604084015250604083013560608301526060830135601e1984360301811261246f57600080fd5b83016020810190356001600160401b0381111561248b57600080fd5b8060051b360382131561249d57600080fd5b60c060808501526124b260e08501828461235d565b915050608084013560a08401526124cc60a08501856122ef565b848303601f190160c08601526124e3838284612334565b9695505050505050565b634e487b7160e01b600052604160045260246000fd5b604051606081016001600160401b0381118282101715612525576125256124ed565b60405290565b60405160c081016001600160401b0381118282101715612525576125256124ed565b604051601f8201601f191681016001600160401b0381118282101715612575576125756124ed565b604052919050565b60006001600160401b03821115612596576125966124ed565b5060051b60200190565b60006001600160401b038211156125b9576125b96124ed565b50601f01601f191660200190565b600082601f8301126125d857600080fd5b81356125eb6125e6826125a0565b61254d565b81815284602083860101111561260057600080fd5b816020850160208301376000918101602001919091529392505050565b600082601f83011261262e57600080fd5b8135602061263e6125e68361257d565b82815260059290921b8401810191818101908684111561265d57600080fd5b8286015b8481101561270c5780356001600160401b03808211156126815760008081fd5b908801906060828b03601f190181131561269b5760008081fd5b6126a3612503565b6126ae8885016122b8565b8152604080850135848111156126c45760008081fd5b6126d28e8b838901016125c7565b838b0152509184013591838311156126ea5760008081fd5b6126f88d8a858801016125c7565b908201528652505050918301918301612661565b509695505050505050565b600060c0828403121561272957600080fd5b61273161252b565b905061273c826122b8565b815261274a602083016122b8565b60208201526040820135604082015260608201356001600160401b038082111561277357600080fd5b61277f8583860161261d565b60608401526080840135608084015260a08401359150808211156127a257600080fd5b506127af848285016125c7565b60a08301525092915050565b60006105093683612717565b634e487b7160e01b600052603260045260246000fd5b6000808335601e198436030181126127f457600080fd5b8301803591506001600160401b0382111561280e57600080fd5b60200191503681900382131561221857600080fd5b6000602080838503121561283657600080fd5b82356001600160401b038082111561284d57600080fd5b818501915085601f83011261286157600080fd5b813561286f6125e68261257d565b81815260059190911b8301840190848101908883111561288e57600080fd5b8585015b838110156128c6578035858111156128aa5760008081fd5b6128b88b89838a0101612717565b845250918601918601612892565b5098975050505050505050565b8281526040602082015260006128ec60408301846120fc565b949350505050565b60006020828403121561290657600080fd5b81516001600160e01b0319811681146120d157600080fd5b634e487b7160e01b600052601160045260246000fd5b818103818111156105095761050961291e565b808201808211156105095761050961291e565b60e08152600061296d60e083018b6120fc565b828103602084015261297f818b6120fc565b9050886040840152828103606084015261299a81888a612334565b608084019690965250506001600160a01b0392831660a0820152911660c09091015295945050505050565b8381526040602082015260006129df604083018486612334565b95945050505050565b600060208083850312156129fb57600080fd5b82516001600160401b0380821115612a1257600080fd5b818501915085601f830112612a2657600080fd5b8151612a346125e68261257d565b81815260059190911b83018401908481019088831115612a5357600080fd5b8585015b838110156128c657805185811115612a6f5760008081fd5b8601603f81018b13612a815760008081fd5b878101516040612a936125e6836125a0565b8281528d82848601011115612aa85760008081fd5b612ab7838c83018487016120d8565b8652505050918601918601612a57565b600081612ad657612ad661291e565b506000190190565b602080825282516001600160a01b0390811683830152838201518116604080850191909152808501516060808601919091528086015160c06080870152805160e0870181905260009594610100600583901b8901810195919493870193919290890190885b81811015612b9d5760ff198b8903018352855187815116895289810151858b8b0152612b71868b01826120fc565b918701518a83038b890152919050612b8981836120fc565b995050509488019491880191600101612b43565b50505050505050608085015160a085015260a08501519150601f198482030160c08501526129df81836120fc565b815160009082906020808601845b83811015612bf557815185529382019390820190600101612bd9565b50929695505050505050565b600181811c90821680612c1557607f821691505b602082108103612c3557634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052602160045260246000fdfea264697066735822122073f8fd2b36b643aff6f988638bc7c8ab2f41546c01a777524170b479e36618c564736f6c63430008170033"}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/constants.cjs"}],[2906,{"./types.cjs":2927},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SimulationRevertedError=n.SimulationInvalidResponseError=n.SimulationChainNotSupportedError=n.FirstTimeInteractionError=n.SimulationError=void 0;const s=e("./types.cjs");class a extends Error{constructor(e,t){super(e??"Simulation failed"),this.code=t}}n.SimulationError=a;class r extends Error{constructor(e,t){super(e??"Error checking first time interaction"),this.code=t}}n.FirstTimeInteractionError=r;n.SimulationChainNotSupportedError=class extends a{constructor(e){super(`Chain is not supported: ${e}`,s.SimulationErrorCode.ChainNotSupported)}};n.SimulationInvalidResponseError=class extends a{constructor(){super("Invalid response from simulation API",s.SimulationErrorCode.InvalidResponse)}};n.SimulationRevertedError=class extends a{constructor(){super("Transaction was reverted",s.SimulationErrorCode.Reverted)}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/errors.cjs"}],[2907,{"../logger.cjs":2926,"../types.cjs":2927,"../utils/gas-fees.cjs":2934,"@metamask/gas-fee-controller":2009,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultGasFeeFlow=void 0;const l=e("@metamask/gas-fee-controller"),d=e("@metamask/utils"),p=e("../logger.cjs"),m=e("../types.cjs"),h=e("../utils/gas-fees.cjs"),f=(0,d.createModuleLogger)(p.projectLogger,"default-gas-fee-flow");n.DefaultGasFeeFlow=class{constructor(){s.add(this)}matchesTransaction(){return!0}async getGasFees(e){const{gasFeeControllerData:t}=e,{gasEstimateType:n,gasFeeEstimates:o}=t;let c;switch(n){case l.GAS_ESTIMATE_TYPES.FEE_MARKET:f("Using fee market estimates",o),c=u(this,s,"m",a).call(this,o);break;case l.GAS_ESTIMATE_TYPES.LEGACY:f("Using legacy estimates",o),c=u(this,s,"m",r).call(this,o);break;case l.GAS_ESTIMATE_TYPES.ETH_GASPRICE:f("Using eth_gasPrice estimates",o),c=u(this,s,"m",i).call(this,o);break;default:throw new Error(`Unsupported gas estimate type: ${n}`)}return{estimates:c}}},s=new WeakSet,a=function(e){const t=Object.values(m.GasFeeEstimateLevel).reduce(((t,n)=>({...t,[n]:u(this,s,"m",o).call(this,e,n)})),{});return{type:m.GasFeeEstimateType.FeeMarket,...t}},r=function(e){const t=Object.values(m.GasFeeEstimateLevel).reduce(((t,n)=>({...t,[n]:u(this,s,"m",c).call(this,e,n)})),{});return{type:m.GasFeeEstimateType.Legacy,...t}},i=function(e){return{type:m.GasFeeEstimateType.GasPrice,gasPrice:(0,h.gweiDecimalToWeiHex)(e.gasPrice)}},o=function(e,t){return{maxFeePerGas:(0,h.gweiDecimalToWeiHex)(e[t].suggestedMaxFeePerGas),maxPriorityFeePerGas:(0,h.gweiDecimalToWeiHex)(e[t].suggestedMaxPriorityFeePerGas)}},c=function(e,t){return(0,h.gweiDecimalToWeiHex)(e[t])}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/DefaultGasFeeFlow.cjs"}],[2908,{"../logger.cjs":2926,"../types.cjs":2927,"./DefaultGasFeeFlow.cjs":2907,"@metamask/controller-utils":1559,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LineaGasFeeFlow=void 0;const l=e("@metamask/controller-utils"),d=e("@metamask/utils"),p=e("./DefaultGasFeeFlow.cjs"),m=e("../logger.cjs"),h=e("../types.cjs"),f=(0,d.createModuleLogger)(m.projectLogger,"linea-gas-fee-flow"),g=[l.ChainId["linea-mainnet"],l.ChainId["linea-goerli"],l.ChainId["linea-sepolia"]],b={low:1,medium:1.35,high:1.7},y={low:1,medium:1.05,high:1.1};n.LineaGasFeeFlow=class{constructor(){s.add(this)}matchesTransaction({transactionMeta:e}){return g.includes(e.chainId)}async getGasFees(e){try{return await u(this,s,"m",a).call(this,e)}catch(t){return f("Using default flow as fallback due to error",t),(new p.DefaultGasFeeFlow).getGasFees(e)}}},s=new WeakSet,a=async function(e){const{ethQuery:t,transactionMeta:n}=e,a=await u(this,s,"m",r).call(this,n,t);f("Received Linea response",a);const d=u(this,s,"m",i).call(this,a.baseFeePerGas,b);f("Generated base fees",u(this,s,"m",c).call(this,d));const p=u(this,s,"m",i).call(this,a.priorityFeePerGas,y);f("Generated priority fees",u(this,s,"m",c).call(this,p));const m=u(this,s,"m",o).call(this,d,p);f("Generated max fees",u(this,s,"m",c).call(this,m));return{estimates:Object.values(h.GasFeeEstimateLevel).reduce(((e,t)=>({...e,[t]:{maxFeePerGas:(0,l.toHex)(m[t]),maxPriorityFeePerGas:(0,l.toHex)(p[t])}})),{type:h.GasFeeEstimateType.FeeMarket})}},r=function(e,t){return(0,l.query)(t,"linea_estimateGas",[{from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,input:e.txParams.data}])},i=function(e,t){const n=(0,l.hexToBN)(e);return{low:n.muln(t.low),medium:n.muln(t.medium),high:n.muln(t.high)}},o=function(e,t){return{low:e.low.add(t.low),medium:e.medium.add(t.medium),high:e.high.add(t.high)}},c=function(e){return Object.values(h.GasFeeEstimateLevel).map((t=>e[t].toString(10)))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/LineaGasFeeFlow.cjs"}],[2909,{"../constants.cjs":2905,"./OracleLayer1GasFeeFlow.cjs":2910},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OptimismLayer1GasFeeFlow=void 0;const s=e("./OracleLayer1GasFeeFlow.cjs"),a=e("../constants.cjs"),r=[a.CHAIN_IDS.OPTIMISM,a.CHAIN_IDS.OPTIMISM_TESTNET,a.CHAIN_IDS.BASE,a.CHAIN_IDS.BASE_TESTNET,a.CHAIN_IDS.OPBNB,a.CHAIN_IDS.OPBNB_TESTNET,a.CHAIN_IDS.ZORA];class i extends s.OracleLayer1GasFeeFlow{constructor(){super("0x420000000000000000000000000000000000000F")}matchesTransaction({transactionMeta:e}){return r.includes(e.chainId)}}n.OptimismLayer1GasFeeFlow=i}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/OptimismLayer1GasFeeFlow.cjs"}],[2910,{"../logger.cjs":2926,"../utils/prepare.cjs":2940,"@ethersproject/contracts":581,"@ethersproject/providers":619,"@metamask/utils":2974,buffer:4106},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s,a,r,i,o,c,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.OracleLayer1GasFeeFlow=void 0;const d=e("@ethersproject/contracts"),p=e("@ethersproject/providers"),m=e("@metamask/utils"),h=e("../logger.cjs"),f=e("../utils/prepare.cjs"),g=(0,m.createModuleLogger)(h.projectLogger,"oracle-layer1-gas-fee-flow"),b=[{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"getL1Fee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];n.OracleLayer1GasFeeFlow=class{constructor(e,t){s.add(this),a.set(this,void 0),r.set(this,void 0),u(this,a,e,"f"),u(this,r,t??!1,"f")}async getLayer1Fee(e){try{return await l(this,s,"m",i).call(this,e)}catch(e){throw g("Failed to get oracle layer 1 gas fee",e),new Error("Failed to get oracle layer 1 gas fee")}}},a=new WeakMap,r=new WeakMap,s=new WeakSet,i=async function(e){const{provider:t,transactionMeta:n}=e,i=new d.Contract(l(this,a,"f"),b,new p.Web3Provider(t)),c=l(this,s,"m",o).call(this,n,l(this,r,"f")).serialize(),u=await i.getL1Fee(c);if(u===undefined)throw new Error("No value returned from oracle contract");return{layer1Fee:u.toHexString()}},o=function(e,n){const a=l(this,s,"m",c).call(this,e),{chainId:r}=e;let i=(0,f.prepareTransaction)(r,a);if(n){const e=t.from("abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789","hex");i=i.sign(e)}return i},c=function(e){return{...e.txParams,gasLimit:e.txParams.gas}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/OracleLayer1GasFeeFlow.cjs"}],[2911,{"../logger.cjs":2926,"../types.cjs":2927,"../utils/feature-flags.cjs":2932,"../utils/gas-fees.cjs":2934,"./DefaultGasFeeFlow.cjs":2907,"@metamask/gas-fee-controller":2009,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.randomiseDecimalGWEIAndConvertToHex=n.RandomisedEstimationsGasFeeFlow=void 0;const u=e("@metamask/gas-fee-controller"),l=e("@metamask/utils"),d=e("./DefaultGasFeeFlow.cjs"),p=e("../logger.cjs"),m=e("../types.cjs"),h=e("../utils/feature-flags.cjs"),f=e("../utils/gas-fees.cjs"),g=(0,l.createModuleLogger)(p.projectLogger,"randomised-estimation-gas-fee-flow");function b(e,t,n){const s=(0,f.gweiDecimalToWeiDecimal)(e),a=s.length,r=Math.min(t,a-n);if(0===Number(s)||r<=0)return`0x${Number(s).toString(16)}`;const i=a-r,o=s.slice(0,i),c=s.slice(-r),u=function(e,t){const n=10**e;return t+Math.floor(Math.random()*(n-t))}(r,Number(c)),d=`0x${(BigInt(o+"0".repeat(r))+BigInt(u)).toString(16)}`;return(0,l.add0x)(d)}n.RandomisedEstimationsGasFeeFlow=class{constructor(){s.add(this)}matchesTransaction({transactionMeta:e,messenger:t}){const{chainId:n}=e;return(0,h.getGasFeeRandomisation)(t).randomisedGasFeeDigits[n]!==undefined}async getGasFees(e){try{return await c(this,s,"m",r).call(this,e)}catch(t){return g("Using default flow as fallback due to error",t),await c(this,s,"m",a).call(this,e)}}},s=new WeakSet,a=async function(e){return(new d.DefaultGasFeeFlow).getGasFees(e)},r=async function(e){const{messenger:t,gasFeeControllerData:n,transactionMeta:r}=e,{gasEstimateType:o,gasFeeEstimates:l}=n,d=(0,h.getGasFeeRandomisation)(t),p=d.randomisedGasFeeDigits[r.chainId],m=d.preservedNumberOfDigits??2;if(o===u.GAS_ESTIMATE_TYPES.FEE_MARKET){g("Randomising fee market estimates",l);const e=c(this,s,"m",i).call(this,l,p,m);return g("Added randomised fee market estimates",e),{estimates:e}}return await c(this,s,"m",a).call(this,e)},i=function(e,t,n){const a=Object.values(m.GasFeeEstimateLevel).reduce(((a,r)=>({...a,[r]:c(this,s,"m",o).call(this,e,r,t,n)})),{});return{type:m.GasFeeEstimateType.FeeMarket,...a}},o=function(e,t,n,s){return{maxFeePerGas:(0,f.gweiDecimalToWeiHex)(e[t].suggestedMaxFeePerGas),maxPriorityFeePerGas:b(e[t].suggestedMaxPriorityFeePerGas,n,s)}},n.randomiseDecimalGWEIAndConvertToHex=b}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/RandomisedEstimationsGasFeeFlow.cjs"}],[2912,{"../constants.cjs":2905,"./OracleLayer1GasFeeFlow.cjs":2910},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ScrollLayer1GasFeeFlow=void 0;const s=e("./OracleLayer1GasFeeFlow.cjs"),a=e("../constants.cjs"),r=[a.CHAIN_IDS.SCROLL,a.CHAIN_IDS.SCROLL_SEPOLIA];class i extends s.OracleLayer1GasFeeFlow{constructor(){super("0x5300000000000000000000000000000000000002",!0)}matchesTransaction({transactionMeta:e}){return r.includes(e.chainId)}}n.ScrollLayer1GasFeeFlow=i}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/ScrollLayer1GasFeeFlow.cjs"}],[2913,{"../types.cjs":2927,"@metamask/controller-utils":1559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},o=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.TestGasFeeFlow=void 0;const c=e("@metamask/controller-utils"),u=e("../types.cjs"),l=1e15;n.TestGasFeeFlow=class{constructor(){s.add(this),a.set(this,1)}matchesTransaction(){return!0}async getGasFees(e){const{transactionMeta:t}=e,{txParams:n}=t,{gas:c}=n;if(!c)throw new Error("Cannot estimate fee without gas value");const d=parseInt(c,16),p=.5*l,m=(i(this,a,"f")+1)*l,h=i(this,a,"f")*l,f=m-p,g=h-p,b=m+p,y=h+p;return o(this,a,i(this,a,"f")+1,"f"),{estimates:{type:u.GasFeeEstimateType.FeeMarket,low:{maxFeePerGas:i(this,s,"m",r).call(this,f,d),maxPriorityFeePerGas:i(this,s,"m",r).call(this,g,d)},medium:{maxFeePerGas:i(this,s,"m",r).call(this,m,d),maxPriorityFeePerGas:i(this,s,"m",r).call(this,h,d)},high:{maxFeePerGas:i(this,s,"m",r).call(this,b,d),maxPriorityFeePerGas:i(this,s,"m",r).call(this,y,d)}}}}},a=new WeakMap,s=new WeakSet,r=function(e,t){const n=Math.ceil(e/t);return(0,c.toHex)(n)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/gas-flows/TestGasFeeFlow.cjs"}],[2914,{"../api/accounts-api.cjs":2903,"../constants.cjs":2905,"../index.cjs":2925,"../logger.cjs":2926,"../types.cjs":2927,"@metamask/controller-utils":1559,"bn.js":4045,uuid:5741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccountsApiRemoteTransactionSource=n.SUPPORTED_CHAIN_IDS=void 0;const u=e("@metamask/controller-utils"),l=c(e("bn.js")),d=e("uuid"),p=e("../index.cjs"),m=e("../api/accounts-api.cjs"),h=e("../constants.cjs"),f=e("../logger.cjs"),g=e("../types.cjs");n.SUPPORTED_CHAIN_IDS=[h.CHAIN_IDS.MAINNET,h.CHAIN_IDS.POLYGON,h.CHAIN_IDS.BSC,h.CHAIN_IDS.LINEA_MAINNET,h.CHAIN_IDS.BASE,h.CHAIN_IDS.OPTIMISM,h.CHAIN_IDS.ARBITRUM,h.CHAIN_IDS.SCROLL,h.CHAIN_IDS.SEI];const b=(0,f.createModuleLogger)(f.incomingTransactionsLogger,"accounts-api-source");n.AccountsApiRemoteTransactionSource=class{constructor(){s.add(this)}getSupportedChains(){return n.SUPPORTED_CHAIN_IDS}async fetchTransactions(e){const{address:t}=e,c=await o(this,s,"m",a).call(this,e,n.SUPPORTED_CHAIN_IDS);b("Fetched transactions",c.length,c);const u=await Promise.all(c.map((e=>o(this,s,"m",i).call(this,t,e))));b("Normalized transactions",u);const l=o(this,s,"m",r).call(this,e,u);return b("Filtered transactions",l.length,l),l}},s=new WeakSet,a=async function(e,t){const{address:n,tags:s}=e,a=[];try{const e=await(0,m.getAccountTransactions)({address:n,chainIds:t,sortDirection:"DESC",tags:s});e?.data&&a.push(...e.data)}catch(e){b("Error while fetching transactions",e)}return a},r=function(e,t){const{address:n,includeTokenTransfers:s,updateTransactions:a}=e;let r=t;return a||(r=r.filter((e=>e.txParams.to===n))),s||(r=r.filter((e=>!e.isTransfer))),r},i=async function(e,t){const n=String(t.blockNumber),s=`0x${t.chainId.toString(16)}`,{hash:a}=t,r=new Date(t.timestamp).getTime(),i=(0,d.v1)({msecs:r}),{from:o}=t,c=(0,u.BNToHex)(new l.default(t.gas)),m=(0,u.BNToHex)(new l.default(t.gasPrice)),h=(0,u.BNToHex)(new l.default(t.gasUsed)),f=(0,u.BNToHex)(new l.default(t.nonce)),b=t.methodId,y=g.TransactionType.incoming,S=t.isError?g.TransactionStatus.failed:g.TransactionStatus.confirmed,k=t.valueTransfers.find((t=>(t.to.toLowerCase()===e.toLowerCase()||t.from.toLowerCase()===e.toLowerCase())&&t.contractAddress)),T=k?.to.toLowerCase()===e.toLowerCase()&&o.toLowerCase()!==e.toLowerCase(),w=o.toLowerCase()===e.toLowerCase(),v=k?.amount,E=k?.contractAddress,j=k?.decimal,P=k?.symbol,I=(0,u.BNToHex)(new l.default(T?k?.amount??t.value:t.value)),_=T?e:t.to,C={blockNumber:n,chainId:s,error:S===g.TransactionStatus.failed?new Error("Transaction failed"):undefined,hash:a,id:i,isTransfer:T,networkClientId:"",status:S,time:r,toSmartContract:!1,transferInformation:k?{amount:v,contractAddress:E,decimals:j,symbol:P}:undefined,txParams:{chainId:s,data:b,from:o,gas:c,gasPrice:m,gasUsed:h,nonce:f,to:_,value:I},type:y,verifiedOnBlockchain:!1};return w&&(C.type=(await(0,p.determineTransactionType)(C.txParams)).type),C}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/AccountsApiRemoteTransactionSource.cjs"}],[2915,{"../gas-flows/DefaultGasFeeFlow.cjs":2907,"../logger.cjs":2926,"../types.cjs":2927,"../utils/gas-flow.cjs":2935,"../utils/layer1-gas-fee-flow.cjs":2938,"@metamask/eth-query":1775,"@metamask/utils":2974,events:4454},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h,f,g,b,y,S,k,T,w,v,E,j,P=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},I=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},_=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateTransactionGasEstimates=n.updateTransactionGasProperties=n.GasFeePoller=void 0;const C=_(e("@metamask/eth-query")),A=e("@metamask/utils"),x=_(e("events")),O=e("../gas-flows/DefaultGasFeeFlow.cjs"),R=e("../logger.cjs"),F=e("../types.cjs"),M=e("../utils/gas-flow.cjs"),N=e("../utils/layer1-gas-fee-flow.cjs"),L=(0,A.createModuleLogger)(R.projectLogger,"gas-fee-poller");function G(e,t,n,s){const{type:a}=t;if(s){if(a===F.GasFeeEstimateType.FeeMarket){const s=t;e.maxFeePerGas=s[n]?.maxFeePerGas,e.maxPriorityFeePerGas=s[n]?.maxPriorityFeePerGas}if(a===F.GasFeeEstimateType.GasPrice){const n=t;e.maxFeePerGas=n.gasPrice,e.maxPriorityFeePerGas=n.gasPrice}if(a===F.GasFeeEstimateType.Legacy){const s=t[n];e.maxFeePerGas=s,e.maxPriorityFeePerGas=s}delete e.gasPrice}else{if(a===F.GasFeeEstimateType.FeeMarket){const s=t;e.gasPrice=s[n]?.maxFeePerGas}if(a===F.GasFeeEstimateType.GasPrice){const n=t;e.gasPrice=n.gasPrice}if(a===F.GasFeeEstimateType.Legacy){const s=t;e.gasPrice=s[n]}delete e.maxFeePerGas,delete e.maxPriorityFeePerGas}}n.GasFeePoller=class{constructor({findNetworkClientIdByChainId:e,gasFeeFlows:t,getGasFeeControllerEstimates:n,getProvider:g,getTransactions:b,getTransactionBatches:y,layer1GasFeeFlows:S,messenger:k,onStateChange:T}){s.add(this),this.hub=new x.default,a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),p.set(this,void 0),m.set(this,!1),P(this,a,e,"f"),P(this,r,t,"f"),P(this,l,S,"f"),P(this,i,n,"f"),P(this,o,g,"f"),P(this,c,b,"f"),P(this,u,y,"f"),P(this,d,k,"f"),T((()=>{const e=I(this,s,"m",v).call(this),t=I(this,s,"m",E).call(this);e.length||t.length?I(this,s,"m",h).call(this):I(this,s,"m",f).call(this)}))}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,m=new WeakMap,s=new WeakSet,h=function(){I(this,m,"f")||(I(this,s,"m",g).call(this),P(this,m,!0,"f"),L("Started polling"))},f=function(){I(this,m,"f")&&(clearTimeout(I(this,p,"f")),P(this,p,undefined,"f"),P(this,m,!1,"f"),L("Stopped polling"))},g=async function e(){await I(this,s,"m",b).call(this),await I(this,s,"m",y).call(this),P(this,p,setTimeout((()=>I(this,s,"m",e).call(this)),1e4),"f")},b=async function(){const e=I(this,s,"m",v).call(this);if(!e.length)return;L("Found unapproved transactions",e.length);const t=await I(this,s,"m",j).call(this,e);L("Retrieved gas fee controller data",t),await Promise.all(e.flatMap((e=>{const{chainId:n}=e,a=t.get(n);return I(this,s,"m",S).call(this,e,a)})))},y=async function(){const e=I(this,s,"m",E).call(this);if(!e.length)return;L("Found unapproved transaction batches",e.length);const t=await I(this,s,"m",j).call(this,e);L("Retrieved gas fee controller data",t),await Promise.all(e.flatMap((e=>{const{chainId:n}=e,a=t.get(n);return I(this,s,"m",k).call(this,e,a)})))},S=async function(e,t){const{id:n}=e,[a,r]=await Promise.all([I(this,s,"m",T).call(this,e,t),I(this,s,"m",w).call(this,e)]);(a||r)&&this.hub.emit("transaction-updated",{transactionId:n,gasFeeEstimates:a?.gasFeeEstimates,gasFeeEstimatesLoaded:a?.gasFeeEstimatesLoaded,layer1GasFee:r})},k=async function(e,t){const{id:n}=e,s=new C.default(I(this,o,"f").call(this,e.networkClientId)),a=new O.DefaultGasFeeFlow,r={ethQuery:s,gasFeeControllerData:t,messenger:I(this,d,"f"),transactionMeta:{...e,txParams:{...e.transactions?.[0],from:e.from,gas:e.gas},time:Date.now()}};let i;try{i=(await a.getGasFees(r)).estimates}catch(t){L("Failed to get gas fees for batch",e.id,t)}i&&this.hub.emit("transaction-batch-updated",{transactionBatchId:n,gasFeeEstimates:i,gasFeeEstimatesLoaded:!0})},T=async function(e,t){const{networkClientId:n}=e,s=new C.default(I(this,o,"f").call(this,n)),a=(0,M.getGasFeeFlow)(e,I(this,r,"f"),I(this,d,"f"));a&&L("Found gas fee flow",a.constructor.name,e.id);const i={ethQuery:s,gasFeeControllerData:t,messenger:I(this,d,"f"),transactionMeta:e};let c;if(a)try{c=(await a.getGasFees(i)).estimates}catch(t){L("Failed to get suggested gas fees",e.id,t)}return!c&&e.gasFeeEstimatesLoaded?undefined:(L("Updated gas fee estimates",{gasFeeEstimates:c,transaction:e.id}),{gasFeeEstimates:c,gasFeeEstimatesLoaded:!0})},w=async function(e){const{networkClientId:t}=e,n=I(this,o,"f").call(this,t),s=await(0,N.getTransactionLayer1GasFee)({layer1GasFeeFlows:I(this,l,"f"),messenger:I(this,d,"f"),provider:n,transactionMeta:e});return s&&L("Updated layer 1 gas fee",s,e.id),s},v=function(){return I(this,c,"f").call(this).filter((e=>e.status===F.TransactionStatus.unapproved))},E=function(){return I(this,u,"f").call(this).filter((e=>e.status===F.TransactionStatus.unapproved))},j=async function(e){const t=new Map;for(const n of e){const{chainId:e,networkClientId:s}=n;if(t.has(e))continue;const r=s??I(this,a,"f").call(this,e);t.set(e,r)}L("Extracted network client IDs by chain ID",t);const n=Array.from(t.entries()).map((async([e,t])=>[e,await I(this,i,"f").call(this,{networkClientId:t})]));return new Map(await Promise.all(n))},n.updateTransactionGasProperties=function({gasFeeEstimates:e,gasFeeEstimatesLoaded:t,isTxParamsGasFeeUpdatesEnabled:n,layer1GasFee:s,txMeta:a}){const r=a.userFeeLevel,i=Object.values(F.GasFeeEstimateLevel).includes(r);if(n(a)&&i&&e){const t=a.txParams.type!==F.TransactionEnvelopeType.legacy;G(a.txParams,e,r,t)}e&&(a.gasFeeEstimates=e),t!==undefined&&(a.gasFeeEstimatesLoaded=t),s&&(a.layer1GasFee=s)},n.updateTransactionGasEstimates=function({txMeta:e,userFeeLevel:t}){const{txParams:n,gasFeeEstimates:s}=e;if(!s)return;G(n,s,t,e.txParams.type!==F.TransactionEnvelopeType.legacy)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/GasFeePoller.cjs"}],[2916,{"../logger.cjs":2926,"../utils/feature-flags.cjs":2932,events:4454},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h,f,g,b,y,S,k=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},T=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},w=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.IncomingTransactionHelper=void 0;const v=w(e("events")),E=e("../logger.cjs"),j=e("../utils/feature-flags.cjs");n.IncomingTransactionHelper=class{constructor({client:e,getCurrentAccount:t,getLocalTransactions:n,includeTokenTransfers:f,isEnabled:g,messenger:b,remoteTransactionSource:y,trimTransactions:S,updateTransactions:T}){s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),p.set(this,void 0),m.set(this,void 0),h.set(this,void 0),this.hub=new v.default,k(this,a,e,"f"),k(this,r,t,"f"),k(this,i,n,"f"),k(this,o,f,"f"),k(this,c,g??(()=>!0),"f"),k(this,u,!1,"f"),k(this,l,b,"f"),k(this,d,y,"f"),k(this,m,S,"f"),k(this,h,T,"f")}start(){if(T(this,u,"f"))return;if(!T(this,s,"m",b).call(this))return;const e=T(this,s,"m",y).call(this);(0,E.incomingTransactionsLogger)("Started polling",{interval:e}),k(this,u,!0,"f"),T(this,s,"m",f).call(this).catch((e=>{(0,E.incomingTransactionsLogger)("Initial polling failed",e)}))}stop(){T(this,p,"f")&&clearTimeout(T(this,p,"f")),T(this,u,"f")&&(k(this,u,!1,"f"),(0,E.incomingTransactionsLogger)("Stopped polling"))}async update({isInterval:e,tags:t}={}){const n=T(this,s,"m",S).call(this,t,e);if((0,E.incomingTransactionsLogger)("Checking for incoming transactions",{isInterval:Boolean(e),tags:n}),!T(this,s,"m",b).call(this))return;const a=T(this,r,"f").call(this),c=T(this,o,"f")??!0,u=T(this,h,"f")??!1;let l=[];try{l=await T(this,d,"f").fetchTransactions({address:a.address,includeTokenTransfers:c,tags:n,updateTransactions:u})}catch(e){return void(0,E.incomingTransactionsLogger)("Error while fetching remote transactions",e)}if(!l.length)return;T(this,s,"m",g).call(this,l),(0,E.incomingTransactionsLogger)("Found potential transactions",l.length,l);const p=T(this,i,"f").call(this),f=l.filter((e=>!p.some((t=>t.hash?.toLowerCase()===e.hash?.toLowerCase()&&t.txParams.from?.toLowerCase()===e.txParams.from?.toLowerCase()&&t.type===e.type))));if(!f.length)return void(0,E.incomingTransactionsLogger)("All transactions are already known");(0,E.incomingTransactionsLogger)("Found unique transactions",f.length,f);const y=T(this,m,"f").call(this,[...f,...p]),k=f.map((e=>e.id)),w=y.filter((e=>k.includes(e.id)));w.length?((0,E.incomingTransactionsLogger)("Adding new transactions",w.length,w),this.hub.emit("transactions",w)):(0,E.incomingTransactionsLogger)("All unique transactions truncated due to limit")}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,m=new WeakMap,h=new WeakMap,s=new WeakSet,f=async function e(){try{await this.update({isInterval:!0})}catch(e){console.error("Error while checking incoming transactions",e)}T(this,u,"f")&&k(this,p,setTimeout((()=>T(this,s,"m",e).call(this)),T(this,s,"m",y).call(this)),"f")},g=function(e){e.sort(((e,t)=>e.time<t.time?-1:1))},b=function(){return T(this,c,"f").call(this)},y=function(){return(0,j.getIncomingTransactionsPollingInterval)(T(this,l,"f"))},S=function(e,t){const n=[];return T(this,a,"f")&&n.push(T(this,a,"f")),e?.length?n.push(...e):t&&n.push("automatic-polling"),n?.length?n:undefined}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/IncomingTransactionHelper.cjs"}],[2917,{"../logger.cjs":2926,"@metamask/utils":2974,"async-mutex":3932,"eth-method-registry":4329,events:4454},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.MethodDataHelper=void 0;const p=e("@metamask/utils"),m=e("async-mutex"),h=e("eth-method-registry"),f=d(e("events")),g=e("../logger.cjs"),b=(0,p.createModuleLogger)(g.projectLogger,"method-data");n.MethodDataHelper=class{constructor({getProvider:e,getState:t}){s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,new m.Mutex),this.hub=new f.default,u(this,a,e,"f"),u(this,r,t,"f"),u(this,i,new Map,"f")}async lookup(e,t){b("lookup",e,t);const n=await l(this,o,"f").acquire();try{const n=l(this,r,"f").call(this)[e];if(n)return b("Cached",n),n;let o=l(this,i,"f").get(t);if(!o){const e=l(this,a,"f").call(this,t);o=new h.MethodRegistry({provider:e}),l(this,i,"f").set(t,o),b("Created registry",t)}const u=await l(this,s,"m",c).call(this,e,o);return b("Result",u),this.hub.emit("update",{fourBytePrefix:e,methodData:u}),u}finally{n()}}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,s=new WeakSet,c=async function(e,t){const n=await t.lookup(e);if(!n)return b("No method found",e),{registryMethod:"",parsedRegistryMethod:{name:undefined,args:undefined}};b("Parsing",n);return{registryMethod:n,parsedRegistryMethod:t.parse(n)}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/MethodDataHelper.cjs"}],[2918,{"../logger.cjs":2926,"async-mutex":3932},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h,f=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},g=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainTrackingHelper=void 0;const b=e("async-mutex"),y=e("../logger.cjs"),S=(0,y.createModuleLogger)(y.projectLogger,"multichain-tracking");n.MultichainTrackingHelper=class{constructor({findNetworkClientIdByChainId:e,getNetworkClientById:t,getNetworkClientRegistry:n,removePendingTransactionTrackerListeners:b,createNonceTracker:y,createPendingTransactionTracker:k,onNetworkStateChange:T}){s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,new Map),d.set(this,new Map),this.checkForPendingTransactionAndStartPolling=()=>{for(const[,e]of g(this,d,"f"))e.pendingTransactionTracker.startIfPendingTransactions()},p.set(this,(e=>{const t=Object.keys(e),n=Array.from(g(this,d,"f").keys()),a=n.filter((e=>!t.includes(e)));a.forEach((e=>{g(this,s,"m",m).call(this,e)}));const r=t.filter((e=>!n.includes(e)));r.forEach((e=>{g(this,s,"m",h).call(this,e)})),r.length&&S("Added trackers",r),a.length&&S("Removed trackers",a)})),f(this,a,e,"f"),f(this,r,t,"f"),f(this,i,n,"f"),f(this,o,b,"f"),f(this,c,y,"f"),f(this,u,k,"f"),T(((e,t)=>{const n=g(this,i,"f").call(this);t.forEach((({op:e,path:t})=>{if("remove"===e&&"networkConfigurations"===t[0]){const e=t[1];delete n[e]}})),g(this,p,"f").call(this,n)}))}initialize(){const e=g(this,i,"f").call(this);g(this,p,"f").call(this,e),S("Initialized")}has(e){return g(this,d,"f").has(e)}async acquireNonceLockForChainIdKey({chainId:e,key:t="global"}){let n=g(this,l,"f").get(e);n||(n=new Map,g(this,l,"f").set(e,n));let s=n.get(t);return s||(s=new b.Mutex,n.set(t,s)),await s.acquire()}async getNonceLock(e,t){const n=g(this,r,"f").call(this,t),s=await this.acquireNonceLockForChainIdKey({chainId:n.configuration.chainId,key:e}),a=g(this,d,"f").get(t)?.nonceTracker;if(!a)throw new Error(`Missing nonce tracker for network client ID - ${t}`);try{const t=await a.getNonceLock(e),n=()=>{t.releaseLock(),s?.()};return{...t,releaseLock:n}}catch(e){throw s?.(),e}}stopAllTracking(){for(const[e]of g(this,d,"f"))g(this,s,"m",m).call(this,e)}getNetworkClient({chainId:e,networkClientId:t}){if(!t&&!e)throw new Error("Cannot locate network client without networkClientId or chainId");let n,s=t;try{t&&(n=g(this,r,"f").call(this,t))}catch(n){if(S("No network client found with ID",t),!e)throw n}return!n&&e&&(s=g(this,a,"f").call(this,e),n=g(this,r,"f").call(this,s)),{...n,id:s}}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,s=new WeakSet,m=function(e){const t=g(this,d,"f").get(e);t&&(t.pendingTransactionTracker.stop(),g(this,o,"f").call(this,t.pendingTransactionTracker),g(this,d,"f").delete(e))},h=function(e){if(g(this,d,"f").get(e))return;const{provider:t,blockTracker:n,configuration:{chainId:s}}=g(this,r,"f").call(this,e),a=g(this,c,"f").call(this,{provider:t,blockTracker:n,chainId:s}),i=g(this,u,"f").call(this,{provider:t,blockTracker:n,chainId:s,networkClientId:e});g(this,d,"f").set(e,{nonceTracker:a,pendingTransactionTracker:i})}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/MultichainTrackingHelper.cjs"}],[2919,{"../logger.cjs":2926,"../types.cjs":2927,"./TransactionPoller.cjs":2921,"@metamask/controller-utils":1559,events:4454,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h,f,g,b,y,S,k,T,w,v,E,j,P,I,_,C,A,x,O,R,F,M,N,L,G,D,B=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},U=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},H=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PendingTransactionTracker=void 0;const $=e("@metamask/controller-utils"),K=H(e("events")),W=e("lodash"),q=e("./TransactionPoller.cjs"),z=e("../logger.cjs"),V=e("../types.cjs"),J=["replacement transaction underpriced","known transaction","gas price too low to replace","transaction with the same hash was already imported","gateway timeout","nonce too low"],X=(0,z.createModuleLogger)(z.projectLogger,"pending-transactions");n.PendingTransactionTracker=class{constructor({blockTracker:e,getChainId:t,getEthQuery:n,getGlobalLock:k,getNetworkClientId:T,getTransactions:w,hooks:v,isResubmitEnabled:E,messenger:j,publishTransaction:P}){s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,void 0),p.set(this,void 0),m.set(this,void 0),h.set(this,void 0),f.set(this,void 0),g.set(this,void 0),b.set(this,void 0),this.startIfPendingTransactions=()=>{const e=U(this,s,"m",A).call(this);e.length?U(this,s,"m",y).call(this,e):this.stop()},this.hub=new K.default,B(this,a,new Map,"f"),B(this,r,t,"f"),B(this,i,n,"f"),B(this,o,T,"f"),B(this,c,w,"f"),B(this,u,E??(()=>!0),"f"),B(this,l,U(this,s,"m",S).bind(this),"f"),B(this,p,k,"f"),B(this,m,P,"f"),B(this,h,!1,"f"),B(this,g,undefined,"f"),B(this,f,new q.TransactionPoller({blockTracker:e,chainId:t(),messenger:j}),"f"),B(this,b,v?.beforeCheckPendingTransaction??(()=>Promise.resolve(!0)),"f"),B(this,d,(0,z.createModuleLogger)(X,`${t()}:${T()}`),"f")}addTransactionToPoll(e){U(this,s,"m",y).call(this,[e]),B(this,g,e,"f")}async forceCheckTransaction(e){const t=await U(this,p,"f").call(this);try{await U(this,s,"m",P).call(this,e)}catch(e){U(this,d,"f").call(this,"Failed to check transaction",e)}finally{t()}}stop(){U(this,h,"f")&&(U(this,f,"f").stop(),B(this,h,!1,"f"),U(this,d,"f").call(this,"Stopped polling"))}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,m=new WeakMap,h=new WeakMap,f=new WeakMap,g=new WeakMap,b=new WeakMap,s=new WeakSet,y=function(e){U(this,f,"f").setPendingTransactions(e),U(this,h,"f")||(U(this,f,"f").start(U(this,l,"f")),B(this,h,!0,"f"),U(this,d,"f").call(this,"Started polling"))},S=async function(e){const t=await U(this,p,"f").call(this);try{await U(this,s,"m",k).call(this)}catch(e){U(this,d,"f").call(this,"Failed to check transactions",e)}finally{t()}try{await U(this,s,"m",T).call(this,e)}catch(e){U(this,d,"f").call(this,"Failed to resubmit transactions",e)}},k=async function(){U(this,d,"f").call(this,"Checking transactions");const e=[...U(this,s,"m",A).call(this),...U(this,g,"f")?[U(this,g,"f")]:[]];e.length?(U(this,d,"f").call(this,"Found pending transactions to check",{count:e.length,ids:e.map((e=>e.id))}),await Promise.all(e.map((e=>U(this,s,"m",P).call(this,e))))):U(this,d,"f").call(this,"No pending transactions to check")},T=async function(e){if(!U(this,u,"f").call(this)||!U(this,h,"f"))return;U(this,d,"f").call(this,"Resubmitting transactions");const t=U(this,s,"m",A).call(this);if(t.length){U(this,d,"f").call(this,"Found pending transactions to resubmit",{count:t.length,ids:t.map((e=>e.id))});for(const n of t)try{await U(this,s,"m",v).call(this,n,e)}catch(e){const t=e.value?.message?.toLowerCase()||e.message?.toLowerCase()||String(e);if(U(this,s,"m",w).call(this,t)){U(this,d,"f").call(this,"Ignoring known transaction error",t);continue}U(this,s,"m",x).call(this,n,e.message,"There was an error when resubmitting this transaction.")}}else U(this,d,"f").call(this,"No pending transactions to resubmit")},w=function(e){return J.some((t=>e.includes(t)))},v=async function(e,t){if(!U(this,s,"m",E).call(this,e,t))return;if(!await U(this,b,"f").call(this,e))return;const n=U(this,i,"f").call(this,e.networkClientId);await U(this,m,"f").call(this,n,e);const a=(e.retryCount??0)+1;U(this,s,"m",F).call(this,(0,W.merge)({},e,{retryCount:a}),"PendingTransactionTracker:transaction-retry - Retry count increased")},E=function(e,t){const n=(0,W.cloneDeep)(e);n.firstRetryBlockNumber||(n.firstRetryBlockNumber=t,U(this,s,"m",F).call(this,n,"PendingTransactionTracker:#isResubmitDue - First retry block number set"));const{firstRetryBlockNumber:a}=n,r=Number.parseInt(t,16)-Number.parseInt(a,16),i=e.retryCount||0;return r>=Math.min(50,Math.pow(2,i))},j=function(e){U(this,g,"f")?.id===e&&B(this,g,undefined,"f")},P=async function(e){const{hash:t,id:n}=e;if(!t&&await U(this,b,"f").call(this,e)){const t=new Error("We had an error while submitting this transaction, please try again.");return t.name="NoTxHashError",void U(this,s,"m",O).call(this,e,t)}if(U(this,s,"m",C).call(this,e))return U(this,d,"f").call(this,"Nonce already taken",n),void U(this,s,"m",R).call(this,e);try{const n=await U(this,s,"m",M).call(this,t),a="0x1"===n?.status;if("0x0"===n?.status)return U(this,d,"f").call(this,"Transaction receipt has failed status"),void U(this,s,"m",O).call(this,e,new Error("Transaction dropped or replaced"));const{blockNumber:r,blockHash:i}=n||{};if(a&&r&&i)return void await U(this,s,"m",I).call(this,e,{...n,blockNumber:r,blockHash:i})}catch(t){return U(this,d,"f").call(this,"Failed to check transaction",n,t),void U(this,s,"m",x).call(this,e,t.message,"There was a problem loading this transaction.")}await U(this,s,"m",_).call(this,e)&&U(this,s,"m",R).call(this,e)},I=async function(e,t){const{id:n}=e,{blockHash:a}=t;if(U(this,d,"f").call(this,"Transaction confirmed",n),U(this,g,"f"))return U(this,s,"m",j).call(this,e.id),void this.hub.emit("transaction-confirmed",e);const{baseFeePerGas:r,timestamp:i}=await U(this,s,"m",N).call(this,a,!1),o=(0,W.cloneDeep)(e);o.baseFeePerGas=r,o.blockTimestamp=i,o.status=V.TransactionStatus.confirmed,o.txParams={...o.txParams,gasUsed:t.gasUsed},o.txReceipt=t,o.verifiedOnBlockchain=!0,U(this,s,"m",F).call(this,o,"PendingTransactionTracker:#onTransactionConfirmed - Transaction confirmed"),this.hub.emit("transaction-confirmed",o)},_=async function(e){const{hash:t,id:n,txParams:{nonce:r,from:i}}=e;if(!r||!t)return!1;const o=await U(this,s,"m",L).call(this,i),c=parseInt(o,16);if(parseInt(r,16)>=c)return!1;let u=U(this,a,"f").get(t);return u===undefined&&(u=0,U(this,a,"f").set(t,u)),u<3?(U(this,d,"f").call(this,"Incrementing dropped block count",{id:n,droppedBlockCount:u}),U(this,a,"f").set(t,u+1),!1):(U(this,d,"f").call(this,"Hit dropped block count",n),U(this,a,"f").delete(t),!0)},C=function(e){const{id:t,txParams:n}=e;return U(this,s,"m",G).call(this).some((e=>e.id!==t&&e.txParams.from===n.from&&e.status===V.TransactionStatus.confirmed&&e.txParams.nonce&&e.txParams.nonce===n.nonce&&e.type!==V.TransactionType.incoming))},A=function(){return U(this,s,"m",D).call(this).filter((e=>e.status===V.TransactionStatus.submitted&&!e.verifiedOnBlockchain&&!e.isUserOperation))},x=function(e,t,n){U(this,s,"m",F).call(this,{...e,warning:{error:t,message:n}},"PendingTransactionTracker:#warnTransaction - Warning added")},O=function(e,t){U(this,d,"f").call(this,"Transaction failed",e.id,t),U(this,s,"m",j).call(this,e.id),this.hub.emit("transaction-failed",e,t)},R=function(e){U(this,d,"f").call(this,"Transaction dropped",e.id),U(this,s,"m",j).call(this,e.id),this.hub.emit("transaction-dropped",e)},F=function(e,t){this.hub.emit("transaction-updated",e,t)},M=async function(e){return await(0,$.query)(U(this,i,"f").call(this),"getTransactionReceipt",[e])},N=async function(e,t){return await(0,$.query)(U(this,i,"f").call(this),"getBlockByHash",[e,t])},L=async function(e){return await(0,$.query)(U(this,i,"f").call(this),"getTransactionCount",[e])},G=function(){const e=U(this,r,"f").call(this);return U(this,c,"f").call(this).filter((t=>t.chainId===e))},D=function(){const e=U(this,o,"f").call(this);return U(this,c,"f").call(this).filter((t=>t.networkClientId===e))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/PendingTransactionTracker.cjs"}],[2920,{"../logger.cjs":2926,"../types.cjs":2927,"../utils/utils.cjs":2945,"@metamask/utils":2974,"bn.js":4045,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},m=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.hasSimulationDataChanged=n.shouldResimulate=n.ResimulateHelper=n.RESIMULATE_INTERVAL_MS=n.BLOCK_TIME_ADDITIONAL_SECONDS=n.VALUE_COMPARISON_PERCENT_THRESHOLD=n.BLOCKAID_RESULT_TYPE_MALICIOUS=n.RESIMULATE_PARAMS=void 0;const h=e("@metamask/utils"),f=e("bn.js"),g=e("lodash"),b=e("../logger.cjs"),y=e("../types.cjs"),S=e("../utils/utils.cjs"),k=(0,b.createModuleLogger)(b.projectLogger,"resimulate-helper");n.RESIMULATE_PARAMS=["to","value","data"],n.BLOCKAID_RESULT_TYPE_MALICIOUS="Malicious",n.VALUE_COMPARISON_PERCENT_THRESHOLD=5,n.BLOCK_TIME_ADDITIONAL_SECONDS=60,n.RESIMULATE_INTERVAL_MS=3e3;function T(e,t){return!w(e?.difference??"0x0",t?.difference??"0x0",!1===e?.isDecrease,!1===t?.isDecrease)}function w(e,t,s,a){let r=new f.BN((0,h.remove0x)(e),"hex"),i=new f.BN((0,h.remove0x)(t),"hex");return s&&(r=r.neg()),a&&(i=i.neg()),(0,S.getPercentageChange)(r,i)<=n.VALUE_COMPARISON_PERCENT_THRESHOLD}n.ResimulateHelper=class{constructor({getTransactions:e,simulateTransaction:t,onTransactionsUpdate:n}){s.add(this),a.set(this,new Map),r.set(this,void 0),i.set(this,void 0),p(this,r,e,"f"),p(this,i,t,"f"),n(m(this,s,"m",o).bind(this))}},a=new WeakMap,r=new WeakMap,i=new WeakMap,s=new WeakSet,o=function(){const e=m(this,r,"f").call(this).filter((e=>e.status===y.TransactionStatus.unapproved)),t=new Set(e.map((e=>e.id)));new Set([...t,...m(this,a,"f").keys()]).forEach((t=>{const n=e.find((e=>e.id===t));n?.isActive?m(this,s,"m",c).call(this,n):m(this,s,"m",l).call(this,t)}))},c=function(e){const{id:t}=e;if(m(this,a,"f").has(t))return;const r=()=>{m(this,i,"f").call(this,e).catch((e=>{k("Error during transaction resimulation",e)})).finally((()=>{m(this,a,"f").has(t)&&m(this,s,"m",u).call(this,t,r)}))};m(this,s,"m",u).call(this,t,r),k(`Started resimulating transaction ${t} every ${n.RESIMULATE_INTERVAL_MS} milliseconds`)},u=function(e,t){const s=setTimeout(t,n.RESIMULATE_INTERVAL_MS);m(this,a,"f").set(e,s)},l=function(e){m(this,a,"f").has(e)&&(m(this,s,"m",d).call(this,e),k(`Stopped resimulating transaction ${e} every ${n.RESIMULATE_INTERVAL_MS} milliseconds`))},d=function(e){const t=m(this,a,"f").get(e);t&&(clearTimeout(t),m(this,a,"f").delete(e))},n.shouldResimulate=function(e,t){const{id:s}=t,a=function(e,t){const{id:s,txParams:a}=t,{txParams:r}=e;if(!r||(0,g.isEqual)(r,a))return!1;const i=Object.keys(a).filter((e=>a[e]!==r[e]));return k("Transaction parameters updated",{transactionId:s,updatedProperties:i,originalParams:r,newParams:a}),n.RESIMULATE_PARAMS.some((e=>i.includes(e)))}(e,t),r=function(e,t){const{securityAlertResponse:s}=e,{id:a,securityAlertResponse:r}=t;if((0,g.isEqual)(s,r))return!1;return k("Security alert updated",{transactionId:a,originalSecurityAlertResponse:s,newSecurityAlertResponse:r}),r?.result_type===n.BLOCKAID_RESULT_TYPE_MALICIOUS}(e,t),i=function(e,t){const{simulationData:n}=e,{simulationData:s,txParams:a}=t;if(!s||(0,g.isEqual)(n,s))return!1;return!w(a?.value??"0x0",s?.nativeBalanceChange?.difference??"0x0",!1,!1===s?.nativeBalanceChange?.isDecrease)}(e,t),o=a||r||i;let c;if(r||i){c=Math.floor(Date.now()/1e3)+n.BLOCK_TIME_ADDITIONAL_SECONDS}return o&&k("Transaction should be resimulated",{transactionId:s,blockTime:c,parametersUpdated:a,securityAlert:r,valueAndNativeBalanceMismatch:i}),{blockTime:c,resimulate:o}},n.hasSimulationDataChanged=function(e,t){if((0,g.isEqual)(e,t))return!1;if(T(e?.nativeBalanceChange,t?.nativeBalanceChange))return k("Simulation data native balance changed"),!0;if(e.tokenBalanceChanges.length!==t.tokenBalanceChanges.length)return!0;for(const n of e.tokenBalanceChanges){const e=t.tokenBalanceChanges.find((({address:e,id:t})=>e===n.address&&t===n.id));if(!e)return k("Missing new token balance",{address:n.address,id:n.id}),!0;if(T(n,e))return k("Simulation data token balance changed",{originalTokenBalanceChange:n,newTokenBalanceChange:e}),!0}return!1}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/ResimulateHelper.cjs"}],[2921,{"../logger.cjs":2926,"../utils/feature-flags.cjs":2932,"@metamask/utils":2974,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h,f,g,b=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},y=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.TransactionPoller=void 0;const S=e("@metamask/utils"),k=e("lodash"),T=e("../logger.cjs"),w=e("../utils/feature-flags.cjs"),v=(0,S.createModuleLogger)(T.projectLogger,"transaction-poller");n.TransactionPoller=class{constructor({blockTracker:e,chainId:t,messenger:n}){s.add(this),a.set(this,0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,void 0),u.set(this,void 0),l.set(this,void 0),d.set(this,!1),p.set(this,void 0),b(this,r,e,"f"),b(this,i,t,"f"),b(this,o,n,"f")}start(e){y(this,d,"f")||(b(this,u,e,"f"),b(this,d,!0,"f"),y(this,s,"m",m).call(this),v("Started"))}stop(){y(this,d,"f")&&(b(this,d,!1,"f"),b(this,u,undefined,"f"),b(this,a,0,"f"),b(this,l,undefined,"f"),y(this,s,"m",f).call(this),y(this,s,"m",g).call(this),v("Stopped"))}setPendingTransactions(e){const t=(y(this,l,"f")??[]).map((e=>e.id));b(this,l,e,"f");const n=e.map((e=>e.id)),r=!(0,k.isEqual)(t,n);y(this,d,"f")&&r&&(v("Detected new pending transactions",n),b(this,a,0,"f"),y(this,c,"f")&&(y(this,s,"m",g).call(this),y(this,s,"m",m).call(this)))}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,s=new WeakSet,m=function e(){if(!y(this,d,"f"))return;const{countMax:t,intervalMs:n}=(0,w.getAcceleratedPollingParams)(y(this,i,"f"),y(this,o,"f"));if(y(this,a,"f")>=t)return b(this,c,(e=>y(this,s,"m",h).call(this,!1,e)),"f"),y(this,r,"f").on("latest",y(this,c,"f")),void v("Added block tracker listener");y(this,s,"m",f).call(this),b(this,p,setTimeout((async()=>{await y(this,s,"m",h).call(this,!0),y(this,s,"m",e).call(this)}),n),"f")},h=async function(e,t){e?v("Accelerated interval",y(this,a,"f")+1):v("Block tracker interval",t);const n=t??await y(this,r,"f").getLatestBlock();await(y(this,u,"f")?.call(this,n)),e&&y(this,d,"f")&&b(this,a,y(this,a,"f")+1,"f")},f=function(){y(this,p,"f")&&(clearTimeout(y(this,p,"f")),b(this,p,undefined,"f"))},g=function(){y(this,c,"f")&&(y(this,r,"f").removeListener("latest",y(this,c,"f")),b(this,c,undefined,"f"))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/helpers/TransactionPoller.cjs"}],[2922,{"../logger.cjs":2926,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.CollectPublishHook=void 0;const d=e("@metamask/utils"),p=e("../logger.cjs"),m=(0,d.createModuleLogger)(p.projectLogger,"collect-publish-hook");n.CollectPublishHook=class{constructor(e){s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),u(this,a,[],"f"),u(this,o,(0,d.createDeferredPromise)(),"f"),u(this,r,[],"f"),u(this,i,e,"f")}getHook(){return l(this,s,"m",c).bind(this)}ready(){return l(this,o,"f").promise}success(e){if(m("Success",{transactionHashes:e}),e.length!==l(this,i,"f"))throw new Error("Transaction hash count mismatch");for(let t=0;t<l(this,a,"f").length;t++){const n=l(this,a,"f")[t],s=e[t];n.resolve({transactionHash:s})}}error(e){m("Error",{error:e});for(const t of l(this,a,"f"))t.reject(e)}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,s=new WeakSet,c=function(e,t){l(this,r,"f").push(t),m("Processing transaction",{transactionMeta:e,signedTx:t});const n=(0,d.createDeferredPromise)();return l(this,a,"f").push(n),l(this,r,"f").length===l(this,i,"f")&&(m("All transactions signed"),l(this,o,"f").resolve({signedTransactions:l(this,r,"f")})),n.promise}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/hooks/CollectPublishHook.cjs"}],[2923,{"../logger.cjs":2926,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ExtraTransactionsPublishHook=void 0;const u=e("@metamask/utils"),l=e("../logger.cjs"),d=(0,u.createModuleLogger)(l.projectLogger,"extra-transactions-publish-hook");n.ExtraTransactionsPublishHook=class{constructor({addTransactionBatch:e,transactions:t}){s.add(this),a.set(this,void 0),r.set(this,void 0),o(this,a,e,"f"),o(this,r,t,"f")}getHook(){return c(this,s,"m",i).bind(this)}},a=new WeakMap,r=new WeakMap,s=new WeakSet,i=async function(e,t){d("Publishing transaction as batch",{transactionMeta:e,signedTx:t});const{id:n,networkClientId:s,txParams:i}=e,o=i.from,l=i.to,p=i.data,m=i.value,h=i.gas,f=i.maxFeePerGas,g=i.maxPriorityFeePerGas,b=t,y=(0,u.createDeferredPromise)(),S=[{existingTransaction:{id:n,onPublish:({transactionHash:e})=>{y.resolve({transactionHash:e})},signedTransaction:b},params:{data:p,gas:h,maxFeePerGas:f,maxPriorityFeePerGas:g,to:l,value:m}},...c(this,r,"f").map((e=>({params:e})))];return d("Adding transaction batch",{from:o,networkClientId:s,transactions:S}),await c(this,a,"f").call(this,{from:o,networkClientId:s,transactions:S,disable7702:!0,disableHook:!1,disableSequential:!0}),y.promise}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/hooks/ExtraTransactionsPublishHook.cjs"}],[2924,{"../logger.cjs":2926,"@metamask/rpc-errors":2524,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p,m,h=this&&this.__classPrivateFieldSet||function(e,t,n,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,n):a?a.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SequentialPublishBatchHook=void 0;const g=e("@metamask/rpc-errors"),b=e("@metamask/utils"),y=e("../logger.cjs"),S=(0,b.createModuleLogger)(y.projectLogger,"sequential-publish-batch-hook");n.SequentialPublishBatchHook=class{constructor({publishTransaction:e,getTransaction:t,getPendingTransactionTracker:n,getEthQuery:u}){s.add(this),a.set(this,void 0),r.set(this,void 0),i.set(this,void 0),o.set(this,void 0),c.set(this,{}),h(this,a,e,"f"),h(this,r,t,"f"),h(this,i,u,"f"),h(this,o,n,"f")}getHook(){return f(this,s,"m",u).bind(this)}},a=new WeakMap,r=new WeakMap,i=new WeakMap,o=new WeakMap,c=new WeakMap,s=new WeakSet,u=async function({from:e,networkClientId:t,transactions:n}){S("Starting sequential publish batch hook",{from:e,networkClientId:t});const c=f(this,o,"f").call(this,t),u=[];for(const e of n)try{const n=f(this,r,"f").call(this,String(e.id)),o=await f(this,a,"f").call(this,f(this,i,"f").call(this,t),n);S("Transaction published",{transactionHash:o});const d={...n,hash:o},p=f(this,s,"m",l).call(this,c,d.id,d.hash);c.addTransactionToPoll(d),await p,u.push({transactionHash:o})}catch(t){throw S("Batch transaction failed",{transaction:e,error:t}),c.stop(),g.rpcErrors.internal("Failed to publish batch transaction")}return S("Sequential publish batch hook completed",{results:u}),c.stop(),{results:u}},l=async function(e,t,n){return new Promise(((a,r)=>{const i=f(this,s,"m",d).bind(this,t,n,a,e),o=f(this,s,"m",p).bind(this,t,n,r,e);f(this,c,"f")[t]={onConfirmed:i,onFailedOrDropped:o},e.hub.on("transaction-confirmed",i),e.hub.on("transaction-failed",o),e.hub.on("transaction-dropped",o)}))},d=function(e,t,n,a,r){r.id===e&&(S("Transaction confirmed",{transactionHash:t}),f(this,s,"m",m).call(this,a,e),n(r))},p=function(e,t,n,a,r,i){r.id===e&&(S("Transaction failed or dropped",{transactionHash:t,error:i}),f(this,s,"m",m).call(this,a,e),n(new Error(`Transaction ${t} failed or dropped.`)))},m=function(e,t){const n=f(this,c,"f")[t];e.hub.off("transaction-confirmed",n.onConfirmed),e.hub.off("transaction-failed",n.onFailedOrDropped),e.hub.off("transaction-dropped",n.onFailedOrDropped),delete f(this,c,"f")[t]}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/hooks/SequentialPublishBatchHook.cjs"}],[2925,{"./TransactionController.cjs":2902,"./constants.cjs":2905,"./helpers/AccountsApiRemoteTransactionSource.cjs":2914,"./types.cjs":2927,"./utils/gas-flow.cjs":2935,"./utils/history.cjs":2937,"./utils/prepare.cjs":2940,"./utils/transaction-type.cjs":2944,"./utils/utils.cjs":2945},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.HARDFORK=n.INCOMING_TRANSACTIONS_SUPPORTED_CHAIN_IDS=n.CHAIN_IDS=n.normalizeTransactionParams=n.isEIP1559Transaction=n.mergeGasFeeEstimates=n.determineTransactionType=n.MAX_TRANSACTION_HISTORY_LENGTH=n.DISPLAYED_TRANSACTION_HISTORY_PATHS=n.WalletDevice=n.UserFeeLevel=n.TransactionType=n.TransactionStatus=n.TransactionEnvelopeType=n.TransactionContainerType=n.SimulationTokenStandard=n.SimulationErrorCode=n.GasFeeEstimateType=n.GasFeeEstimateLevel=n.TransactionController=n.SPEED_UP_RATE=n.CANCEL_RATE=void 0;var s=e("./TransactionController.cjs");Object.defineProperty(n,"CANCEL_RATE",{enumerable:!0,get:function(){return s.CANCEL_RATE}}),Object.defineProperty(n,"SPEED_UP_RATE",{enumerable:!0,get:function(){return s.SPEED_UP_RATE}}),Object.defineProperty(n,"TransactionController",{enumerable:!0,get:function(){return s.TransactionController}});var a=e("./types.cjs");Object.defineProperty(n,"GasFeeEstimateLevel",{enumerable:!0,get:function(){return a.GasFeeEstimateLevel}}),Object.defineProperty(n,"GasFeeEstimateType",{enumerable:!0,get:function(){return a.GasFeeEstimateType}}),Object.defineProperty(n,"SimulationErrorCode",{enumerable:!0,get:function(){return a.SimulationErrorCode}}),Object.defineProperty(n,"SimulationTokenStandard",{enumerable:!0,get:function(){return a.SimulationTokenStandard}}),Object.defineProperty(n,"TransactionContainerType",{enumerable:!0,get:function(){return a.TransactionContainerType}}),Object.defineProperty(n,"TransactionEnvelopeType",{enumerable:!0,get:function(){return a.TransactionEnvelopeType}}),Object.defineProperty(n,"TransactionStatus",{enumerable:!0,get:function(){return a.TransactionStatus}}),Object.defineProperty(n,"TransactionType",{enumerable:!0,get:function(){return a.TransactionType}}),Object.defineProperty(n,"UserFeeLevel",{enumerable:!0,get:function(){return a.UserFeeLevel}}),Object.defineProperty(n,"WalletDevice",{enumerable:!0,get:function(){return a.WalletDevice}});var r=e("./utils/history.cjs");Object.defineProperty(n,"DISPLAYED_TRANSACTION_HISTORY_PATHS",{enumerable:!0,get:function(){return r.DISPLAYED_TRANSACTION_HISTORY_PATHS}}),Object.defineProperty(n,"MAX_TRANSACTION_HISTORY_LENGTH",{enumerable:!0,get:function(){return r.MAX_TRANSACTION_HISTORY_LENGTH}});var i=e("./utils/transaction-type.cjs");Object.defineProperty(n,"determineTransactionType",{enumerable:!0,get:function(){return i.determineTransactionType}});var o=e("./utils/gas-flow.cjs");Object.defineProperty(n,"mergeGasFeeEstimates",{enumerable:!0,get:function(){return o.mergeGasFeeEstimates}});var c=e("./utils/utils.cjs");Object.defineProperty(n,"isEIP1559Transaction",{enumerable:!0,get:function(){return c.isEIP1559Transaction}}),Object.defineProperty(n,"normalizeTransactionParams",{enumerable:!0,get:function(){return c.normalizeTransactionParams}});var u=e("./constants.cjs");Object.defineProperty(n,"CHAIN_IDS",{enumerable:!0,get:function(){return u.CHAIN_IDS}});var l=e("./helpers/AccountsApiRemoteTransactionSource.cjs");Object.defineProperty(n,"INCOMING_TRANSACTIONS_SUPPORTED_CHAIN_IDS",{enumerable:!0,get:function(){return l.SUPPORTED_CHAIN_IDS}});var d=e("./utils/prepare.cjs");Object.defineProperty(n,"HARDFORK",{enumerable:!0,get:function(){return d.HARDFORK}})}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/index.cjs"}],[2926,{"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.incomingTransactionsLogger=n.projectLogger=void 0;const s=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return s.createModuleLogger}}),n.projectLogger=(0,s.createProjectLogger)("transaction-controller"),n.incomingTransactionsLogger=(0,s.createModuleLogger)(n.projectLogger,"incoming-transactions")}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/logger.cjs"}],[2927,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,a,r,i,o,c,u,l,d,p;Object.defineProperty(n,"__esModule",{value:!0}),n.SimulationErrorCode=n.SimulationTokenStandard=n.GasFeeEstimateType=n.GasFeeEstimateLevel=n.UserFeeLevel=n.TransactionEnvelopeType=n.TransactionContainerType=n.TransactionType=n.WalletDevice=n.TransactionStatus=void 0,function(e){e.unapproved="unapproved",e.approved="approved",e.signed="signed",e.submitted="submitted",e.confirmed="confirmed",e.failed="failed",e.dropped="dropped",e.rejected="rejected",e.cancelled="cancelled"}(s||(n.TransactionStatus=s={})),function(e){e.MM_MOBILE="metamask_mobile",e.MM_EXTENSION="metamask_extension",e.OTHER="other_device"}(a||(n.WalletDevice=a={})),function(e){e.batch="batch",e.bridge="bridge",e.bridgeApproval="bridgeApproval",e.cancel="cancel",e.contractInteraction="contractInteraction",e.deployContract="contractDeployment",e.ethDecrypt="eth_decrypt",e.ethGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.gasPayment="gas_payment",e.incoming="incoming",e.lendingDeposit="lendingDeposit",e.lendingWithdraw="lendingWithdraw",e.personalSign="personal_sign",e.retry="retry",e.revokeDelegation="revokeDelegation",e.simpleSend="simpleSend",e.signTypedData="eth_signTypedData",e.smart="smart",e.stakingClaim="stakingClaim",e.stakingDeposit="stakingDeposit",e.stakingUnstake="stakingUnstake",e.swap="swap",e.swapAndSend="swapAndSend",e.swapApproval="swapApproval",e.tokenMethodApprove="approve",e.tokenMethodSafeTransferFrom="safetransferfrom",e.tokenMethodTransfer="transfer",e.tokenMethodTransferFrom="transferfrom",e.tokenMethodSetApprovalForAll="setapprovalforall",e.tokenMethodIncreaseAllowance="increaseAllowance"}(r||(n.TransactionType=r={})),function(e){e.EnforcedSimulations="enforcedSimulations"}(i||(n.TransactionContainerType=i={})),function(e){e.legacy="0x0",e.accessList="0x1",e.feeMarket="0x2",e.setCode="0x4"}(o||(n.TransactionEnvelopeType=o={})),function(e){e.CUSTOM="custom",e.DAPP_SUGGESTED="dappSuggested",e.MEDIUM="medium"}(c||(n.UserFeeLevel=c={})),function(e){e.Low="low",e.Medium="medium",e.High="high"}(u||(n.GasFeeEstimateLevel=u={})),function(e){e.FeeMarket="fee-market",e.Legacy="legacy",e.GasPrice="eth_gasPrice"}(l||(n.GasFeeEstimateType=l={})),function(e){e.erc20="erc20",e.erc721="erc721",e.erc1155="erc1155"}(d||(n.SimulationTokenStandard=d={})),function(e){e.ChainNotSupported="chain-not-supported",e.Disabled="disabled",e.InvalidResponse="invalid-response",e.Reverted="reverted"}(p||(n.SimulationErrorCode=p={}))}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/types.cjs"}],[2928,{"../api/simulation-api.cjs":2904,"../constants.cjs":2905,"../errors.cjs":2906,"../logger.cjs":2926,"../types.cjs":2927,"@ethersproject/abi":558,"@metamask/controller-utils":1559,"@metamask/metamask-eth-abis":2181,"@metamask/utils":2974,"bn.js":4045},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getBalanceChanges=n.SupportedToken=void 0;const a=e("@ethersproject/abi"),r=e("@metamask/controller-utils"),i=e("@metamask/metamask-eth-abis"),o=e("@metamask/utils"),c=s(e("bn.js")),u=e("../api/simulation-api.cjs"),l=e("../constants.cjs"),d=e("../errors.cjs"),p=e("../logger.cjs"),m=e("../types.cjs");var h;!function(e){e.ERC20="erc20",e.ERC721="erc721",e.ERC1155="erc1155",e.ERC20_WRAPPED="erc20Wrapped",e.ERC721_LEGACY="erc721Legacy"}(h||(n.SupportedToken=h={}));const f=(0,o.createModuleLogger)(p.projectLogger,"balance-changes"),g=["Transfer","TransferSingle","TransferBatch","Deposit","Withdrawal"],b={[h.ERC20]:{abi:i.abiERC20,standard:m.SimulationTokenStandard.erc20},[h.ERC721]:{abi:i.abiERC721,standard:m.SimulationTokenStandard.erc721},[h.ERC1155]:{abi:i.abiERC1155,standard:m.SimulationTokenStandard.erc1155},[h.ERC20_WRAPPED]:{abi:l.ABI_SIMULATION_ERC20_WRAPPED,standard:m.SimulationTokenStandard.erc20},[h.ERC721_LEGACY]:{abi:l.ABI_SIMULATION_ERC721_LEGACY,standard:m.SimulationTokenStandard.erc721}},y=["execution reverted","insufficient funds for gas"];function S(e){if(Array.isArray(e))return e.map(S);let t=e;return t=t.toHexString?.()??t,t=t.toLowerCase?.()??t,t}function k(e){return"Transfer"===e.name&&e.tokenStandard===m.SimulationTokenStandard.erc721&&0===parseInt(e.args.from,16)}function T(e){return e.tokenStandard===m.SimulationTokenStandard.erc721?[e.args.tokenId]:e.tokenStandard===m.SimulationTokenStandard.erc1155&&"TransferSingle"===e.name?[e.args.id]:e.tokenStandard===m.SimulationTokenStandard.erc1155&&"TransferBatch"===e.name?e.args.ids:[undefined]}function w(e){switch(e){case m.SimulationTokenStandard.erc721:return new a.Interface(i.abiERC721);case m.SimulationTokenStandard.erc1155:return new a.Interface(i.abiERC1155);default:return new a.Interface(i.abiERC20)}}function v(e,t,n){const s=w(t.standard);try{if(t.standard===m.SimulationTokenStandard.erc721){const t=s.decodeFunctionResult("ownerOf",n.return);return t[0].toLowerCase()===e.toLowerCase()?"0x1":"0x0"}const a=s.decodeFunctionResult("balanceOf",n.return);return(0,r.toHex)(a[0])}catch(e){throw f("Failed to decode balance transaction",e,{token:t,response:n}),new d.SimulationError(`Failed to decode balance transaction for token ${t.address}: ${String(e)}`)}}function E(e,t,n){const s=w(e);switch(e){case m.SimulationTokenStandard.erc721:return s.encodeFunctionData("ownerOf",[n]);case m.SimulationTokenStandard.erc1155:return s.encodeFunctionData("balanceOf",[t,n]);default:return s.encodeFunctionData("balanceOf",[t])}}function j(e){return[...e.logs??[],...(e.calls??[]).map((e=>j(e))).flat()]}function P(e,t,n=0){const s=(0,r.hexToBN)(t).add(new c.default(n)),a=(0,r.hexToBN)(e),i=s.sub(a),o=i.isNeg(),u=(0,r.toHex)(i.abs());return i.isZero()?(f("Balance change is zero"),undefined):{previousBalance:e,newBalance:(0,r.toHex)(s),difference:u,isDecrease:o}}async function I({request:e,params:t,before:n=[],after:s=[]}){const{blockTime:a,chainId:i,ethQuery:o,txParams:l}=e,{authorizationList:d}=l,p=l.from,m=d?.map((e=>({address:e.address,from:p}))),h=[...n,{authorizationList:m,data:l.data,from:l.from,gas:l.gas,maxFeePerGas:l.maxFeePerGas??l.gasPrice,maxPriorityFeePerGas:l.maxPriorityFeePerGas??l.gasPrice,to:l.to,value:l.value},...s],g=function(e){const{txParams:t}=e,n=(0,r.hexToBN)(t.gas??"0x0"),s=(0,r.hexToBN)(t.maxFeePerGas??t.gasPrice??"0x0"),a=(0,r.hexToBN)(t.value??"0x0"),i=(e.nestedTransactions??[]).map((e=>(0,r.hexToBN)(e.value??"0x0"))).reduce(((e,t)=>e.add(t)),new c.default(0));return n.mul(s).add(a).add(i)}(e),b=(0,r.toHex)(g);f("Required balance",b);const y=await(0,r.query)(o,"getBalance",[p,"latest"]),S=(0,r.hexToBN)(y);f("Current balance",y);const k=S.lt(g);return await(0,u.simulateTransactions)(i,{...t,transactions:h,withGas:!0,withDefaultBlockOverrides:!0,...a&&{blockOverrides:{...t?.blockOverrides,time:(0,r.toHex)(a)}},...k&&{overrides:{...t?.overrides,[p]:{...t?.overrides?.[p],balance:b}}}})}n.getBalanceChanges=async function(e){f("Request",e);try{const t=await I({request:e,params:{withCallTrace:!0,withLogs:!0}}),n=t.transactions?.[0]?.error;if(n)throw new d.SimulationError(n);const s=function(e,t){const n=t.transactions[0];if(!n)return undefined;const{txParams:s}=e,a=s.from,{stateDiff:r}=n,i=r?.pre?.[a]?.balance,o=r?.post?.[a]?.balance;if(!i||!o)return undefined;return P(i,o,n.gasCost)}(e,t),r=function(e){const t=j(e.transactions[0]?.callTrace??{});f("Extracted logs",t);const n=function(){const e=Object.values(h);return new Map(e.map((e=>{const{abi:t}=b[e];return[e,new a.Interface(t)]})))}();return t.map((e=>{const t=function(e,t){const n=Object.values(h);for(const s of n)try{const n=t.get(s),{abi:a,standard:r}=b[s];return{...n.parseLog(e),abi:a,standard:r}}catch(e){continue}return undefined}(e,n);if(!t)return f("Failed to parse log",e),undefined;const s=t.abi.find((e=>e.name===t.name))?.inputs;if(!s)return f("Failed to find inputs for event",t),undefined;if(!g.includes(t.name))return f("Ignoring unsupported event",t.name,t),undefined;f("Normalizing event args",t.name,t);const a=function(e,t){return e.reduce(((e,n,s)=>{const a=t[s].name.replace("_",""),r=S(n);return e[a]=r,e}),{})}(t.args,s);return{contractAddress:e.address,tokenStandard:t.standard,name:t.name,args:a,abi:t.abi}})).filter((e=>e!==undefined))}(t);f("Parsed events",r);const i=await async function(e,t){const{txParams:n}=e,s=n.from,a=function(e,t){const n=new Set,s=new Map,a=new Map,r=e.txParams.from,i=t.filter((e=>[e.args.from,e.args.to].includes(r)));f("Filtered user events",i);for(const e of i){const t=T(e);f("Extracted token IDs",t);for(const i of t){const t={address:e.contractAddress,standard:e.tokenStandard,id:i},o=JSON.stringify(t);if(n.has(o)){f("Ignoring additional event with same contract and token ID",t);continue}n.add(o);const c=E(e.tokenStandard,r,i),u={from:r,to:e.contractAddress,data:c};k(e)||s.set(t,u),a.set(t,u)}}return{before:s,after:a}}(e,t);f("Generated balance transactions",[...a.after.values()]);const r=a.before.size+a.after.size+1;if(1===r)return[];const i=await I({request:e,before:[...a.before.values()],after:[...a.after.values()]});if(f("Balance simulation response",i),i.transactions.length!==r)throw new d.SimulationInvalidResponseError;let o=0;return[...a.after.keys()].map(((e,t)=>{const n=P(!a.before.get(e)?"0x0":v(s,e,i.transactions[o++]),v(s,e,i.transactions[t+a.before.size+1]));return n?{...e,...n}:undefined})).filter((e=>e!==undefined))}(e,r);return{nativeBalanceChange:s,tokenBalanceChanges:i}}catch(t){f("Failed to get balance changes",t,e);let n=t;y.some((e=>n.message?.includes(e)))&&(n=new d.SimulationRevertedError);const{code:s,message:a}=n;return{tokenBalanceChanges:[],error:{code:s,message:a}}}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/balance-changes.cjs"}],[2929,{"../gas-flows/DefaultGasFeeFlow.cjs":2907,"../helpers/GasFeePoller.cjs":2915,"../hooks/CollectPublishHook.cjs":2922,"../hooks/SequentialPublishBatchHook.cjs":2924,"../index.cjs":2925,"../logger.cjs":2926,"../types.cjs":2927,"./eip7702.cjs":2930,"./feature-flags.cjs":2932,"./gas.cjs":2936,"./validation.cjs":2946,"@metamask/controller-utils":1559,"@metamask/rpc-errors":2524,"@metamask/utils":2974,uuid:5741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isAtomicBatchSupported=n.addTransactionBatch=n.ERROR_MESSAGE_NO_UPGRADE_CONTRACT=void 0;const s=e("@metamask/controller-utils"),a=e("@metamask/rpc-errors"),r=e("@metamask/utils"),i=e("uuid"),o=e("./eip7702.cjs"),c=e("./feature-flags.cjs"),u=e("./gas.cjs"),l=e("./validation.cjs"),d=e("../index.cjs"),p=e("../gas-flows/DefaultGasFeeFlow.cjs"),m=e("../helpers/GasFeePoller.cjs"),h=e("../hooks/CollectPublishHook.cjs"),f=e("../hooks/SequentialPublishBatchHook.cjs"),g=e("../logger.cjs"),b=e("../types.cjs"),y=(0,r.createModuleLogger)(g.projectLogger,"batch");function S(){const e=(0,i.v4)(),t=new Uint8Array((0,i.parse)(e));return(0,r.bytesToHex)(t)}async function k(e,t,n,s,a){const{existingTransaction:r,params:i}=t,{addTransaction:o,getTransaction:c,request:u,updateTransaction:l}=s,{from:p,networkClientId:h}=u;if(r){const{id:t,onPublish:s,signedTransaction:a}=r,o=c(t);return l({transactionId:t},(t=>{t.batchId=e})),n(o,a).then(s).catch((()=>{})),y("Processed existing transaction with hook",{id:t,params:i}),{id:t,params:i}}const f={...a,txParams:{...i,from:p,gas:a?.gas??i.gas}};a&&(0,m.updateTransactionGasEstimates)({txMeta:f,userFeeLevel:d.GasFeeEstimateLevel.Medium});const{transactionMeta:g}=await o(f.txParams,{batchId:e,disableGasBuffer:!0,networkClientId:h,publishHook:n,requireApproval:!1}),{id:b,txParams:S}=g,k={data:S.data,gas:S.gas,maxFeePerGas:S.maxFeePerGas,maxPriorityFeePerGas:S.maxPriorityFeePerGas,to:S.to,value:S.value};return y("Processed new transaction with hook",{id:b,params:k}),{id:b,params:k}}n.ERROR_MESSAGE_NO_UPGRADE_CONTRACT="Upgrade contract address not found",n.addTransactionBatch=async function(e){const{getInternalAccounts:t,messenger:r,request:i}=e,m=(0,c.getBatchSizeLimit)(r);if((0,l.validateBatchRequest)({internalAccounts:t(),request:i,sizeLimit:m}),y("Adding",i),!i.disable7702)try{return await async function(e){const{addTransaction:t,getChainId:s,messenger:r,publicKeyEIP7702:i,request:u}=e,{batchId:l,from:p,networkClientId:m,origin:h,requireApproval:f,securityAlertId:g,transactions:k,validateSecurity:T}=u,w=s(m),v=e.getEthQuery(m),E=(0,o.doesChainSupportEIP7702)(w,r);if(!E)throw y("Chain does not support EIP-7702",w),a.rpcErrors.internal("Chain does not support EIP-7702");if(!i)throw a.rpcErrors.internal(o.ERROR_MESSGE_PUBLIC_KEY);const{delegationAddress:j,isSupported:P}=await(0,o.isAccountUpgradedToEIP7702)(p,w,i,r,v);if(y("Account",{delegationAddress:j,isSupported:P}),!P&&j)throw y("Account upgraded to unsupported contract",p,j),a.rpcErrors.internal("Account upgraded to unsupported contract");const I=await Promise.all(k.map((e=>async function(e,t,n){const{from:s}=e,{params:a}=t,{type:r}=await(0,d.determineTransactionType)({from:s,...a},n);return{...a,type:r}}(u,e,v)))),_=(0,o.generateEIP7702BatchTransaction)(p,I),C={from:p,..._};if(!P){const e=(0,c.getEIP7702UpgradeContractAddress)(w,r,i);if(!e)throw a.rpcErrors.internal(n.ERROR_MESSAGE_NO_UPGRADE_CONTRACT);C.type=b.TransactionEnvelopeType.setCode,C.authorizationList=[{address:e}]}if(T){const e={method:"eth_sendTransaction",params:[{...C,authorizationList:undefined,type:b.TransactionEnvelopeType.feeMarket}],delegationMock:C.authorizationList?.[0]?.address,origin:h};y("Security request",e),T(e,w).catch((e=>{y("Security validation failed",e)}))}y("Adding batch transaction",C,m);const A=l??S(),x=g?{securityAlertId:g}:undefined,{result:O}=await t(C,{batchId:A,nestedTransactions:I,networkClientId:m,origin:h,requireApproval:f,securityAlertResponse:x,type:b.TransactionType.batch});return await O,{batchId:A}}(e)}catch(e){if(!(e instanceof a.JsonRpcError&&"Chain does not support EIP-7702"===e.message))throw e}return await async function(e){const{messenger:t,publishBatchHook:n,request:r,update:i}=e,{from:o,networkClientId:c,requireApproval:l,transactions:m}=r;let g;y("Adding transaction batch using hook",r);const b=new f.SequentialPublishBatchHook({publishTransaction:e.publishTransaction,getTransaction:e.getTransaction,getEthQuery:e.getEthQuery,getPendingTransactionTracker:e.getPendingTransactionTracker});let{disable7702:T,disableSequential:w}=r;const{disableHook:v,useHook:E}=r;E&&(T=!0,w=!0);let j,P=null;v?w||(P=b.getHook()):P=n;if(!P)throw y("No supported batch methods found",{disable7702:T,disableHook:v,disableSequential:w}),a.rpcErrors.internal("Can't process batch");const I=S(),_=m.length,C=new h.CollectPublishHook(_);try{l&&(j=await async function({batchId:e,request:t}){const{messenger:n,request:s,isSimulationEnabled:a,getGasFeeEstimates:r,update:i,getEthQuery:o,getChainId:c}=t,{from:l,origin:m,networkClientId:h,transactions:f}=s,g=o(h);if(!a())throw new Error("Cannot create transaction batch as simulation not supported");y("Preparing approval data for batch");const b=c(h),{gasLimit:S}=await(0,u.simulateGasBatch)({chainId:b,from:l,transactions:f}),k=(E={chainId:b,from:l,gas:S,id:e,networkClientId:h,origin:m,transactions:f},{...E,status:d.TransactionStatus.unapproved}),T=new p.DefaultGasFeeFlow,w=await r({networkClientId:h}),v=await T.getGasFees({ethQuery:g,gasFeeControllerData:w,messenger:n,transactionMeta:{...k,txParams:{from:l,gas:S},time:Date.now()}});var E;return k.gasFeeEstimates=v.estimates,y("Saving transaction batch metadata",k),function(e,t){t((t=>{t.transactionBatches=[...t.transactionBatches,e]}))}(k,i),k}({batchId:I,request:e}),g=(await async function(e,t){const n=String(e.id),{origin:a}=e,r=s.ApprovalType.TransactionBatch,i={txBatchId:n};return y("Requesting approval for transaction batch",n),await t.call("ApprovalController:addRequest",{id:n,origin:a||s.ORIGIN_METAMASK,requestData:i,expectsResult:!0,type:r},!0)}(j,t)).resultCallbacks);const n=C.getHook(),a=[];for(const t of m){const s=await k(I,t,n,e,j);a.push(s)}const{signedTransactions:r}=await C.ready(),i=a.map(((e,t)=>({...e,signedTx:r[t]})));y("Calling publish batch hook",{from:o,networkClientId:c,transactions:i});const h=await P({from:o,networkClientId:c,transactions:i});if(y("Publish batch hook result",h),!h)throw new Error("Publish batch hook did not return a result");const f=h.results.map((({transactionHash:e})=>e));return C.success(f),g?.success(),y("Completed batch transaction with hook",f),{batchId:I}}catch(e){throw y("Publish batch hook failed",e),C.error(e),g?.error(e),e}finally{y("Cleaning up publish batch hook",I),function(e,t){e((e=>{e.transactionBatches=e.transactionBatches.filter((e=>e.id!==t))}))}(i,I)}}(e)},n.isAtomicBatchSupported=async function(e){const{address:t,chainIds:n,getEthQuery:s,messenger:r,publicKeyEIP7702:i}=e;if(!i)throw a.rpcErrors.internal(o.ERROR_MESSGE_PUBLIC_KEY);const u=(0,c.getEIP7702SupportedChains)(r).filter((e=>!n||n.includes(e))),l=(await Promise.all(u.map((async e=>{try{const n=s(e),{isSupported:a,delegationAddress:u}=await(0,o.isAccountUpgradedToEIP7702)(t,e,i,r,n);return{chainId:e,delegationAddress:u,isSupported:a,upgradeContractAddress:(0,c.getEIP7702UpgradeContractAddress)(e,r,i)}}catch(t){return y("Error checking atomic batch support",e,t),undefined}})))).filter((e=>Boolean(e)));return y("Atomic batch supported results",l),l}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/batch.cjs"}],[2930,{"../constants.cjs":2905,"../logger.cjs":2926,"./feature-flags.cjs":2932,"@ethersproject/abi":558,"@ethersproject/contracts":581,"@metamask/controller-utils":1559,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.signAuthorizationList=n.generateEIP7702BatchTransaction=n.isAccountUpgradedToEIP7702=n.getDelegationAddress=n.doesChainSupportEIP7702=n.ERROR_MESSGE_PUBLIC_KEY=n.CALLS_SIGNATURE=n.BATCH_FUNCTION_NAME=n.DELEGATION_PREFIX=void 0;const s=e("@ethersproject/abi"),a=e("@ethersproject/contracts"),r=e("@metamask/controller-utils"),i=e("@metamask/utils"),o=e("./feature-flags.cjs"),c=e("../constants.cjs"),u=e("../logger.cjs");n.DELEGATION_PREFIX="0xef0100",n.BATCH_FUNCTION_NAME="execute",n.CALLS_SIGNATURE="(address,uint256,bytes)[]",n.ERROR_MESSGE_PUBLIC_KEY="EIP-7702 public key not specified";const l=["gas","maxFeePerGas","maxPriorityFeePerGas"],d=(0,i.createModuleLogger)(u.projectLogger,"eip-7702");async function p(e,t){const s=await(0,r.query)(t,"eth_getCode",[e]),a=(0,i.add0x)(s?.toLowerCase?.()??"");return 48===s?.length&&a.startsWith(n.DELEGATION_PREFIX)?(0,i.add0x)(a.slice(n.DELEGATION_PREFIX.length)):undefined}async function m(e,t,n,s){const a=function(e,t,n){const{chainId:s,nonce:a}=e,{txParams:i,chainId:o}=t,{nonce:c}=i,u=s??o;let l=a;l===undefined&&(l=(0,r.toHex)(parseInt(c,16)+1+n));const p={...e,chainId:u,nonce:l};return d("Prepared authorization",p),p}(e,t,s),{txParams:o}=t,{from:c}=o,{address:u,chainId:l,nonce:p}=a,m=parseInt(l,16),h=parseInt(p,16),f=await n.call("KeyringController:signEip7702Authorization",{chainId:m,contractAddress:u,from:c,nonce:h}),g=f.slice(0,66),b=(0,i.add0x)(f.slice(66,130)),y=parseInt(f.slice(130,132),16),S={address:u,chainId:l,nonce:p,r:g,s:b,yParity:(0,r.toHex)(y-27==0?0:1)};return d("Signed authorization",S),S}n.doesChainSupportEIP7702=function(e,t){return(0,o.getEIP7702SupportedChains)(t).some((t=>t.toLowerCase()===e.toLowerCase()))},n.getDelegationAddress=p,n.isAccountUpgradedToEIP7702=async function(e,t,n,s,a){const r=(0,o.getEIP7702ContractAddresses)(t,s,n),i=await p(e,a),c=Boolean(i&&r.some((e=>e.toLowerCase()===i.toLowerCase())));return{delegationAddress:i,isSupported:c}},n.generateEIP7702BatchTransaction=function(e,t){const r=a.Contract.getInterface(c.ABI_IERC7821),i=t.map((e=>{const{data:t,to:n,value:s}=e,a=l.filter((t=>e[t]!==undefined));if(a.length){const t=a.map((t=>`${t}: ${e[t]}`)).join(", ");throw new Error(`EIP-7702 batch transactions do not support gas parameters per call - ${t}`)}return[n??"0x0000000000000000000000000000000000000000",s??"0x0",t??"0x"]})),o="0x01".padEnd(66,"0"),u=s.defaultAbiCoder.encode([n.CALLS_SIGNATURE],[i]),p=r.encodeFunctionData(n.BATCH_FUNCTION_NAME,[o,u]);return d("Transaction data",p),{data:p,to:e}},n.signAuthorizationList=async function({authorizationList:e,messenger:t,transactionMeta:n}){if(!e)return undefined;const s=[];let a=0;for(const r of e){const e=await m(r,n,t,a);s.push(e),a+=1}return s}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/eip7702.cjs"}],[2931,{"../types.cjs":2927,"@metamask/rpc-errors":2524},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateConfirmedExternalTransaction=void 0;const s=e("@metamask/rpc-errors"),a=e("../types.cjs");n.validateConfirmedExternalTransaction=function(e,t,n){if(!e||!e.txParams)throw s.rpcErrors.invalidParams('"transactionMeta" or "transactionMeta.txParams" is missing');if(e.status!==a.TransactionStatus.confirmed)throw s.rpcErrors.invalidParams('External transaction status should be "confirmed"');const r=e.txParams.nonce;if(n&&n.length>0){if(n.find((e=>e.txParams?.nonce===r)))throw s.rpcErrors.invalidParams("External transaction nonce should not be in pending txs")}if(t&&t.length>0){if(t.find((e=>e.txParams?.nonce===r)))throw s.rpcErrors.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/external-transactions.cjs"}],[2932,{"../logger.cjs":2926,"./signature.cjs":2942,"./utils.cjs":2945,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getIncomingTransactionsPollingInterval=n.getGasEstimateBuffer=n.getGasEstimateFallback=n.getGasFeeRandomisation=n.getAcceleratedPollingParams=n.getBatchSizeLimit=n.getEIP7702UpgradeContractAddress=n.getEIP7702ContractAddresses=n.getEIP7702SupportedChains=n.FeatureFlag=void 0;const s=e("@metamask/utils"),a=e("./signature.cjs"),r=e("./utils.cjs"),i=e("../logger.cjs");var o;!function(e){e.EIP7702="confirmations_eip_7702",e.GasBuffer="confirmations_gas_buffer",e.IncomingTransactions="confirmations_incoming_transactions",e.Transactions="confirmations_transactions"}(o||(n.FeatureFlag=o={}));const c=(0,s.createModuleLogger)(i.projectLogger,"feature-flags");function u(e,t,n){const s=l(t);return(s?.[o.EIP7702]?.contracts?.[e.toLowerCase()]??[]).filter((t=>(0,a.isValidSignature)([t.address,(0,r.padHexToEvenLength)(e)],t.signature,n))).map((e=>e.address))}function l(e){const t=e.call("RemoteFeatureFlagController:getState").remoteFeatureFlags;return c("Retrieved feature flags",t),t}n.getEIP7702SupportedChains=function(e){const t=l(e);return t?.[o.EIP7702]?.supportedChains??[]},n.getEIP7702ContractAddresses=u,n.getEIP7702UpgradeContractAddress=function(e,t,n){return u(e,t,n)?.[0]},n.getBatchSizeLimit=function(e){const t=l(e);return t?.[o.Transactions]?.batchSizeLimit??10},n.getAcceleratedPollingParams=function(e,t){const n=l(t),s=n?.[o.Transactions]?.acceleratedPolling;return{countMax:s?.perChainConfig?.[e]?.countMax||s?.defaultCountMax||10,intervalMs:s?.perChainConfig?.[e]?.intervalMs||s?.defaultIntervalMs||3e3}},n.getGasFeeRandomisation=function(e){const t=l(e),n=t?.[o.Transactions]?.gasFeeRandomisation||{};return{randomisedGasFeeDigits:n.randomisedGasFeeDigits||{},preservedNumberOfDigits:n.preservedNumberOfDigits}},n.getGasEstimateFallback=function(e,t){const n=l(t),s=n?.[o.Transactions]?.gasEstimateFallback,a=s?.perChainConfig?.[e],r=a?.percentage??s?.default?.percentage??35;return{fixed:a?.fixed??s?.default?.fixed,percentage:r}},n.getGasEstimateBuffer=function({chainId:e,isCustomRPC:t,isUpgradeWithDataToSelf:n,messenger:s}){const a=l(s),r=a?.[o.GasBuffer],i=r?.perChainConfig?.[e],c=t?undefined:i?.included,u=t?undefined:r?.included;return(n?i?.eip7702:undefined)??c??i?.base??u??r?.default??1},n.getIncomingTransactionsPollingInterval=function(e){const t=l(e);return t?.[o.IncomingTransactions]?.pollingIntervalMs??24e4}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/feature-flags.cjs"}],[2933,{"../api/simulation-api.cjs":2904,"../logger.cjs":2926,"./batch.cjs":2929,"./eip7702.cjs":2930,"./feature-flags.cjs":2932,"@metamask/rpc-errors":2524,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getGasFeeTokens=void 0;const s=e("@metamask/rpc-errors"),a=e("@metamask/utils"),r=e("./batch.cjs"),i=e("./eip7702.cjs"),o=e("./feature-flags.cjs"),c=e("../api/simulation-api.cjs"),u=e("../logger.cjs"),l=(0,a.createModuleLogger)(u.projectLogger,"gas-fee-tokens");n.getGasFeeTokens=async function({chainId:e,isEIP7702GasFeeTokensEnabled:t,messenger:n,publicKeyEIP7702:a,transactionMeta:u}){const{delegationAddress:d,txParams:p}=u,{authorizationList:m}=p,h=p.data,f=p.from,g=p.to,b=p.value;l("Request",{chainId:e,txParams:p});const y=await t(u)&&(0,i.doesChainSupportEIP7702)(e,n);let S=m?.map((e=>({address:e.address,from:f})));!y||d||S||(S=function({chainId:e,from:t,messenger:n,publicKeyEIP7702:a}){if(!a)throw s.rpcErrors.internal(i.ERROR_MESSGE_PUBLIC_KEY);const c=(0,o.getEIP7702UpgradeContractAddress)(e,n,a);if(!c)throw s.rpcErrors.internal(r.ERROR_MESSAGE_NO_UPGRADE_CONTRACT);return[{address:c,from:t}]}({chainId:e,from:f,messenger:n,publicKeyEIP7702:a}));try{const t=await(0,c.simulateTransactions)(e,{transactions:[{authorizationList:S,data:h,from:f,to:g,value:b}],suggestFees:{withTransfer:!0,withFeeTransfer:!0,with7702:y}});l("Response",t);const n=function(e){const t=e.transactions?.[0]?.fees?.[0];return(t?.tokenFees??[]).map((e=>({amount:e.balanceNeededToken,balance:e.currentBalanceToken,decimals:e.token.decimals,fee:e.serviceFee,gas:t.gas,gasTransfer:e.transferEstimate,maxFeePerGas:t.maxFeePerGas,maxPriorityFeePerGas:t.maxPriorityFeePerGas,rateWei:e.rateWei,recipient:e.feeRecipient,symbol:e.token.symbol,tokenAddress:e.token.address})))}(t);return l("Gas fee tokens",n),n}catch(e){return l("Failed to gas fee tokens",e),[]}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas-fee-tokens.cjs"}],[2934,{"../logger.cjs":2926,"../types.cjs":2927,"./gas-flow.cjs":2935,"./swaps.cjs":2943,"@metamask/controller-utils":1559,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.gweiDecimalToWeiDecimal=n.gweiDecimalToWeiHex=n.updateGasFees=void 0;const s=e("@metamask/controller-utils"),a=e("@metamask/utils"),r=e("./gas-flow.cjs"),i=e("./swaps.cjs"),o=e("../logger.cjs"),c=e("../types.cjs"),u=(0,a.createModuleLogger)(o.projectLogger,"gas-fees");function l(e){return(0,s.toHex)((0,s.gweiDecToWEIBN)(e))}n.updateGasFees=async function(e){const{txMeta:t}=e,n={...t.txParams},o=i.SWAP_TRANSACTION_TYPES.includes(t.type)?undefined:e.getSavedGasFees(t.chainId),d=await async function(e){const{eip1559:t,ethQuery:n,gasFeeFlows:i,getGasFeeEstimates:o,messenger:l,txMeta:d}=e,{networkClientId:p}=d;if(!t&&d.txParams.gasPrice||t&&d.txParams.maxFeePerGas&&d.txParams.maxPriorityFeePerGas)return{};const m=(0,r.getGasFeeFlow)(d,i,l);try{const e=await o({networkClientId:p}),t=await m.getGasFees({ethQuery:n,gasFeeControllerData:e,messenger:l,transactionMeta:d}),s=t.estimates?.type;switch(s){case c.GasFeeEstimateType.FeeMarket:return t.estimates.medium;case c.GasFeeEstimateType.Legacy:return{gasPrice:t.estimates.medium};case c.GasFeeEstimateType.GasPrice:return{gasPrice:t.estimates.gasPrice};default:throw new Error(`Unsupported gas fee estimate type returned from flow: ${s}`)}}catch(e){u("Failed to get suggested gas fees",e)}const h=await(0,s.query)(n,"gasPrice");return{gasPrice:h?(0,a.add0x)(h.toString(16)):undefined}}(e);u("Suggested gas fees",d);const p={...e,initialParams:n,savedGasFees:o,suggestedGasFees:d};t.txParams.maxFeePerGas=function(e){const{savedGasFees:t,eip1559:n,initialParams:s,suggestedGasFees:a}=e;if(!n)return undefined;if(t){const e=l(t.maxBaseFee);return u("Using maxFeePerGas from savedGasFees",e),e}if(s.maxFeePerGas)return u("Using maxFeePerGas from request",s.maxFeePerGas),s.maxFeePerGas;if(s.gasPrice&&!s.maxPriorityFeePerGas)return u("Setting maxFeePerGas to gasPrice from request",s.gasPrice),s.gasPrice;if(a.maxFeePerGas)return u("Using suggested maxFeePerGas",a.maxFeePerGas),a.maxFeePerGas;if(a.gasPrice)return u("Setting maxFeePerGas to suggested gasPrice",a.gasPrice),a.gasPrice;return u("maxFeePerGas not set"),undefined}(p),t.txParams.maxPriorityFeePerGas=function(e){const{eip1559:t,initialParams:n,savedGasFees:s,suggestedGasFees:a,txMeta:r}=e;if(!t)return undefined;if(s){const e=l(s.priorityFee);return u("Using maxPriorityFeePerGas from savedGasFees.priorityFee",e),e}if(n.maxPriorityFeePerGas)return u("Using maxPriorityFeePerGas from request",n.maxPriorityFeePerGas),n.maxPriorityFeePerGas;if(n.gasPrice&&!n.maxFeePerGas)return u("Setting maxPriorityFeePerGas to gasPrice from request",n.gasPrice),n.gasPrice;if(a.maxPriorityFeePerGas)return u("Using suggested maxPriorityFeePerGas",a.maxPriorityFeePerGas),a.maxPriorityFeePerGas;if(r.txParams.maxFeePerGas)return u("Setting maxPriorityFeePerGas to maxFeePerGas",r.txParams.maxFeePerGas),r.txParams.maxFeePerGas;return u("maxPriorityFeePerGas not set"),undefined}(p),t.txParams.gasPrice=function(e){const{eip1559:t,initialParams:n,suggestedGasFees:s}=e;if(t)return undefined;if(n.gasPrice)return u("Using gasPrice from request",n.gasPrice),n.gasPrice;if(s.maxFeePerGas)return u("Using suggested maxFeePerGas",s.maxFeePerGas),s.maxFeePerGas;if(s.gasPrice)return u("Using suggested gasPrice",s.gasPrice),s.gasPrice;return u("gasPrice not set"),undefined}(p),t.userFeeLevel=function(e){const{initialParams:t,savedGasFees:n,suggestedGasFees:a,txMeta:r}=e;if(n)return c.UserFeeLevel.CUSTOM;if(!t.maxFeePerGas&&!t.maxPriorityFeePerGas&&t.gasPrice)return r.origin===s.ORIGIN_METAMASK?c.UserFeeLevel.CUSTOM:c.UserFeeLevel.DAPP_SUGGESTED;if(!t.maxFeePerGas&&!t.maxPriorityFeePerGas&&a.maxFeePerGas&&a.maxPriorityFeePerGas)return c.UserFeeLevel.MEDIUM;if(!t.maxFeePerGas&&!t.maxPriorityFeePerGas&&a.gasPrice)return c.UserFeeLevel.MEDIUM;if(r.origin===s.ORIGIN_METAMASK)return c.UserFeeLevel.MEDIUM;return c.UserFeeLevel.DAPP_SUGGESTED}(p),u("Updated gas fee properties",{maxFeePerGas:t.txParams.maxFeePerGas,maxPriorityFeePerGas:t.txParams.maxPriorityFeePerGas,gasPrice:t.txParams.gasPrice}),(t.txParams.maxFeePerGas||t.txParams.maxPriorityFeePerGas)&&delete t.txParams.gasPrice,t.txParams.gasPrice&&(delete t.txParams.maxFeePerGas,delete t.txParams.maxPriorityFeePerGas),function(e){e.defaultGasEstimates||(e.defaultGasEstimates={});e.defaultGasEstimates.maxFeePerGas=e.txParams.maxFeePerGas,e.defaultGasEstimates.maxPriorityFeePerGas=e.txParams.maxPriorityFeePerGas,e.defaultGasEstimates.gasPrice=e.txParams.gasPrice,e.defaultGasEstimates.estimateType=e.userFeeLevel}(t)},n.gweiDecimalToWeiHex=l,n.gweiDecimalToWeiDecimal=function(e){return(1e9*Number(e)).toString().split(".")[0]}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas-fees.cjs"}],[2935,{"../types.cjs":2927,"@metamask/controller-utils":1559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mergeGasFeeEstimates=n.getGasFeeFlow=void 0;const s=e("@metamask/controller-utils"),a=e("../types.cjs");function r(e,t){return(0,s.weiHexToGweiDec)(e[t])}n.getGasFeeFlow=function(e,t,n){return t.find((t=>t.matchesTransaction({transactionMeta:e,messenger:n})))},n.mergeGasFeeEstimates=function({gasFeeControllerEstimates:e,transactionGasFeeEstimates:t}){const n=t.type;return n===a.GasFeeEstimateType.FeeMarket?Object.values(a.GasFeeEstimateLevel).reduce(((n,a)=>{return{...n,[a]:(r=e?.[a],i=t[a],{...r,suggestedMaxFeePerGas:(0,s.weiHexToGweiDec)(i.maxFeePerGas),suggestedMaxPriorityFeePerGas:(0,s.weiHexToGweiDec)(i.maxPriorityFeePerGas)})};var r,i}),{...e}):n===a.GasFeeEstimateType.Legacy?Object.values(a.GasFeeEstimateLevel).reduce(((e,n)=>({...e,[n]:r(t,n)})),{}):n===a.GasFeeEstimateType.GasPrice?{gasPrice:(i=t,(0,s.weiHexToGweiDec)(i.gasPrice))}:e;var i}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas-flow.cjs"}],[2936,{"../api/simulation-api.cjs":2904,"../logger.cjs":2926,"../types.cjs":2927,"./eip7702.cjs":2930,"./feature-flags.cjs":2932,"@metamask/controller-utils":1559,"@metamask/utils":2974,"bn.js":4045},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.simulateGasBatch=n.addGasBuffer=n.estimateGas=n.updateGas=n.DUMMY_AUTHORIZATION_SIGNATURE=n.INTRINSIC_GAS=n.MAX_GAS_BLOCK_PERCENT=n.DEFAULT_GAS_MULTIPLIER=n.FIXED_GAS=n.log=void 0;const s=e("@metamask/controller-utils"),a=e("@metamask/utils"),r=e("bn.js"),i=e("./eip7702.cjs"),o=e("./feature-flags.cjs"),c=e("../api/simulation-api.cjs"),u=e("../logger.cjs"),l=e("../types.cjs");async function d({chainId:e,ethQuery:t,ignoreDelegationSignatures:r,isSimulationEnabled:i,messenger:c,txParams:u}){const d={...u},{authorizationList:p,data:f,from:g,value:b,to:y}=d;if(r&&!i)throw new Error("Gas estimation with ignored delegation signatures is not supported as simulation disabled");const{gasLimit:S,number:k}=await async function(e){return await(0,s.query)(e,"getBlockByNumber",["latest",!1])}(t),T=(0,s.hexToBN)(S),{percentage:w,fixed:v}=(0,o.getGasEstimateFallback)(e,c),E=v?(0,s.toHex)(v):(0,s.BNToHex)((0,s.fractionBN)(T,w,100));(0,n.log)("Estimation fallback values",E),d.data=f?(0,a.add0x)(f):f,d.value=b||"0x0",d.authorizationList=function(e,t){return e?.map((e=>({...e,chainId:e.chainId??t,nonce:e.nonce??"0x1",r:e.r??n.DUMMY_AUTHORIZATION_SIGNATURE,s:e.s??n.DUMMY_AUTHORIZATION_SIGNATURE,yParity:e.yParity??"0x1"})))}(d.authorizationList,e),delete d.gasPrice,delete d.maxFeePerGas,delete d.maxPriorityFeePerGas;let j,P=E;const I=u.type===l.TransactionEnvelopeType.setCode&&Boolean(p?.length)&&Boolean(f)&&"0x"!==f&&g?.toLowerCase()===y?.toLowerCase();try{P=i&&I?await async function(e,t,a){const r=await(0,s.query)(t,"estimateGas",[{...e,data:"0x"}]);(0,n.log)("Upgrade only gas",r);const i=e.authorizationList?.[0].address;let o;try{o=await m({chainId:a,delegationAddress:i,transaction:e})}catch(e){(0,n.log)("Error while simulating data portion of upgrade",e)}if(o===undefined){try{o=await h(t,{...e,authorizationList:undefined,type:undefined},i)}catch(e){throw(0,n.log)("Error while estimating data portion of upgrade",e),e}(0,n.log)("Success estimating data portion of upgrade",o)}(0,n.log)("Execute gas",o);const c=(0,s.BNToHex)((0,s.hexToBN)(r).add((0,s.hexToBN)(o)).subn(n.INTRINSIC_GAS));return(0,n.log)("Total type 4 gas",c),c}(d,t,e):r&&i?await m({chainId:e,transaction:d}):await h(t,d)}catch(e){j={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:k,blockGasLimit:S}},(0,n.log)("Estimation failed",{...j,fallback:E})}return{blockGasLimit:S,estimatedGas:P,isUpgradeWithDataToSelf:I,simulationFails:j}}function p(e,t,r){const i=(0,s.hexToBN)(e),o=(0,s.fractionBN)((0,s.hexToBN)(t),n.MAX_GAS_BLOCK_PERCENT,100),c=(0,s.fractionBN)(i,100*r,100);if(i.gt(o)){const t=(0,a.add0x)(e);return(0,n.log)("Using estimated value",t),t}if(c.lt(o)){const e=(0,a.add0x)((0,s.BNToHex)(c));return(0,n.log)("Using padded estimate",e,r),e}const u=(0,a.add0x)((0,s.BNToHex)(o));return(0,n.log)("Using 90% of block gas limit",u),u}async function m({chainId:e,delegationAddress:t,transaction:n}){const s=await(0,c.simulateTransactions)(e,{transactions:[{to:n.to,from:n.from,data:n.data,value:n.value}],overrides:{[n.from]:{code:t&&i.DELEGATION_PREFIX+(0,a.remove0x)(t)}}}),r=s?.transactions?.[0].gasLimit;if(!r)throw new Error("No simulated gas returned");return r}function h(e,t,n){const{from:r}=t,o=[t];return n&&(o.push("latest"),o.push({[r]:{code:i.DELEGATION_PREFIX+(0,a.remove0x)(n)}})),(0,s.query)(e,"estimateGas",o)}n.log=(0,a.createModuleLogger)(u.projectLogger,"gas"),n.FIXED_GAS="0x5208",n.DEFAULT_GAS_MULTIPLIER=1.5,n.MAX_GAS_BLOCK_PERCENT=90,n.INTRINSIC_GAS=21e3,n.DUMMY_AUTHORIZATION_SIGNATURE="0x1111111111111111111111111111111111111111111111111111111111111111",n.updateGas=async function(e){const{txMeta:t}=e,a={...t.txParams},[r,i,c]=await async function(e){const{chainId:t,isCustomNetwork:a,isSimulationEnabled:r,messenger:i,txMeta:c}=e,{disableGasBuffer:u}=c;if(c.txParams.gas)return(0,n.log)("Using value from request",c.txParams.gas),[c.txParams.gas,undefined,c.txParams.gas];if(await async function({ethQuery:e,txMeta:t,isCustomNetwork:n}){const{txParams:{to:a,data:r,type:i}}=t;if(n||!a||r||i===l.TransactionEnvelopeType.setCode)return!1;const o=await async function(e,t){return await(0,s.query)(e,"getCode",[t])}(e,a);return!o||"0x"===o}(e))return(0,n.log)("Using fixed value",n.FIXED_GAS),[n.FIXED_GAS,undefined,n.FIXED_GAS];const{blockGasLimit:m,estimatedGas:h,isUpgradeWithDataToSelf:f,simulationFails:g}=await d({chainId:e.chainId,ethQuery:e.ethQuery,isSimulationEnabled:r,messenger:i,txParams:c.txParams});(0,n.log)("Original estimated gas",h),g&&(0,n.log)("Using original fallback estimate as simulation failed");u&&(0,n.log)("Gas buffer disabled");if(g||u)return[h,g,h];const b=(0,o.getGasEstimateBuffer)({chainId:t,isCustomRPC:a,isUpgradeWithDataToSelf:f,messenger:i});(0,n.log)("Buffer",b);const y=p(h,m,b);return(0,n.log)("Buffered gas",y),[y,g,h]}(e);t.txParams.gas=r,t.simulationFails=i,t.gasLimitNoBuffer=c,a.gas||(t.originalGasEstimate=t.txParams.gas),t.defaultGasEstimates||(t.defaultGasEstimates={}),t.defaultGasEstimates.gas=t.txParams.gas},n.estimateGas=d,n.addGasBuffer=p,n.simulateGasBatch=async function({chainId:e,from:t,transactions:a}){try{const n=await(0,c.simulateTransactions)(e,{transactions:a.map((e=>({...e.params,from:t})))});if(!n?.transactions||n.transactions.length!==a.length)throw new Error("Simulation response does not match transaction count");const i=n.transactions.reduce(((e,t)=>{const n=t?.gasLimit;if(!n)throw new Error("No simulated gas returned for one of the transactions");return e.add((0,s.hexToBN)(n))}),new r.BN(0));return{gasLimit:(0,s.BNToHex)(i)}}catch(e){throw(0,n.log)("Error while simulating gas batch",e),new Error("Cannot estimate transaction batch total gas as simulation failed")}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/gas.cjs"}],[2937,{"fast-json-patch":4489,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateTransactionHistory=n.addInitialHistorySnapshot=n.DISPLAYED_TRANSACTION_HISTORY_PATHS=n.MAX_TRANSACTION_HISTORY_LENGTH=void 0;const a=s(e("fast-json-patch")),r=e("lodash");function i(e,t,n){const s=a.default.compare(e,t);return s[0]&&(n&&(s[0].note=n),s[0].timestamp=Date.now()),s}function o(e){return(0,r.cloneDeep)(e).reduce(((e,t)=>a.default.applyPatch(e,t).newDocument))}function c(e){const t={...e};return delete t.history,(0,r.cloneDeep)(t)}n.MAX_TRANSACTION_HISTORY_LENGTH=100,n.DISPLAYED_TRANSACTION_HISTORY_PATHS=["/status","/txParams/gasPrice","/txParams/gas","/estimatedBaseFee","/blockTimestamp"],n.addInitialHistorySnapshot=function(e){const t=c(e);return(0,r.merge)({},e,{history:[t]})},n.updateTransactionHistory=function(e,t){if(!e.history)return e;const s=c(e),a=i(o(e.history),s,t);if(0===a.length)return e;let u=[...e.history,a];return u.length>n.MAX_TRANSACTION_HISTORY_LENGTH&&(u=function(e){const t=e[0],s=e.slice(1),a=s.findIndex((e=>!e.some((({path:e})=>n.DISPLAYED_TRANSACTION_HISTORY_PATHS.includes(e)))));if(-1===a)return e;const r=a===s.length-1?a-1:a+1,c=Math.min(a,r),u=s[c],l=s[c+1],d=o([t,...s.slice(0,c)]),p=o([d,u,l]),m=i(d,p,`${String(u[0].note)}, ${String(l[0].note)}`);return s.splice(c,2,m),[t,...s]}(u)),(0,r.merge)({},e,{history:u})}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/history.cjs"}],[2938,{"../logger.cjs":2926,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionLayer1GasFee=n.updateTransactionLayer1GasFee=void 0;const s=e("@metamask/utils"),a=e("../logger.cjs"),r=(0,s.createModuleLogger)(a.projectLogger,"layer-1-gas-fee-flow");async function i({layer1GasFeeFlows:e,messenger:t,provider:n,transactionMeta:s}){const a=function(e,t,n){return t.find((t=>t.matchesTransaction({transactionMeta:e,messenger:n})))}(s,e,t);if(!a)return undefined;r("Found layer 1 gas fee flow",a.constructor.name,s.id);try{const{layer1Fee:e}=await a.getLayer1Fee({provider:n,transactionMeta:s});return e}catch(e){return r("Failed to get layer 1 gas fee",s.id,e),undefined}}n.updateTransactionLayer1GasFee=async function(e){const t=await i(e);if(!t)return;const{transactionMeta:n}=e;n.layer1GasFee=t,r("Updated layer 1 gas fee",t,n.id)},n.getTransactionLayer1GasFee=i}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/layer1-gas-fee-flow.cjs"}],[2939,{"../logger.cjs":2926,"@metamask/controller-utils":1559},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAndFormatTransactionsForNonceTracker=n.getNextNonce=void 0;const s=e("@metamask/controller-utils"),a=e("../logger.cjs"),r=(0,a.createModuleLogger)(a.projectLogger,"nonce");n.getNextNonce=async function(e,t){const{customNonceValue:n,isExternalSign:a,txParams:{from:i,nonce:o}}=e;if(a)return[undefined,undefined];const c=n?(0,s.toHex)(n):undefined;if(c)return r("Using custom nonce",c),[c,undefined];if(o)return r("Using existing nonce",o),[o,undefined];const u=await t(i),l=(0,s.toHex)(u.nextNonce),d=u.releaseLock.bind(u);return r("Using nonce from nonce tracker",l,u.nonceDetails),[l,d]},n.getAndFormatTransactionsForNonceTracker=function(e,t,n,s){return s.filter((({chainId:s,isTransfer:a,isUserOperation:r,status:i,txParams:{from:o}})=>!a&&!r&&s===e&&n.includes(i)&&o.toLowerCase()===t.toLowerCase())).map((({status:e,txParams:{from:t,gas:n,value:s,nonce:a}})=>({status:e,history:[{}],txParams:{from:t??"",gas:n??"",value:s??"",nonce:a??""}})))}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/nonce.cjs"}],[2940,{"@ethereumjs/common":499,"@ethereumjs/tx":516,"@metamask/utils":2974,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.serializeTransaction=n.prepareTransaction=n.HARDFORK=void 0;const s=e("@ethereumjs/common"),a=e("@ethereumjs/tx"),r=e("@metamask/utils"),i=e("lodash");function o(e){const t={chainId:parseInt(e,16),defaultHardfork:n.HARDFORK};return s.Common.custom(t,{eips:[7702]})}function c(e){return e?"0x0"===e?"0x":e.replace?.(/^0x(00)+/u,"0x")??e:e}n.HARDFORK=s.Hardfork.Prague,n.prepareTransaction=function(e,t){const n=function(e){const t=(0,i.cloneDeep)(e);return function(e){if(!e)return;for(const t of e)t.nonce=c(t.nonce),t.r=c(t.r),t.s=c(t.s),t.yParity=c(t.yParity)}(t.authorizationList),t}(t);return a.TransactionFactory.fromTxData(n,{freeze:!1,common:o(e)})},n.serializeTransaction=function(e){return(0,r.bytesToHex)(e.serialize())}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/prepare.cjs"}],[2941,{"@metamask/controller-utils":1559,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionParamsWithIncreasedGasFee=void 0;const s=e("@metamask/controller-utils"),a=e("@metamask/utils");function r(e,t){const n=(0,s.convertHexToDecimal)(e),r=parseInt(""+n*t,10);return(0,a.add0x)(r.toString(16))}n.getTransactionParamsWithIncreasedGasFee=function(e,t,n){const s=function(e,t,n){if(n&&"gasPrice"in n)return n.gasPrice;const s=e.gasPrice;if(!s||"0x0"===s)return undefined;return r(s,t)}(e,t,n),a=function(e,t,n){if(n&&"maxFeePerGas"in n&&"maxPriorityFeePerGas"in n)return n;const s=e.maxFeePerGas,a=e.maxPriorityFeePerGas;if(!s||!a||"0x0"===s||"0x0"===a)return undefined;const i=r(s,t),o=r(a,t);return{maxFeePerGas:i,maxPriorityFeePerGas:o}}(e,t,n);if(a){const t={...e,...a};return delete t.gasPrice,t}if(s){const t={...e,gasPrice:s};return delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,t}throw new Error("Cannot increase gas fee as no current values and no new values were provided")}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/retry.cjs"}],[2942,{"@ethersproject/wallet":654,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isValidSignature=void 0;const s=e("@ethersproject/wallet"),a=e("@metamask/utils");n.isValidSignature=function(e,t,n){try{const r=(0,a.add0x)(e.map(a.remove0x).join("")),i=(0,a.hexToBytes)(r);return(0,s.verifyMessage)(i,t).toLowerCase()===n.toLowerCase()}catch{return!1}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/signature.cjs"}],[2943,{"../constants.cjs":2905,"../logger.cjs":2926,"../types.cjs":2927,"./utils.cjs":2945,"@metamask/controller-utils":1559,lodash:4912},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.updatePostTransactionBalance=n.updateSwapsTransaction=n.SWAP_TRANSACTION_TYPES=n.SWAPS_CHAINID_DEFAULT_TOKEN_MAP=n.DEFAULT_TOKEN_ADDRESS=n.UPDATE_POST_TX_BALANCE_ATTEMPTS=n.UPDATE_POST_TX_BALANCE_TIMEOUT=void 0;const s=e("@metamask/controller-utils"),a=e("lodash"),r=e("./utils.cjs"),i=e("../constants.cjs"),o=e("../logger.cjs"),c=e("../types.cjs"),u=(0,o.createModuleLogger)(o.projectLogger,"swaps");n.UPDATE_POST_TX_BALANCE_TIMEOUT=5e3,n.UPDATE_POST_TX_BALANCE_ATTEMPTS=6;n.DEFAULT_TOKEN_ADDRESS="0x0000000000000000000000000000000000000000";const l={name:"Ether",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},d={name:"Binance Coin",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},p={name:"Matic",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},m={name:"Avalanche",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},h={name:"Test Ether",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},f={name:"Ether",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18},g={...l},b={...l},y={...l},S={name:"Sei",address:n.DEFAULT_TOKEN_ADDRESS,decimals:18};function k(e,t){return!(!e||!t)&&e===n.SWAPS_CHAINID_DEFAULT_TOKEN_MAP[t]?.address}function T(e){return new Promise((t=>setTimeout(t,e)))}n.SWAPS_CHAINID_DEFAULT_TOKEN_MAP={[i.CHAIN_IDS.MAINNET]:l,"0x539":h,[i.CHAIN_IDS.BSC]:d,[i.CHAIN_IDS.POLYGON]:p,[i.CHAIN_IDS.GOERLI]:f,[i.CHAIN_IDS.AVALANCHE]:m,[i.CHAIN_IDS.OPTIMISM]:b,[i.CHAIN_IDS.ARBITRUM]:g,[i.CHAIN_IDS.ZKSYNC_ERA]:y,[i.CHAIN_IDS.SEI]:S},n.SWAP_TRANSACTION_TYPES=[c.TransactionType.swap,c.TransactionType.swapAndSend,c.TransactionType.swapApproval],n.updateSwapsTransaction=function(e,t,s,{isSwapsDisabled:i,cancelTransaction:o,messenger:u}){if(i||!n.SWAP_TRANSACTION_TYPES.includes(t))return e;if(t===c.TransactionType.swap&&!1===s?.hasApproveTx&&e.simulationFails)throw o(e.id),new Error("Simulation failed");const l=s?.meta;if(!l)return e;let d=e;return t===c.TransactionType.swapApproval&&(d=function(e,{type:t,sourceTokenSymbol:n}){(0,r.validateIfTransactionUnapproved)(e,"updateSwapApprovalTransaction");let s={type:t,sourceTokenSymbol:n};return s=(0,a.pickBy)({type:t,sourceTokenSymbol:n}),(0,a.merge)({},e,s)}(e,l),u.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:d})),t===c.TransactionType.swapAndSend&&(d=function(e,{approvalTxId:t,destinationTokenAddress:n,destinationTokenAmount:s,destinationTokenDecimals:i,destinationTokenSymbol:o,estimatedBaseFee:c,sourceTokenAddress:u,sourceTokenAmount:l,sourceTokenDecimals:d,sourceTokenSymbol:p,swapAndSendRecipient:m,swapMetaData:h,swapTokenValue:f,type:g}){(0,r.validateIfTransactionUnapproved)(e,"updateSwapTransaction");let b={approvalTxId:t,destinationTokenAddress:n,destinationTokenAmount:s,destinationTokenDecimals:i,destinationTokenSymbol:o,estimatedBaseFee:c,sourceTokenAddress:u,sourceTokenAmount:l,sourceTokenDecimals:d,sourceTokenSymbol:p,swapAndSendRecipient:m,swapMetaData:h,swapTokenValue:f,type:g};return b=(0,a.pickBy)(b),(0,a.merge)({},e,b)}(e,l),u.publish("TransactionController:transactionNewSwapAndSend",{transactionMeta:d})),t===c.TransactionType.swap&&(d=function(e,{sourceTokenSymbol:t,destinationTokenSymbol:n,type:s,destinationTokenDecimals:i,destinationTokenAddress:o,swapMetaData:c,swapTokenValue:u,estimatedBaseFee:l,approvalTxId:d}){(0,r.validateIfTransactionUnapproved)(e,"updateSwapTransaction");let p={sourceTokenSymbol:t,destinationTokenSymbol:n,type:s,destinationTokenDecimals:i,destinationTokenAddress:o,swapMetaData:c,swapTokenValue:u,estimatedBaseFee:l,approvalTxId:d};return p=(0,a.pickBy)(p),(0,a.merge)({},e,p)}(e,l),u.publish("TransactionController:transactionNewSwap",{transactionMeta:d})),d},n.updatePostTransactionBalance=async function(e,{ethQuery:t,getTransaction:a,updateTransaction:r}){u("Updating post transaction balance",e.id);const i=e.id;let o,c;for(let r=0;r<n.UPDATE_POST_TX_BALANCE_ATTEMPTS;r++){u("Querying balance",{attempt:r});const l=await(0,s.query)(t,"getBalance",[e.txParams.from]);o={...a(i)??{}},c=o.approvalTxId?a(o.approvalTxId):undefined,o.postTxBalance=l.toString(16);const d=k(e.destinationTokenAddress,e.chainId);if(!d||e.preTxBalance!==o.postTxBalance){u("Finishing post balance update",{isDefaultTokenAddress:d,preTxBalance:e.preTxBalance,postTxBalance:o.postTxBalance});break}u("Waiting for balance to update",{delay:n.UPDATE_POST_TX_BALANCE_TIMEOUT}),await T(n.UPDATE_POST_TX_BALANCE_TIMEOUT)}return r(o,"TransactionController#updatePostTransactionBalance - Add post transaction balance"),u("Completed post balance update",o?.postTxBalance),{updatedTransactionMeta:o,approvalTransactionMeta:c}}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/swaps.cjs"}],[2944,{"../types.cjs":2927,"./eip7702.cjs":2930,"@ethersproject/abi":558,"@metamask/controller-utils":1559,"@metamask/metamask-eth-abis":2181},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.determineTransactionType=n.ESTIMATE_GAS_ERROR=void 0;const s=e("@ethersproject/abi"),a=e("@metamask/controller-utils"),r=e("@metamask/metamask-eth-abis"),i=e("./eip7702.cjs"),o=e("../types.cjs");n.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error";const c=new s.Interface(r.abiERC20),u=new s.Interface(r.abiERC721),l=new s.Interface(r.abiERC1155),d=new s.Interface(r.abiFiatTokenV2);n.determineTransactionType=async function(e,t){const{data:n,to:s}=e;if(n&&!s)return{type:o.TransactionType.deployContract,getCodeResponse:undefined};let r,p=Boolean(n?.length);if(t){const e=await async function(e,t){let n;try{n=await(0,a.query)(e,"getCode",[t])}catch(e){n=null}const s=!!n&&("0x"!==n&&"0x0"!==n&&!n.startsWith(i.DELEGATION_PREFIX));return{contractCode:n,isContractAddress:s}}(t,s);r=e.contractCode,p=e.isContractAddress}if(!p)return{type:o.TransactionType.simpleSend,getCodeResponse:r};const m=0!==Number(e.value??"0"),h={type:o.TransactionType.contractInteraction,getCodeResponse:r};if(!n||m)return h;const f=function(e){if(!e||e.length<10)return undefined;const t=e.substring(0,10);for(const e of[c,u,l,d])try{return e.getFunction(t).name}catch{}return undefined}(n);if(!f)return h;const g=[o.TransactionType.tokenMethodApprove,o.TransactionType.tokenMethodSetApprovalForAll,o.TransactionType.tokenMethodTransfer,o.TransactionType.tokenMethodTransferFrom,o.TransactionType.tokenMethodSafeTransferFrom,o.TransactionType.tokenMethodIncreaseAllowance].find((e=>e.toLowerCase()===f.toLowerCase()));return g?{type:g,getCodeResponse:r}:h}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/transaction-type.cjs"}],[2945,{"../types.cjs":2927,"@metamask/utils":2974,"bn.js":4045},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.setEnvelopeType=n.getPercentageChange=n.padHexToEvenLength=n.normalizeGasFeeValues=n.normalizeTxError=n.validateIfTransactionUnapproved=n.validateGasValues=n.isEIP1559Transaction=n.normalizeTransactionParams=n.ESTIMATE_GAS_ERROR=void 0;const a=e("@metamask/utils"),r=s(e("bn.js")),i=e("../types.cjs");n.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error";const o={accessList:e=>e,authorizationList:e=>e,data:e=>(0,a.add0x)(u(e)),from:e=>(0,a.add0x)(e).toLowerCase(),gas:e=>(0,a.add0x)(e),gasLimit:e=>(0,a.add0x)(e),gasPrice:e=>(0,a.add0x)(e),nonce:e=>(0,a.add0x)(e),to:e=>(0,a.add0x)(e).toLowerCase(),value:e=>(0,a.add0x)(e),maxFeePerGas:e=>(0,a.add0x)(e),maxPriorityFeePerGas:e=>(0,a.add0x)(e),estimatedBaseFee:e=>(0,a.add0x)(e),type:e=>(0,a.add0x)(e)};n.normalizeTransactionParams=function(e){const t={from:""};for(const n of(0,a.getKnownPropertyNames)(o))e[n]&&(t[n]=o[n](e[n]));return t.value||(t.value="0x0"),t.gasLimit&&!t.gas&&(t.gas=t.gasLimit),t},n.isEIP1559Transaction=function(e){const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);return t(e,"maxFeePerGas")&&t(e,"maxPriorityFeePerGas")};function c(e){try{return JSON.parse(JSON.stringify(e)),!0}catch{return!1}}function u(e){const t=e.toLowerCase().startsWith("0x")?e.slice(0,2):"",n=t?e.slice(2):e;return t+(n.length%2==0?n:`0${n}`)}n.validateGasValues=e=>{Object.keys(e).forEach((t=>{const n=e[t];if("string"!=typeof n||!(0,a.isStrictHexString)(n))throw new TypeError(`expected hex string for ${t} but received: ${n}`)}))},n.validateIfTransactionUnapproved=function(e,t){if(e?.status!==i.TransactionStatus.unapproved)throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n      Current tx status: ${e?.status}`)},n.normalizeTxError=function(e){return{name:e.name,message:e.message,stack:e.stack,code:e.code,rpc:c(e.value)?e.value:undefined}},n.normalizeGasFeeValues=function(e){const t=e=>"string"==typeof e?(0,a.add0x)(e):e;return"gasPrice"in e?{gasPrice:t(e.gasPrice)}:{maxFeePerGas:t(e.maxFeePerGas),maxPriorityFeePerGas:t(e.maxPriorityFeePerGas)}},n.padHexToEvenLength=u,n.getPercentageChange=function(e,t){const n=new r.default(10).pow(new r.default(18)),s=e.mul(n),a=t.mul(n),i=a.sub(s);return i.isZero()?0:s.isZero()&&!a.isZero()?100:i.muln(100).div(s).abs().toNumber()},n.setEnvelopeType=function(e,t){e.accessList?e.type=i.TransactionEnvelopeType.accessList:e.authorizationList?e.type=i.TransactionEnvelopeType.setCode:e.type=t?i.TransactionEnvelopeType.feeMarket:i.TransactionEnvelopeType.legacy}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/utils.cjs"}],[2946,{"../types.cjs":2927,"./utils.cjs":2945,"@ethersproject/abi":558,"@metamask/controller-utils":1559,"@metamask/metamask-eth-abis":2181,"@metamask/rpc-errors":2524,"@metamask/utils":2974},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBatchRequest=n.validateParamTo=n.validateTxParams=n.validateTransactionOrigin=n.ErrorCode=void 0;const s=e("@ethersproject/abi"),a=e("@metamask/controller-utils"),r=e("@metamask/metamask-eth-abis"),i=e("@metamask/rpc-errors"),o=e("@metamask/utils"),c=e("./utils.cjs"),u=e("../types.cjs");var l;!function(e){e[e.DuplicateBundleId=5720]="DuplicateBundleId",e[e.BundleTooLarge=5740]="BundleTooLarge",e[e.RejectedUpgrade=5750]="RejectedUpgrade"}(l||(n.ErrorCode=l={}));const d=[u.TransactionEnvelopeType.feeMarket,u.TransactionEnvelopeType.setCode];function p(e,t){const n=e.type;switch(t){case"authorizationList":if(n&&n!==u.TransactionEnvelopeType.setCode)throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${n}" but including authorizationList requires type: "${u.TransactionEnvelopeType.setCode}"`);break;case"maxFeePerGas":case"maxPriorityFeePerGas":if(n&&!d.includes(n))throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${n}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${d.join(", ")}"`);break;default:if(n&&d.includes(n))throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${n}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function m(e,t,n){if(void 0!==e[n])throw i.rpcErrors.invalidParams(`Invalid transaction params: specified ${t} but also included ${n}, these cannot be mixed`)}function h(e,t){const n=e[t];if("string"!=typeof n||!(0,o.isStrictHexString)(n))throw i.rpcErrors.invalidParams(`Invalid transaction params: ${String(t)} is not a valid hexadecimal string. got: (${String(n)})`)}function f(e){h(e,"address"),function(e,t,n){const s=(0,o.remove0x)(e).length/2;if(s!==t)throw i.rpcErrors.invalidParams(`Invalid transaction params: ${n} must be ${t} bytes. got: ${s} bytes`)}(e.address,20,"address");for(const t of["chainId","nonce","r","s"])e[t]&&h(e,t);const{yParity:t}=e;if(t&&!["0x0","0x1"].includes(t))throw i.rpcErrors.invalidParams(`Invalid transaction params: yParity must be '0x0' or '0x1'. got: ${t}`)}n.validateTransactionOrigin=async function({data:e,from:t,internalAccounts:n,origin:s,permittedAddresses:r,txParams:o,type:c}){if(!s||s===a.ORIGIN_METAMASK)return;const{authorizationList:l,to:d,type:p}=o;if(r&&!r.includes(t))throw i.providerErrors.unauthorized({data:{origin:s}});if(c===u.TransactionType.batch)return;if(l||p===u.TransactionEnvelopeType.setCode)throw i.rpcErrors.invalidParams("External EIP-7702 transactions are not supported");if(Boolean(e&&"0x"!==e)&&n?.some((e=>e.toLowerCase()===d?.toLowerCase())))throw i.rpcErrors.invalidParams("External transactions to internal accounts cannot include data")},n.validateTxParams=function(e,t=!0,n){!function(e){if(e&&!Object.values(u.TransactionEnvelopeType).includes(e))throw i.rpcErrors.invalidParams(`Invalid transaction envelope type: "${e}". Must be one of: ${Object.values(u.TransactionEnvelopeType).join(", ")}`)}(e.type),function(e,t){if((0,c.isEIP1559Transaction)(e)&&!t)throw i.rpcErrors.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559")}(e,t),function(e){if(!e||"string"!=typeof e)throw i.rpcErrors.invalidParams(`Invalid "from" address ${e}: not a string.`);if(!(0,a.isValidHexAddress)(e))throw i.rpcErrors.invalidParams('Invalid "from" address.')}(e.from),function(e){if("0x"===e.to||e.to===undefined){if(!e.data)throw i.rpcErrors.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,a.isValidHexAddress)(e.to))throw i.rpcErrors.invalidParams('Invalid "to" address.')}(e),function(e){if(e!==undefined){if(e.includes("-"))throw i.rpcErrors.invalidParams(`Invalid transaction value "${e}": not a positive number.`);if(e.includes("."))throw i.rpcErrors.invalidParams(`Invalid transaction value "${e}": number must be in wei.`);const t=parseInt(e,10);if(!(Number.isFinite(t)&&!Number.isNaN(t)&&!isNaN(Number(e))&&Number.isSafeInteger(t)))throw i.rpcErrors.invalidParams(`Invalid transaction value ${e}: number must be a valid number.`)}}(e.value),function(e){if(e){const t=new s.Interface(r.abiERC20);try{t.parseTransaction({data:e})}catch(e){if(e.message.match(/BUFFER_OVERRUN/u))throw i.rpcErrors.invalidParams("Invalid transaction params: data out-of-bounds, BUFFER_OVERRUN.")}}}(e.data),function(e,t){if(e&&t&&e.toLowerCase?.()!==t.toLowerCase())throw i.rpcErrors.invalidParams(`Invalid transaction params: chainId must match the network client, got: ${e}, expected: ${t}`)}(e.chainId,n),function(e){e.gasPrice&&(p(e,"gasPrice"),m(e,"gasPrice","maxFeePerGas"),m(e,"gasPrice","maxPriorityFeePerGas"),h(e,"gasPrice"));e.maxFeePerGas&&(p(e,"maxFeePerGas"),m(e,"maxFeePerGas","gasPrice"),h(e,"maxFeePerGas"));e.maxPriorityFeePerGas&&(p(e,"maxPriorityFeePerGas"),m(e,"maxPriorityFeePerGas","gasPrice"),h(e,"maxPriorityFeePerGas"));e.gasLimit&&h(e,"gasLimit");e.gas&&h(e,"gas")}(e),function(e){const{authorizationList:t}=e;if(!t)return;if(p(e,"authorizationList"),!Array.isArray(t))throw i.rpcErrors.invalidParams("Invalid transaction params: authorizationList must be an array");for(const e of t)f(e)}(e)},n.validateParamTo=function(e){if(!e||"string"!=typeof e)throw i.rpcErrors.invalidParams('Invalid "to" address')},n.validateBatchRequest=function({internalAccounts:e,request:t,sizeLimit:n}){const{origin:s}=t,r=s&&s!==a.ORIGIN_METAMASK,o=e.map((e=>e.toLowerCase()));if(r&&t.transactions.some((e=>{const t=e.params.to?.toLowerCase(),n=e.params.data,s=o.includes(t),a=Boolean(n&&"0x"!==n);return s&&a})))throw i.rpcErrors.invalidParams("External calls to internal accounts cannot include data");if(r&&t.transactions.length>n)throw new i.JsonRpcError(l.BundleTooLarge,`Batch size cannot exceed ${n}. got: ${t.transactions.length}`)}}}},{package:"@metamask/transaction-controller",file:"node_modules/@metamask/transaction-controller/dist/utils/validation.cjs"}],[2964,{"./errors.cjs":2972,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertExhaustive=n.assertStruct=n.assert=n.AssertionError=void 0;const s=e("@metamask/superstruct"),a=e("./errors.cjs");function r(e,t){return n=e,Boolean("string"==typeof n?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var n}class i extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}n.AssertionError=i,n.assert=function(e,t="Assertion failed.",n=i){if(!e){if(t instanceof Error)throw t;throw r(n,t)}},n.assertStruct=function(e,t,n="Assertion failed",o=i){try{(0,s.assert)(e,t)}catch(e){throw r(o,`${n}: ${function(e){return(0,a.getErrorMessage)(e).replace(/\.$/u,"")}(e)}.`)}},n.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/assert.cjs"}],[2965,{"./assert.cjs":2964,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;const s=e("@metamask/superstruct"),a=e("./assert.cjs");n.base64=(e,t={})=>{const n=t.paddingRequired??!1,r=t.characterSet??"base64";let i,o;return"base64"===r?i=String.raw`[A-Za-z0-9+\/]`:((0,a.assert)("base64url"===r),i=String.raw`[-_A-Za-z0-9]`),o=n?new RegExp(`^(?:${i}{4})*(?:${i}{3}=|${i}{2}==)?$`,"u"):new RegExp(`^(?:${i}{4})*(?:${i}{2,3}|${i}{3}=|${i}{2}==)?$`,"u"),(0,s.pattern)(e,o)}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/base64.cjs"}],[2966,{"./assert.cjs":2964,"./hex.cjs":2973,"@scure/base":3051,buffer:4106},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.createDataView=n.concatBytes=n.valueToBytes=n.base64ToBytes=n.stringToBytes=n.numberToBytes=n.signedBigIntToBytes=n.bigIntToBytes=n.hexToBytes=n.bytesToBase64=n.bytesToString=n.bytesToNumber=n.bytesToSignedBigInt=n.bytesToBigInt=n.bytesToHex=n.assertIsBytes=n.isBytes=void 0;const s=e("@scure/base"),a=e("./assert.cjs"),r=e("./hex.cjs"),i=48,o=58,c=87;const u=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function l(e){return e instanceof Uint8Array}function d(e){(0,a.assert)(l(e),"Value must be a Uint8Array.")}function p(e){if(d(e),0===e.length)return"0x";const t=u(),n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=t[e[s]];return(0,r.add0x)(n.join(""))}function m(e){d(e);const t=p(e);return BigInt(t)}function h(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,r.assertIsHexString)(e);const t=(0,r.remove0x)(e).toLowerCase(),n=t.length%2==0?t:`0${t}`,s=new Uint8Array(n.length/2);for(let e=0;e<s.length;e++){const t=n.charCodeAt(2*e),a=n.charCodeAt(2*e+1),r=t-(t<o?i:c),u=a-(a<o?i:c);s[e]=16*r+u}return s}function f(e){(0,a.assert)("bigint"==typeof e,"Value must be a bigint."),(0,a.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return h(e.toString(16))}function g(e){(0,a.assert)("number"==typeof e,"Value must be a number."),(0,a.assert)(e>=0,"Value must be a non-negative number."),(0,a.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return h(e.toString(16))}function b(e){return(0,a.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function y(e){if("bigint"==typeof e)return f(e);if("number"==typeof e)return g(e);if("string"==typeof e)return e.startsWith("0x")?h(e):b(e);if(l(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}n.isBytes=l,n.assertIsBytes=d,n.bytesToHex=p,n.bytesToBigInt=m,n.bytesToSignedBigInt=function(e){d(e);let t=BigInt(0);for(const n of e)t=(t<<BigInt(8))+BigInt(n);return BigInt.asIntN(8*e.length,t)},n.bytesToNumber=function(e){d(e);const t=m(e);return(0,a.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},n.bytesToString=function(e){return d(e),(new TextDecoder).decode(e)},n.bytesToBase64=function(e){return d(e),s.base64.encode(e)},n.hexToBytes=h,n.bigIntToBytes=f,n.signedBigIntToBytes=function(e,t){(0,a.assert)("bigint"==typeof e,"Value must be a bigint."),(0,a.assert)("number"==typeof t,"Byte length must be a number."),(0,a.assert)(t>0,"Byte length must be greater than 0."),(0,a.assert)(function(e,t){(0,a.assert)(t>0);const n=e>>BigInt(31);return!((~e&n)+(e&~n)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let n=e;const s=new Uint8Array(t);for(let e=0;e<s.length;e++)s[e]=Number(BigInt.asUintN(8,n)),n>>=BigInt(8);return s.reverse()},n.numberToBytes=g,n.stringToBytes=b,n.base64ToBytes=function(e){return(0,a.assert)("string"==typeof e,"Value must be a string."),s.base64.decode(e)},n.valueToBytes=y,n.concatBytes=function(e){const t=new Array(e.length);let n=0;for(let s=0;s<e.length;s++){const a=y(e[s]);t[s]=a,n+=a.length}const s=new Uint8Array(n);for(let e=0,n=0;e<t.length;e++)s.set(t[e],n),n+=t[e].length;return s},n.createDataView=function(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/bytes.cjs"}],[2967,{"./superstruct.cjs":2982,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toCaipAssetId=n.toCaipAssetType=n.toCaipAccountId=n.toCaipChainId=n.parseCaipAssetId=n.parseCaipAssetType=n.parseCaipAccountId=n.parseCaipChainId=n.isCaipAssetId=n.isCaipAssetType=n.isCaipTokenId=n.isCaipAssetReference=n.isCaipAssetNamespace=n.isCaipAccountAddress=n.isCaipAccountId=n.isCaipReference=n.isCaipNamespace=n.isCaipChainId=n.KnownCaipNamespace=n.CaipAssetTypeOrIdStruct=n.CaipAssetIdStruct=n.CaipAssetTypeStruct=n.CaipTokenIdStruct=n.CaipAssetReferenceStruct=n.CaipAssetNamespaceStruct=n.CaipAccountAddressStruct=n.CaipAccountIdStruct=n.CaipReferenceStruct=n.CaipNamespaceStruct=n.CaipChainIdStruct=n.CAIP_ASSET_ID_REGEX=n.CAIP_ASSET_TYPE_REGEX=n.CAIP_TOKEN_ID_REGEX=n.CAIP_ASSET_REFERENCE_REGEX=n.CAIP_ASSET_NAMESPACE_REGEX=n.CAIP_ACCOUNT_ADDRESS_REGEX=n.CAIP_ACCOUNT_ID_REGEX=n.CAIP_REFERENCE_REGEX=n.CAIP_NAMESPACE_REGEX=n.CAIP_CHAIN_ID_REGEX=void 0;const s=e("@metamask/superstruct"),a=e("./superstruct.cjs");n.CAIP_CHAIN_ID_REGEX=/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})$/u,n.CAIP_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,n.CAIP_REFERENCE_REGEX=/^[-_a-zA-Z0-9]{1,32}$/u,n.CAIP_ACCOUNT_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})):(?<accountAddress>[-.%a-zA-Z0-9]{1,128})$/u,n.CAIP_ACCOUNT_ADDRESS_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,n.CAIP_ASSET_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,n.CAIP_ASSET_REFERENCE_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,n.CAIP_TOKEN_ID_REGEX=/^[-.%a-zA-Z0-9]{1,78}$/u,n.CAIP_ASSET_TYPE_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})$/u,n.CAIP_ASSET_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})\/(?<tokenId>[-.%a-zA-Z0-9]{1,78})$/u;function r(e){return(0,s.is)(e,n.CaipNamespaceStruct)}function i(e){return(0,s.is)(e,n.CaipReferenceStruct)}function o(e){return(0,s.is)(e,n.CaipAccountAddressStruct)}function c(e){return(0,s.is)(e,n.CaipAssetNamespaceStruct)}function u(e){return(0,s.is)(e,n.CaipAssetReferenceStruct)}function l(e){return(0,s.is)(e,n.CaipTokenIdStruct)}n.CaipChainIdStruct=(0,a.definePattern)("CaipChainId",n.CAIP_CHAIN_ID_REGEX),n.CaipNamespaceStruct=(0,a.definePattern)("CaipNamespace",n.CAIP_NAMESPACE_REGEX),n.CaipReferenceStruct=(0,a.definePattern)("CaipReference",n.CAIP_REFERENCE_REGEX),n.CaipAccountIdStruct=(0,a.definePattern)("CaipAccountId",n.CAIP_ACCOUNT_ID_REGEX),n.CaipAccountAddressStruct=(0,a.definePattern)("CaipAccountAddress",n.CAIP_ACCOUNT_ADDRESS_REGEX),n.CaipAssetNamespaceStruct=(0,a.definePattern)("CaipAssetNamespace",n.CAIP_ASSET_NAMESPACE_REGEX),n.CaipAssetReferenceStruct=(0,a.definePattern)("CaipAssetReference",n.CAIP_ASSET_REFERENCE_REGEX),n.CaipTokenIdStruct=(0,a.definePattern)("CaipTokenId",n.CAIP_TOKEN_ID_REGEX),n.CaipAssetTypeStruct=(0,a.definePattern)("CaipAssetType",n.CAIP_ASSET_TYPE_REGEX),n.CaipAssetIdStruct=(0,a.definePattern)("CaipAssetId",n.CAIP_ASSET_ID_REGEX),n.CaipAssetTypeOrIdStruct=(0,a.definePattern)("CaipAssetTypeOrId",/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})(\/(?<tokenId>[-.%a-zA-Z0-9]{1,78}))?$/u),function(e){e.Bip122="bip122",e.Solana="solana",e.Eip155="eip155",e.Wallet="wallet"}(n.KnownCaipNamespace||(n.KnownCaipNamespace={})),n.isCaipChainId=function(e){return(0,s.is)(e,n.CaipChainIdStruct)},n.isCaipNamespace=r,n.isCaipReference=i,n.isCaipAccountId=function(e){return(0,s.is)(e,n.CaipAccountIdStruct)},n.isCaipAccountAddress=o,n.isCaipAssetNamespace=c,n.isCaipAssetReference=u,n.isCaipTokenId=l,n.isCaipAssetType=function(e){return(0,s.is)(e,n.CaipAssetTypeStruct)},n.isCaipAssetId=function(e){return(0,s.is)(e,n.CaipAssetIdStruct)},n.parseCaipChainId=function(e){const t=n.CAIP_CHAIN_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}},n.parseCaipAccountId=function(e){const t=n.CAIP_ACCOUNT_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.parseCaipAssetType=function(e){const t=n.CAIP_ASSET_TYPE_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP asset type.");return{assetNamespace:t.groups.assetNamespace,assetReference:t.groups.assetReference,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.parseCaipAssetId=function(e){const t=n.CAIP_ASSET_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP asset ID.");return{assetNamespace:t.groups.assetNamespace,assetReference:t.groups.assetReference,tokenId:t.groups.tokenId,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.toCaipChainId=function(e,t){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!i(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);return`${e}:${t}`},n.toCaipAccountId=function(e,t,s){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!i(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);if(!o(s))throw new Error(`Invalid "accountAddress", must match: ${n.CAIP_ACCOUNT_ADDRESS_REGEX.toString()}`);return`${e}:${t}:${s}`},n.toCaipAssetType=function(e,t,s,a){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!i(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);if(!c(s))throw new Error(`Invalid "assetNamespace", must match: ${n.CAIP_ASSET_NAMESPACE_REGEX.toString()}`);if(!u(a))throw new Error(`Invalid "assetReference", must match: ${n.CAIP_ASSET_REFERENCE_REGEX.toString()}`);return`${e}:${t}/${s}:${a}`},n.toCaipAssetId=function(e,t,s,a,o){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!i(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);if(!c(s))throw new Error(`Invalid "assetNamespace", must match: ${n.CAIP_ASSET_NAMESPACE_REGEX.toString()}`);if(!u(a))throw new Error(`Invalid "assetReference", must match: ${n.CAIP_ASSET_REFERENCE_REGEX.toString()}`);if(!l(o))throw new Error(`Invalid "tokenId", must match: ${n.CAIP_TOKEN_ID_REGEX.toString()}`);return`${e}:${t}/${s}:${a}/${o}`}}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/caip-types.cjs"}],[2968,{"./base64.cjs":2965,"@metamask/superstruct":2875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChecksumStruct=void 0;const s=e("@metamask/superstruct"),a=e("./base64.cjs");n.ChecksumStruct=(0,s.size)((0,a.base64)((0,s.string)(),{paddingRequired:!0}),44,44)}}},{package:"@metamask/utils",file:"node_modules/@metamask/utils/dist/checksum.cjs"}]],[],{});